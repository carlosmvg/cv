/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/Component"],function(C){"use strict";var S=C.extend("sap.webanalytics.core.SAPWebAnalyticsFLPPlugin.Component",{metadata:{manifest:"json"},init:function(){var p=this.getComponentData().config;var a="",T="",U="";a=p.SWA_PUB_TOKEN;T=p.SWA_BASE_URL;if(p.SWA_USER==='true')U=sap.ushell.Container.getUser().getEmail();if(a!==""&&T!==""){this.loadSWAObject(a,T,true,U);this.loadWebGUI();}},loadSWAObject:function(a,T,L,u){window.swa={pubToken:a,baseUrl:T,loggingEnabled:L,subSiteId:this.setSubSiteId,owner:u,custom1:{ref:this.getCustomAttributes(u)[0]},custom2:{ref:this.getCustomAttributes(u)[1]},custom3:{ref:this.getCustomAttributes(u)[2]},custom4:{ref:this.getCustomAttributes(u)[3]},custom5:{ref:this.getCustomAttributes(u)[4]}};var d=document,g=d.createElement("script"),s=d.getElementsByTagName("script")[0];g.type="text/javascript";g.defer=true;g.async=true;g.src=sap.ui.require.toUrl("sap/webanalytics/core/tracker/js/track.js");s.parentNode.insertBefore(g,s);if(sap.ui.version<"1.65.0"){window.onhashchange=function(){window.swa.trackLoad();};}},getCustomAttributes:function(u){var c=[];if(typeof sap!=="undefined"){if(u!=='')c[0]=sap.ushell.Container.getUser().getId();else c[0]="";c[1]=sap.ushell.Container.getLogonSystem().getClient();c[2]=sap.ushell.Container.getLogonSystem().getName();c[3]=(sap.ushell.services.AppConfiguration.getCurrentApplication()!==null)?sap.ushell.services.AppConfiguration.getCurrentApplication().inboundPermanentKey:"";c[4]=(sap.ushell.services.AppConfiguration.getCurrentApplication()!==null)?sap.ushell.services.AppConfiguration.getCurrentApplication().ui5ComponentName:"";}return c;},loadWebGUI:function(){var t=sap.ui.require.toUrl("sap/webanalytics/core/tracker/js/track.js");if(window.addEventListener){window.addEventListener("message",function(e){var g=JSON.parse(e.data);if(g.service==="sap.its.readyToListen"&&g.type==="announce"){var s=escape(window.parent.document.cookie);var b={"type":"request","service":"sap.its.trackSWA","pubToken":window.swa.pubToken,"owner":window.swa.owner,"baseUrl":window.swa.baseUrl,"message":"Response from SWA","isConsentGiven":true,"cookieVal":s,"trackingResourceUrl":t};e.source.postMessage(JSON.stringify(b),e.origin);}});}},setSubSiteId:function(){var s="";if(window.location.href.substring(window.location.href.indexOf("#"))!==-1){s=window.location.href.substring(window.location.href.indexOf("#")+1);}if(s.indexOf("&")!==-1){s=s.substring(0,s.indexOf("&"));}return(s!=="")?s:undefined;}});return S;});
