// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["./BaseDialog.controller","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(B,F,a){"use strict";var l;var r;return B.extend("sap.ushell.applications.PageComposer.controller.ContextSelector",{constructor:function(v,R){this._oView=v;this.sViewId="contextSelector";this.sId="sap.ushell.applications.PageComposer.view.ContextSelector";r=R;},onSearch:function(e){var L=l.getBinding("items");var s=e.getSource().getValue()||"";L.filter([new F([new F({path:"id",operator:a.Contains,value1:s,caseSensitive:false}),new F({path:"title",operator:a.Contains,value1:s,caseSensitive:false})],false)]);if(L.getLength()===0){if(s){l.setNoDataText(r.getText("Message.NoRolesFound"));}else{l.setNoDataText(r.getText("Message.NoRoles"));}}},onSelectionChange:function(){var s=l.getSelectedContexts(true);this.getModel().setProperty("/contextDisabled",!s.length);},onConfirm:function(){var s=l.getSelectedContexts(true).map(function(S){return S.getProperty("id");});this._oDialog.close();var A=l.getItems().length;var R={selected:s,allSelected:(s.length===A)||(s.length===0)};if(this._fnConfirm){this._fnConfirm(R);}},_setPreSelection:function(s){l.getItems().forEach(function(L){if(s.indexOf(L.getTitle())!==-1){L.setSelected(true);}});this.getModel().setProperty("/contextDisabled",!l.getSelectedItems().length);},openSelector:function(p,s,c){this.getModel().setProperty("/contextDisabled",false);this.attachConfirm(c);return this.load().then(function(){l=this._oView.byId("contextSelectorList");l.attachUpdateFinished(function(){this._setPreSelection(s);this._oDialog.setBusy(false);}.bind(this));this._oDialog.setBusy(true);this._oDialog.bindObject({path:"PageRepository>/pageSet('"+encodeURIComponent(p)+"')"});this.open();}.bind(this));}});});
