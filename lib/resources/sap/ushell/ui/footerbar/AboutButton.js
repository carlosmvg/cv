// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/restricted/_flatten","sap/m/Button","sap/m/Dialog","sap/m/Title","sap/m/VBox","sap/m/HBox","sap/ui/layout/form/SimpleForm","sap/ushell/resources","sap/ushell/ui/launchpad/ActionItem","sap/ushell/services/AppConfiguration","sap/m/Label","sap/m/Text","sap/ui/core/library","sap/ui/layout/library","sap/ushell/Config","sap/ui/core/Icon","./AboutButtonRenderer"],function(_,B,D,T,V,H,S,r,A,a,L,b,c,l,C,I){"use strict";var d=l.form.SimpleFormLayout;var e=c.TitleLevel;var f=A.extend("sap.ushell.ui.footerbar.AboutButton",{metadata:{library:"sap.ushell"}});f.prototype.init=function(){if(A.prototype.init){A.prototype.init.apply(this,arguments);}this.setIcon("sap-icon://hint");this.setText(r.i18n.getText("about"));this.setTooltip(r.i18n.getText("about"));this.attachPress(this.showAboutDialog);this._translationBundle=r.i18n;};f.prototype.showAboutDialog=function(){var p=sap.ushell.Container.getServiceAsync("AppLifeCycle");return Promise.all([p.then(function(o){return o.getCurrentApplication().getInfo(["technicalAppComponentId","appVersion","appFrameworkId","appFrameworkVersion","productName","appId","appSupportInfo"]);}),this._getContentProviderLabel(),this._getAppFrameworkVersion()]).then(function(R){var m=a.getMetadata();var g=function(t,u){return[new L({text:this._translationBundle.getText(t)}),new b({text:u||"",visible:!!u})];}.bind(this),i=R[0],P=R[1],F=R[2],h=function(t){return g(t,i[t]);},s=this._getClientRoleDescription(),j=_(["technicalAppComponentId","appVersion","appFrameworkId"].map(h).concat(g("appFrameworkVersion",F)).concat(g("contentProviderLabel",P)).concat(g("userAgentFld",navigator.userAgent)).concat(h("productName")).concat(g("clientRoleFld",s)).concat(["appId","appSupportInfo"].map(h)));var o=new S({id:"aboutDialogFormID",editable:false,layout:d.ResponsiveGridLayout,content:j}),k=[],n,v,q=new B({text:this._translationBundle.getText("okBtn"),press:function(){n.close();}});if(m.icon){k.push(new I({src:m.icon}).addStyleClass("sapUiTinyMarginEnd"));}if(m.title){k.push(new T({text:m.title,level:e.H3}));}if(k.length>0){o.insertContent(new H({items:k}),0);}v=new V({items:[o]});n=new D({id:"aboutContainerDialogID",title:this._translationBundle.getText("about"),contentWidth:"25rem",horizontalScrolling:false,leftButton:q,afterClose:function(){n.destroy();if(window.document.activeElement&&window.document.activeElement.tagName==="BODY"){window.document.getElementById("meAreaHeaderButton").focus();}}}).addStyleClass("sapContrastPlus");n.addContent(v);n.open();}.bind(this));};f.prototype._getClientRoleDescription=function(){var s=sap.ushell.Container.getLogonSystem().getClientRole();var o={P:"clientRoleProduction",T:"clientRoleTest",C:"clientRoleCustomizing",D:"clientRoleDemonstration",E:"clientRoleTraining",S:"clientRoleSAPReference"};return o[s]&&this._translationBundle.getText(o[s]);};f.prototype._getContentProviderLabel=function(){if(C.last("/core/contentProviders/providerInfo/show")){var p=sap.ushell.Container.getServiceAsync("AppLifeCycle");return p.then(function(o){var g=o.getCurrentApplication();return g.getSystemContext().then(function(s){return s.label;});});}return Promise.resolve(undefined);};f.prototype._getAppFrameworkVersion=function(){var p=sap.ushell.Container.getServiceAsync("AppLifeCycle");return p.then(function(o){var g=o.getCurrentApplication();return g.getInfo(["appFrameworkVersion"]).then(function(i){return g.homePage?i.appFrameworkVersion:undefined;});});};return f;});
