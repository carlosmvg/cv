/*
 * ! SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/m/library','sap/ui/core/library','sap/ui/core/Core','sap/ui/core/ShortcutHintsMixin','sap/ui/core/format/ListFormat','sap/ui/events/KeyCodes','sap/ui/comp/util/DateTimeUtil','sap/ui/comp/util/FilterUtil','sap/m/Column','sap/m/ColumnListItem','sap/m/Label','sap/m/MessageBox','sap/m/Table','sap/m/Text','sap/m/Title','sap/m/OverflowToolbar','sap/m/ToolbarSpacer','sap/m/OverflowToolbarButton','sap/m/ToolbarSeparator','sap/m/VBox','sap/m/FlexItemData','sap/ui/comp/library','sap/ui/comp/providers/TableProvider','sap/ui/comp/smartfilterbar/FilterProvider','sap/ui/comp/smartvariants/SmartVariantManagement','sap/ui/model/Sorter','sap/ui/model/Filter','sap/ui/model/FilterOperator','sap/ui/model/json/JSONModel','sap/ui/table/AnalyticalColumn','sap/ui/table/AnalyticalTable','sap/ui/table/Column','sap/ui/table/Table','sap/ui/table/TreeTable','sap/ui/comp/personalization/Controller','sap/ui/comp/personalization/Util','sap/ui/comp/util/FormatUtil','sap/ui/comp/util/FullScreenUtil','sap/ui/comp/odata/ODataModelUtil','sap/ui/comp/odata/ODataType','sap/ui/comp/state/UIState','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/core/format/NumberFormat','sap/ui/Device','sap/base/Log','sap/base/util/deepEqual','sap/base/util/merge',"sap/m/ColumnHeaderPopover",'sap/m/ColumnPopoverActionItem','sap/m/ColumnPopoverSortItem','sap/m/Menu','sap/m/MenuButton','sap/m/MenuItem','sap/m/Button','sap/m/Link','sap/m/MessageStrip'],function(q,M,c,C,S,L,K,D,F,a,b,d,f,R,T,g,O,h,j,k,V,l,m,n,o,p,r,s,t,J,A,u,v,w,x,y,P,z,B,E,G,U,H,N,I,Q,W,X,Y,Z,$,_,a1,b1,c1,d1,e1){"use strict";var f1=M.ButtonType;var g1=M.MenuButtonMode;var h1=M.ToolbarDesign;var i1=c.SortOrder;var j1=m.smarttable.InfoToolbarBehavior;var k1=V.extend("sap.ui.comp.smarttable.SmartTable",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smarttable/SmartTable.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},enableDataStateFiltering:{type:"boolean",group:"Behavior",defaultValue:false,visibility:"hidden"},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},initiallyVisibleFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},tableType:{type:"sap.ui.comp.smarttable.TableType",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},showVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useExportToExcel:{type:"boolean",group:"Misc",defaultValue:true},exportType:{type:"sap.ui.comp.smarttable.ExportType",group:"Misc",defaultValue:"UI5Client"},useTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},showTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},toolbarStyleClass:{type:"string",group:"Misc",defaultValue:null},enableCustomFilter:{type:"boolean",group:"Misc",defaultValue:true},persistencyKey:{type:"string",group:"Misc",defaultValue:null},useOnlyOneSolidToolbar:{type:"boolean",group:"Misc",defaultValue:false},placeToolbarInTable:{type:"boolean",group:"Misc",defaultValue:false},currentVariantId:{type:"string",group:"Misc",defaultValue:null},editable:{type:"boolean",group:"Misc",defaultValue:false},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},tableBindingPath:{type:"string",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},demandPopin:{type:"boolean",group:"Misc",defaultValue:false},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:false},initialNoDataText:{type:"string",group:"Misc",defaultValue:null},useInfoToolbar:{type:"sap.ui.comp.smarttable.InfoToolbarBehavior",group:"Behavior",defaultValue:j1.Auto},showDetailsButton:{type:"boolean",group:"Misc",defaultValue:false}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},aggregations:{customToolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},noData:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false},semanticKeyAdditionalControl:{type:"sap.ui.core.Control",multiple:false}},events:{initialise:{},beforeRebindTable:{},editToggled:{},dataRequested:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{parameters:{currentVariantId:{type:"string"}}},afterVariantApply:{parameters:{currentVariantId:{type:"string"}}},showOverlay:{},fieldChange:{},fullScreenToggled:{parameters:{fullScreen:{type:"boolean"}}},beforeExport:{parameters:{exportSettings:{type:"object"},userExportSettings:{type:"object"}}},beforePaste:{allowPreventDefault:true,parameters:{columnInfos:{type:"object[]"}}},paste:{parameters:{result:{type:"object"}}}}},renderer:{apiVersion:2},constructor:function(){V.apply(this,arguments);this._aExistingColumns=[];this._aAlwaysSelect=[];this._oTemplate=null;this._mFieldMetadataByKey={};this._createToolbar();this._oP13nDialogSettings=this.data("p13nDialogSettings");if(typeof this._oP13nDialogSettings==="string"){try{this._oP13nDialogSettings=JSON.parse(this._oP13nDialogSettings);}catch(e){this._oP13nDialogSettings=null;}}this._bIsFilterPanelEnabled=(this._oP13nDialogSettings&&this._oP13nDialogSettings.filter)?this._oP13nDialogSettings.filter.visible!==false:true;this._bIsSortPanelEnabled=(this._oP13nDialogSettings&&this._oP13nDialogSettings.sort)?this._oP13nDialogSettings.sort.visible!==false:true;this._createTable();this.attachModelContextChange(this._initialiseMetadata,this);}});k1.prototype.getEnableDataStateFiltering=function(){return this.getProperty("enableDataStateFiltering");};k1.prototype.setEnableDataStateFiltering=function(e){if(this.getEnableDataStateFiltering()===e){return this;}this.setProperty("enableDataStateFiltering",e,true);if(!e){this._onApplyMessageFilter(e);if(this._oDataStateIndicator){this._oDataStateIndicator.detachEvent("dataStateChange",this._onDataStateChange,this);this._oDataStateIndicator.detachEvent("messageLinkPressed",this._onMessageLinkPressed,this);this._oDataStateIndicator=null;}}this._bApplyFilter=false;this._handleDataStateIndicator();return this;};k1.prototype._handleDataStateIndicator=function(){if(!this._oTable||!this.getEnableDataStateFiltering()){return;}var i=this._oTable.getDependents();if(!i.length){return;}var e=i.find(function(m1){return m1.isA("sap.m.plugins.DataStateIndicator");});if(!e){return;}this._oDataStateIndicator=e;this._oDataStateIndicator.attachEvent("dataStateChange",this._onDataStateChange,this);var l1=C.getLibraryResourceBundle("sap.ui.comp");this._oDataStateIndicator.setMessageLinkText(l1.getText("SMARTTABLE_MESSAGESTRIP_FILTER_ITEMS"));this._oDataStateIndicator.setMessageLinkVisible(true);this._oDataStateIndicator.attachEvent("messageLinkPressed",this._onMessageLinkPressed,this);this._oDataStateIndicator.refresh();};k1.prototype._onMessageLinkPressed=function(){this._bApplyFilter=!this._bApplyFilter;this._onApplyMessageFilter(this._bApplyFilter);};k1.prototype._getP13nFilterMessageStrip=function(){var e,i;if(this.getEnableDataStateFiltering()){i=C.getLibraryResourceBundle("sap.ui.comp");e=new e1({text:i.getText("SMARTTABLE_P13N_FILTER_MESSAGESTRIP"),type:"Information",visible:this._bApplyFilter,link:new d1({text:i.getText("SMARTTABLE_MESSAGESTRIP_CLEAR_FILTER"),press:[function(){e.setVisible(false);this._onApplyMessageFilter(false);this._bApplyFilter=!this._bApplyFilter;},this]})});}return e;};k1.prototype._onDataStateChange=function(e){var i=e.getParameter("filteredMessages")||[];this._sDataStateType=e.getSource()._getCombinedType(i).toUpperCase();if(!i.length){this._onApplyMessageFilter(false);}};k1.prototype._onApplyMessageFilter=function(e){this._filterByDataStateError(e);var i=C.getLibraryResourceBundle("sap.ui.comp");if(this._oDataStateIndicator&&!e){this._oDataStateIndicator.setMessageLinkText(i.getText("SMARTTABLE_MESSAGESTRIP_FILTER_ITEMS"));this._getRowBinding().checkDataState();}else if(this._oDataStateIndicator){this._oDataStateIndicator.setMessageLinkText(i.getText("SMARTTABLE_MESSAGESTRIP_CLEAR_FILTER"));}};k1.prototype.init=function(){V.prototype.init.call(this);this.addStyleClass("sapUiCompSmartTable");this.setFitContainer(true);this._aColumnKeys=[];this._aDeactivatedColumns=[];this._mLazyColumnMap={};};k1.prototype._getVariantManagementControl=function(e){var i=null;if(e){if(typeof e==='string'){i=C.byId(e);}else{i=e;}if(i){if(!(i instanceof p)){Q.error("Control with the id="+e.getId?e.getId():e+" not of expected type");return null;}}}return i;};k1.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||(!this.getUseVariantManagement()&&!this.getUseTablePersonalisation())||!this.getPersistencyKey()){return;}var e=new H({type:"table",keyName:"persistencyKey",dataSource:"TODO"});e.setControl(this);var i=this.getSmartVariant();if(i){this._oVariantManagement=this._getVariantManagementControl(i);}else if(this._oSmartFilter&&this._oSmartFilter.data("pageVariantPersistencyKey")){i=this._oSmartFilter.getSmartVariant();if(i){this._oVariantManagement=this._getVariantManagementControl(i);}}else{this._oVariantManagement=new p(this.getId()+"-variant",{showShare:true});}if(this._oVariantManagement){this._oVariantManagement.addPersonalizableControl(e);this._oVariantManagement.attachSave(this._variantSaved,this);this._oVariantManagement.attachAfterSave(this._variantAfterSave,this);this._oVariantManagement.initialise(this._variantInitialised,this);}};k1.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD";}this.fireAfterVariantInitialise();if(this._oVariantManagement&&!this._oVariantManagement.getEnabled()){this._checkAndTriggerBinding();}};k1.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant,true);}};k1.prototype._variantAfterSave=function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()});};k1.prototype.setTableBindingPath=function(e){this.setProperty("tableBindingPath",e,true);return this;};k1.prototype.setShowTablePersonalisation=function(e){this.setProperty("showTablePersonalisation",e,true);if(this._oTablePersonalisationButton){this._oTablePersonalisationButton.setVisible(e);}return this;};k1.prototype.setUseVariantManagement=function(e){this.setProperty("useVariantManagement",e,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!e);}return this;};k1.prototype.setShowVariantManagement=function(e){this.setProperty("showVariantManagement",e,true);if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(e);if(this._oSeparator){this._oSeparator.setVisible(e);}}return this;};k1.prototype.setToolbarStyleClass=function(e){this.setProperty("toolbarStyleClass",e,true);return this;};k1.prototype.setCustomToolbar=function(e){this._oCustomToolbar=e;return this;};k1.prototype.getCustomToolbar=function(){return this._oCustomToolbar;};k1.prototype.setHeader=function(e){var i=this.getProperty("header"),l1;this.setProperty("header",e,true);if(this.bIsInitialised&&this._oToolbar){l1=(!i===!e);if(!l1){this._createToolbarContent();}else{this._refreshHeaderText();}}return this;};k1.prototype.setShowRowCount=function(e){this.setProperty("showRowCount",e,true);this._refreshHeaderText();return this;};k1.prototype.setEditable=function(e){this.setProperty("editable",e,true);if(this._oEditModel){this._oEditModel.setProperty("/editable",e);}if(this._oEditButton){this._oEditButton.setIcon(e?"sap-icon://display":"sap-icon://edit");}if(this._isMobileTable&&this._oTable.setKeyboardMode){this._oTable.setKeyboardMode(e?"Edit":"Navigation");}return this;};k1.prototype.setDemandPopin=function(e){var i=this.getDemandPopin();if(i===e){return this;}this.setProperty("demandPopin",e,true);if(this.bIsInitialised){if(e){this._updateColumnsPopinFeature();}else{this._deactivateColumnsPopinFeature();}}return this;};k1.prototype._refreshHeaderText=function(){if(!this._headerText){return;}if(!this._oNumberFormatInstance){this._oNumberFormatInstance=N.getFloatInstance();}var e=this.getHeader();this._headerText.setVisible(!!e);if(this.getShowRowCount()){var i=parseInt(this._getRowCount(true));var l1=this._oNumberFormatInstance.format(i);e+=" ("+l1+")";}this._headerText.setText(e);this._updateAriaLabelledByInfo();};k1.prototype._updateAriaLabelledByInfo=function(){var e=this._headerText.getId();if(this._oTable&&this._oTable.addAriaLabelledBy){if(this._headerText.getVisible()){if(this._oTable.getAriaLabelledBy().indexOf(e)===-1){this._oTable.addAriaLabelledBy(e);}}else{this._oTable.removeAriaLabelledBy(e);}}};k1.prototype._addFullScreenButton=function(){if(this._oFullScreenButton){this._oToolbar.removeContent(this._oFullScreenButton);}if(this.getShowFullScreenButton()){if(!this._oFullScreenButton){this._oFullScreenButton=new j(this.getId()+"-btnFullScreen",{press:[function(){this._toggleFullScreen(!this.bFullScreen);},this]});this._oFullScreenButton.addStyleClass("sapUiCompSmartTableToolbarContent");}this._renderFullScreenButton();this._oToolbar.addContent(this._oFullScreenButton);}};k1.prototype._createToolbar=function(){var e=null;if(!this._oToolbar){e=this.getCustomToolbar();if(e){this._oToolbar=e;}else{this._oToolbar=new O({design:h1.Transparent});this._oToolbar.addStyleClass("sapUiCompSmartTableToolbar");if(this.getToolbarStyleClass()){this._oToolbar.addStyleClass(this.getToolbarStyleClass());}}this._oToolbar.setLayoutData(new l({shrinkFactor:0}));}};k1.prototype._toggleShowHideDetails=function(e){if(!this._oShowHideDetailsButton||(e===this.bHideDetails)){return;}this.bHideDetails=e;var i=[];if(this.bHideDetails){i=I.system.phone?["Low","Medium"]:["Low"];}this._oTable.setHiddenInPopin(i);this._renderShowHideDetailsButton();};k1.prototype._renderShowHideDetailsButton=function(){var e=C.getLibraryResourceBundle("sap.ui.comp"),i;i=this.bHideDetails?e.getText("TABLE_SHOWDETAILS_TEXT"):e.getText("TABLE_HIDEDETAILS_TEXT");this._oShowHideDetailsButton.setTooltip(i);this._oShowHideDetailsButton.setText(i);};k1.prototype._toggleFullScreen=function(e,i){if(!this._oFullScreenButton||(e===this.bFullScreen&&!i)){return;}this.bFullScreen=e;B.toggleFullScreen(this,this.bFullScreen,this._oFullScreenButton,this._toggleFullScreen);this._renderFullScreenButton();this.fireFullScreenToggled({fullScreen:e});};k1.prototype._renderFullScreenButton=function(){var e=C.getLibraryResourceBundle("sap.ui.comp"),i;i=this.bFullScreen?e.getText("CHART_MINIMIZEBTN_TOOLTIP"):e.getText("CHART_MAXIMIZEBTN_TOOLTIP");this._oFullScreenButton.setTooltip(i);this._oFullScreenButton.setText(i);this._oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen");};k1.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar();}this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addEditTogglableToToolbar();this._addShowHideDetailsButton();this._addTablePersonalisationToToolbar();this._addExportToExcelToToolbar();this._addFullScreenButton();this._bToolbarInsertedIntoItems=true;this._placeToolbar();};k1.prototype._placeToolbar=function(){if(!this.getPlaceToolbarInTable()){this.insertItem(this._oToolbar,0);}else if(this._isMobileTable){this._oTable.setHeaderToolbar(this._oToolbar);}else{this._oTable.addExtension(this._oToolbar);}};k1.prototype.getToolbar=function(){return this._oToolbar;};k1.prototype._addEditTogglableToToolbar=function(){var e;if(this._oEditButton){this._oToolbar.removeContent(this._oEditButton);}if(this.getEditTogglable()){if(!this._oEditButton){e=C.getLibraryResourceBundle("sap.ui.comp").getText("TABLE_EDITTOGGLE_TOOLTIP");this._oEditButton=new j(this.getId()+"-btnEditToggle",{icon:this.getEditable()?"sap-icon://display":"sap-icon://edit",text:e,tooltip:e,press:[function(){var i=this.getEditable();i=!i;this.setEditable(i,true);this.fireEditToggled({editable:i});},this]});this._oEditButton.addStyleClass("sapUiCompSmartTableToolbarContent");}this._oToolbar.addContent(this._oEditButton);}};k1.prototype._addHeaderToToolbar=function(){if(this._headerText){this._oToolbar.removeContent(this._headerText);}if(!this._headerText){this._headerText=new g(this.getId()+"-header");this._headerText.addStyleClass("sapMH4Style");this._headerText.addStyleClass("sapUiCompSmartTableHeader");this._headerText.addStyleClass("sapUiCompSmartTableToolbarContent");}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0);};k1.prototype._addSeparatorToToolbar=function(){if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);}if(this.getHeader()&&this.getUseVariantManagement()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){if(!this._oSeparator){this._oSeparator=new k(this.getId()+"-toolbarSeperator");if(!this.getShowVariantManagement()){this._oSeparator.setVisible(false);}}this._oToolbar.insertContent(this._oSeparator,0);}if(this._oToolbar){this._oToolbar.addStyleClass("sapMTBHeader-CTX");}};k1.prototype._addVariantManagementToToolbar=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oToolbar.removeContent(this._oVariantManagement);if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0);this._oVariantManagement.addStyleClass("sapUiCompSmartTableToolbarContent");if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(this.getShowVariantManagement());}}}};k1.prototype._addSpacerToToolbar=function(){var e=false,l1=this._oToolbar.getContent(),i,m1;if(l1){m1=l1.length;i=0;for(i;i<m1;i++){if(l1[i]instanceof h){e=true;break;}}}if(!e){this._oToolbar.addContent(new h(this.getId()+"-toolbarSpacer"));}};k1.prototype._addShowHideDetailsButton=function(){if(this._oShowHideDetailsButton){this._oToolbar.removeContent(this._oShowHideDetailsButton);}if(this.getShowDetailsButton()&&this._isMobileTable){this.bHideDetails=true;if(!this._oShowHideDetailsButton){this._oShowHideDetailsButton=new c1(this.getId()+"-btnShowHideDetails",{visible:false,press:[function(){this._toggleShowHideDetails(!this.bHideDetails);},this]});this._oShowHideDetailsButton.addStyleClass("sapUiCompSmartTableToolbarContent");}this._renderShowHideDetailsButton();this._oToolbar.addContent(this._oShowHideDetailsButton);}};k1.prototype._addTablePersonalisationToToolbar=function(){var e;if(this._oTablePersonalisationButton){this._oToolbar.removeContent(this._oTablePersonalisationButton);}if(this.getUseTablePersonalisation()){if(!this._oTablePersonalisationButton){e=C.getLibraryResourceBundle("sap.ui.comp").getText("TABLE_PERSOBTN_TOOLTIP");this._oTablePersonalisationButton=new j(this.getId()+"-btnPersonalisation",{icon:"sap-icon://action-settings",text:e,tooltip:e,press:[function(i){this._oPersController.openDialog();},this]});S.addConfig(this._oTablePersonalisationButton,{messageBundleKey:I.os.macintosh?"SMARTTABLE_SHORTCUT_SHOW_SETTINGS_MAC":"SMARTTABLE_SHORTCUT_SHOW_SETTINGS"},this);this._oTablePersonalisationButton.addStyleClass("sapUiCompSmartTableToolbarContent");this._oTablePersonalisationButton.setVisible(this.getShowTablePersonalisation());}this._oToolbar.addContent(this._oTablePersonalisationButton);}};k1.prototype._triggerGWExport=function(){var e=C.getLibraryResourceBundle("sap.ui.comp");var i=function(){var m1=this._getRowBinding();var n1=m1.getDownloadUrl("xlsx");n1=this._removeExpandParameter(n1);if(n1&&n1.length>2048&&I.browser.msie){f.error(e.getText("DOWNLOAD_TOO_COMPLEX_TEXT"));return;}var o1={url:n1};this.fireBeforeExport({exportSettings:o1});window.open(o1.url);}.bind(this);var l1=this._getRowCount(true);if(l1>10000){f.confirm(e.getText("DOWNLOAD_CONFIRMATION_TEXT",l1),{actions:[f.Action.YES,f.Action.NO],onClose:function(m1){if(m1===f.Action.YES){i();}}});}else{i();}};k1.prototype._addExportToExcelToToolbar=function(){if(this._oUseExportToExcel){this._oToolbar.removeContent(this._oUseExportToExcel);}if(!this.getUseExportToExcel()){return;}if(!this._oUseExportToExcel){var e=this.getId()+"-btnExcelExport";var i="sap-icon://excel-attachment";var l1=C.getLibraryResourceBundle("sap.ui.comp");if(this.getExportType()==="UI5Client"){this._oUseExportToExcel=this._createClientExportButton(e,i);}if(this._bTableSupportsExcelExport&&this.getExportType()==="GW"){var m1;m1=l1.getText("TABLE_EXPORT_TEXT");this._oUseExportToExcel=new j(e,{icon:i,text:m1,tooltip:m1,press:[this._triggerGWExport,this]});}this._setExcelExportEnableState();if(this._oUseExportToExcel){this._oUseExportToExcel.addStyleClass("sapUiCompSmartTableToolbarContent");}}this._oToolbar.addContent(this._oUseExportToExcel);};k1.prototype._openExportSettings=function(){var e=this;this._loadExportLibrary().then(function(){sap.ui.require(['sap/ui/export/ExportUtils'],function(i){i.getExportSettingsViaDialog(e._cachedExcelSettings,e).then(function(l1){e._cachedExcelSettings=l1;e._triggerUI5ClientExport(l1);});});});};k1.prototype._createClientExportButton=function(e,i){var l1=C.getLibraryResourceBundle("sap.ui.comp");var m1={fileName:this.getHeader()};if(!this._cachedExcelSettings){this._cachedExcelSettings=m1;}var n1=new a1(e,{icon:i,tooltip:l1.getText("TABLE_EXPORT_TEXT"),type:f1.Ghost,buttonMode:g1.Split,useDefaultActionOnly:true,defaultAction:[function(){this._triggerUI5ClientExport(m1);},this],menu:[new _({items:[new b1({text:l1.getText("QUICK_EXPORT"),press:[function(){this._triggerUI5ClientExport(m1);},this]}),new b1({text:l1.getText("EXPORT_WITH_SETTINGS"),press:[this._openExportSettings,this]})]})]});S.addConfig(n1._getButtonControl(),{messageBundleKey:I.os.macintosh?"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL_MAC":"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL"},this);return n1;};k1.prototype.onkeydown=function(e){if(e.isMarked()){return;}if((e.metaKey||e.ctrlKey)&&e.shiftKey&&e.which===K.E){if(this.getUseExportToExcel()&&this.getExportType()==="UI5Client"&&this._oUseExportToExcel&&this._oUseExportToExcel.getEnabled()){this._openExportSettings();e.setMarked();e.preventDefault();}}else if((e.metaKey||e.ctrlKey)&&e.which===K.COMMA){if(this.getUseTablePersonalisation()&&this._oTablePersonalisationButton&&this._oTablePersonalisationButton.getVisible()){this._oPersController.openDialog();e.setMarked();e.preventDefault();}}};k1.prototype._loadExportLibrary=function(){if(!this._oExportLibLoadPromise){this._oExportLibLoadPromise=C.loadLibrary("sap.ui.export",true);}return this._oExportLibLoadPromise;};k1.prototype._getColumnLabel=function(e){var i;if(typeof e==='string'){e=this._getColumnByKey(e);}if(!e){return null;}if(e.getLabel){i=e.getLabel();}if(e.getHeader){i=e.getHeader();}return(i&&i.getText)?i.getText():null;};k1.prototype._getColumnWidthNumber=function(e){if(e.indexOf("em")>0){return Math.round(parseFloat(e));}if(e.indexOf("px")>0){return Math.round(parseInt(e)/16);}return"";};k1.prototype._triggerUI5ClientExport=function(e){var i=this._createExportColumnConfiguration(e);if(!i||!i.length){f.error(C.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_COLS_EXPORT"),{styleClass:(this.$()&&this.$().closest(".sapUiSizeCompact").length)?"sapUiSizeCompact":""});return;}var l1=this._getRowBinding();var m1=this._getColumnLabel.bind(this);var n1={workbook:{columns:i,hierarchyLevel:(this._isTreeTable&&l1.getTreeAnnotation)?l1.getTreeAnnotation("hierarchy-level-for"):undefined},dataSource:l1,fileName:e?e.fileName:this.getHeader()};this._loadExportLibrary().then(function(){sap.ui.require(['sap/ui/export/ExportUtils','sap/ui/export/Spreadsheet'],function(o1,p1){var q1=Promise.resolve();if(e.includeFilterSettings){q1=o1.parseFilterConfiguration(l1,m1).then(function(r1){if(e.includeFilterSettings&&r1){n1.workbook.context={metaSheetName:r1.name,metainfo:[r1]};}});}q1.then(function(){var r1={splitCells:false,includeFilterSettings:false};if(e){r1.splitCells=e.splitCells;r1.includeFilterSettings=e.includeFilterSettings;}var s1=new p1(n1);s1.attachBeforeExport(function(u1){this.fireBeforeExport({exportSettings:u1.getParameter('exportSettings'),userExportSettings:r1});},this);var t1=function(){s1.destroy();};s1.build().then(t1,t1);}.bind(this));}.bind(this));}.bind(this));};k1.prototype._createExportColumnConfiguration=function(e){var l1,i,m1,n1,o1,p1,q1,r1,s1,t1,u1,v1,w1,x1,y1,z1,A1,B1,C1=[];var D1=e&&e.splitCells;var E1=function(G1,H1){return'{'+(parseInt(H1)-1)+'}';};l1=this._isMobileTable?this._oTable.getColumns(true):this._oTable.getColumns();m1=l1.length;for(i=0;i<m1;i++){q1=null;r1=null;s1=null;n1=l1[i];if(n1.getVisible()){o1=n1.data("p13nData");if(n1.getLeadingProperty){q1=n1.getLeadingProperty();}if(!q1&&o1){q1=o1["leadingProperty"];}if(Array.isArray(q1)){q1=q1[0];}if(q1){p1=this._getColumnLabel(n1);x1=n1.getWidth().toLowerCase()||o1.width||"";x1=this._getColumnWidthNumber(x1);y1=o1.type==="numeric"?"Number":o1.type;B1=o1.typeInstance;A1=null;z1=null;if(o1.unit){y1=o1.isCurrency?"Currency":"Number";if(D1){s1=o1.unit;}}else if(B1&&B1.isA("sap.ui.comp.odata.type.FiscalDate")){var F1=B1.getFormatter();r1=F1.getTemplate().replace(/\$(\d)/g,E1);z1=F1.getRegExPattern().toString().slice(1,-1);y1="String";}else if(y1!="date"&&G.isDateOrTime(o1.edmType)){y1=G.getTypeName(o1.edmType);if(y1==="DateTimeOffset"){y1="DateTime";}}else if(y1==="stringdate"){y1="Date";z1="YYYYMMDD";}else if(y1==="boolean"){y1="Boolean";A1=G.getType(o1.edmType);}else if(o1.description){y1="String";if(D1&&o1.displayBehaviour!=="idOnly"){s1=o1.description;}else{r1=z.getFormattedExpressionFromDisplayBehaviour(o1.displayBehaviour,"{0}","{1}");}}else if(o1.isDigitSequence){y1="Number";}else if(y1==="string"){y1="String";}else if(y1==="date"){y1="Date";}else if(y1==="time"){y1="Time";}C1.push({columnId:n1.getId(),property:o1.description&&!D1?[q1,o1.description]:q1,type:y1,inputFormat:z1,label:p1?p1:q1,width:x1,textAlign:n1.getHAlign(),template:r1,trueValue:(y1==="Boolean"&&A1)?A1.formatValue(true,"string"):undefined,falseValue:(y1==="Boolean"&&A1)?A1.formatValue(false,"string"):undefined,unitProperty:(y1==="Currency"||(y1==="Number"&&!D1))?o1.unit:undefined,displayUnit:y1==="Currency"&&!D1,precision:o1.precision,scale:o1.scale});if(s1){t1=this._getColumnByKey(s1);u1=p1;p1=null;if(t1){p1=this._getColumnLabel(t1);x1=t1.getWidth().toLowerCase()||"";x1=this._getColumnWidthNumber(x1);w1=t1.getHAlign();}else{v1=this._mFieldMetadataByKey[s1];if(v1){p1=v1.label;x1=v1.width;}}C1.push({columnId:n1.getId()+"-additionalProperty",property:s1,type:"String",label:p1||(u1?u1+" (2)":s1),width:x1,textAlign:w1});}}}}return C1;};k1.prototype._removeExpandParameter=function(e){var i=e.replace(new RegExp("([\\?&]\\$expand=[^&]+)(&?)"),function(l1,m1,n1){return n1?m1.substring(0,1):"";});return i;};k1.prototype._getRowCount=function(e){var i=this._getRowBinding();if(!i){return 0;}var l1=0;if(e&&i.getTotalSize){l1=i.getTotalSize();}else{l1=i.getLength();}if(l1<0||l1==="0"){l1=0;}return l1;};k1.prototype._setExcelExportEnableState=function(){if(this._oUseExportToExcel){var i=this._getRowCount();this._oUseExportToExcel.setEnabled(i>0);}};k1.prototype._createPersonalizationController=function(){if(this._oPersController||!this.getUseTablePersonalisation()){return;}var e=this._oP13nDialogSettings;e=this._setIgnoreFromPersonalisationToSettings(e);e=e||{};if(this._isTreeTable){e.stableColumnKeys=[];e.stableColumnKeys.push(this._aColumnKeys[0]);}if(this._bIsFilterPanelEnabled){e.filter=e.filter?e.filter:{};e.filter.createMessageStrip=this._getP13nFilterMessageStrip.bind(this);}this._oPersController=new y(this.getId()+"-persoController",{table:this._oTable,columnKeys:this._aColumnKeys,setting:e,resetToInitialTableState:!this.getUseVariantManagement(),beforePotentialTableChange:[this._beforePersonalisationModelDataChange,this],afterPotentialTableChange:[this._afterPersonalisationModelDataChange,this],afterP13nModelDataChange:[this._personalisationModelDataChange,this],requestColumns:[this._personalisationRequestColumns,this]});};k1.prototype._setIgnoreFromPersonalisationToSettings=function(e){var i=P.createArrayFromString(this.getIgnoreFromPersonalisation());if(i.length){if(!e){e={};}var l1=function(m1){if(!e[m1]){e[m1]={};}e[m1].ignoreColumnKeys=i;};l1("filter");l1("sort");l1("group");l1("columns");}return e;};k1.prototype._getRowBinding=function(){if(this._oTable){return this._oTable.getBinding(this._sAggregation);}};k1.prototype.setEntitySet=function(e){this.setProperty("entitySet",e,true);this._initialiseMetadata();return this;};k1.prototype._initialiseMetadata=function(e){var i=this,l1=i;if(e){l1=e.getSource();}if(!l1.bIsInitialised){E.handleModelInit(l1,l1._onMetadataInitialised);}};k1.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){this._createTableProvider();if(this._oTableProvider){this._aTableViewMetadata=this._oTableProvider.getTableViewMetadata();if(this._aTableViewMetadata){if(!this._isMobileTable&&this.getDemandPopin()){this.setDemandPopin(false);Q.error("use SmartTable property 'demandPopin' only  with responsive table, property has been set to false");}this.detachModelContextChange(this._initialiseMetadata,this);this.bIsInitialised=true;this._bTableSupportsExcelExport=this._oTableProvider.getSupportsExcelExport();this._bMultiUnitBehaviorEnabled=this._oTableProvider.getMultiUnitBehaviorEnabled();this._listenToSmartFilter();this._createVariantManagementControl();this._createToolbarContent();this._aAlwaysSelect=this._oTableProvider.getRequestAtLeastFields();this._createContent();this._createPersonalizationController();this._oEditModel=new J({editable:this.getEditable()});this.setModel(this._oEditModel,"sm4rtM0d3l");this.attachEvent("_change",this._onPropertyChange,this);this.fireInitialise();if(!this._oVariantManagement||(this._oVariantManagement&&this._bVariantInitialised)){this._checkAndTriggerBinding();}}}}};k1.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){if(this._oSmartFilter.isInitialised()){this._oSmartFilter.search();}else{this._oSmartFilter.attachEventOnce("initialise",function(){this._oSmartFilter.search();},this);}}else{this._reBindTable();}}}};k1.prototype._aStaticProperties=["entitySet","ignoredFields","initiallyVisibleFields","ignoreFromPersonalisation","tableType","useTablePersonalisation","enableAutoBinding","persistencyKey","smartFilterId","showDetailsButton"];k1.prototype._aToolbarRelatedProperties=["useExportToExcel","exportType","showFullScreenButton","editTogglable","placeToolbarInTable"];k1.prototype._onPropertyChange=function(e){var i=e.getParameter("name");if(this._aStaticProperties.indexOf(i)>-1){Q.error("Property "+i+" cannot be changed after the SmartTable with id "+this.getId()+" is initialised");}if(this._oToolbar&&this._aToolbarRelatedProperties.indexOf(i)>-1){if(i==="exportType"&&this._oUseExportToExcel){this._oUseExportToExcel.destroy();this._oUseExportToExcel=null;}this._createToolbarContent();}};k1.prototype._createTableProvider=function(){var e,i,l1;i=this.getEntitySet();l1=this.getIgnoredFields();e=this.getModel();if(e&&i){if(this._aExistingColumns.length){if(l1){l1+=","+this._aExistingColumns.toString();}else{l1=this._aExistingColumns.toString();}}this._oTableProvider=new n({entitySet:i,ignoredFields:l1,initiallyVisibleFields:this.getInitiallyVisibleFields(),isEditableTable:this.getEditable(),smartTableId:this.getId(),isAnalyticalTable:!!this._isAnalyticalTable,isMobileTable:!!this._isMobileTable,dateFormatSettings:this.data("dateFormatSettings"),useUTCDateTime:this.data("useUTCDateTime"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),useSmartField:this.data("useSmartField"),useSmartToggle:this.data("useSmartToggle"),skipAnnotationParse:this.data("skipAnnotationParse"),lineItemQualifier:this.data("lineItemQualifier"),presentationVariantQualifier:this.data("presentationVariantQualifier"),enableInResultForLineItem:this.data("enableInResultForLineItem"),_semanticKeyAdditionalControl:this.getAggregation("semanticKeyAdditionalControl"),model:e,semanticObjectController:this.getSemanticObjectController(),showDetailsButton:this.getShowDetailsButton()});}};k1.prototype._listenToSmartFilter=function(){var e,i,l1=false;e=this.getSmartFilterId();this._oSmartFilter=this._findControl(e,"sap.ui.comp.filterbar.FilterBar");if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindTable,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this);l1=true;}i=this.getInitialNoDataText();if(i){l1=i==="$FILTERBAR";if(!l1&&i!=="$NO_FILTERBAR"){this._setNoDataText(i);return;}}if(l1){this._setNoDataText(C.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_DATA"));}else{this._setNoDataText(C.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"));}};k1.prototype._filterChangeEvent=function(){if(this._isTableBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()&&!this._oSmartFilter.isDialogOpen()){this._showOverlay(true);}};k1.prototype._showOverlay=function(e){if(e){var i={show:true};this.fireShowOverlay({overlay:i});e=i.show;}this._oTable.setShowOverlay(e);};k1.prototype._findControl=function(i,e){var l1,m1;if(i){l1=C.byId(i);if(!l1||!l1.isA(e)){m1=this._getView();if(m1){l1=m1.byId(i);}}if(l1&&!l1.isA(e)){l1=undefined;}}return l1;};k1.prototype._getView=function(){if(!this._oView){var e=this.getParent();while(e){if(e.isA("sap.ui.core.mvc.View")){this._oView=e;break;}e=e.getParent();}}return this._oView;};k1.prototype.rebindTable=function(e){this._reBindTable(null,e);};k1.prototype._reBindTable=function(e,l1){var m1,n1,o1,i,p1,q1,r1=[],s1,t1,u1,v1,w1,x1,y1,z1={},A1={preventTableBind:false};o1=this._getTablePersonalisationData()||{};if(this._oMessageFilter){s1=this._oMessageFilter;}else{s1=o1.filters;t1=o1.excludeFilters;}y1=o1.sorters;if(this._oSmartFilter){q1=this._oSmartFilter.getFilters();z1=this._oSmartFilter.getParameters()||{};}if(q1&&q1.length){if(t1){r1=[new s([q1[0],t1],true)];}else{r1=q1;}}else if(t1){r1=[t1];}if(s1){s1=r1.concat(s1);}else{s1=r1;}u1=this._getRequestAtLeastFields();w1=this._getRelevantColumnPaths();v1=w1["select"];if(!v1||!v1.length){v1=u1;}else{p1=u1.length;for(i=0;i<p1;i++){if(v1.indexOf(u1[i])<0){v1.push(u1[i]);}}}if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.select){this._mSelectExpandForGroup.select.forEach(function(D1){if(v1.indexOf(D1)<0){v1.push(D1);}});}if(v1.length){z1["select"]=v1.toString();x1=w1["expand"]||[];if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.expand){this._mSelectExpandForGroup.expand.forEach(function(D1){if(x1.indexOf(D1)<0){x1.push(D1);}});}if(x1.length){z1["expand"]=x1.join(",");}}z1["useBatchRequests"]=true;if(!y1){y1=[];}A1.filters=s1;A1.sorter=y1;A1.parameters=z1;A1.length=undefined;A1.startIndex=undefined;A1.events={};this.fireBeforeRebindTable({bindingParams:A1,messageFilterActive:!!this._bApplyFilter});if(!A1.preventTableBind){y1=A1.sorter;s1=A1.filters;z1=A1.parameters;v1=A1.parameters["select"];if(!v1||!v1.length){f.error(C.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_COLS"),{styleClass:(this.$()&&this.$().closest(".sapUiSizeCompact").length)?"sapUiSizeCompact":""});return;}n1=this.getTableBindingPath()||("/"+this.getEntitySet());if(this._oTable.resumeUpdateAnalyticalInfo){this._oTable.resumeUpdateAnalyticalInfo(true,false);}this._bDataLoadPending=true;this._bIgnoreChange=false;if(this._bForceTableUpdate){l1=true;this._bForceTableUpdate=false;}if(!l1){m1=this._oTable.getBinding(this._sAggregation);if(m1&&m1.mParameters){l1=!(W(z1,m1.mParameters,true)&&W(z1.custom,m1.mParameters.custom)&&!A1.length&&!A1.startIndex&&n1===m1.getPath());}}if(!this._bNoDataUpdated){this._bNoDataUpdated=true;this._setNoDataText();}if(!m1||!this._bIsTableBound||l1){k1._addBindingListener(A1,"change",this._onBindingChange,this);k1._addBindingListener(A1,"dataRequested",this._onDataRequested,this);k1._addBindingListener(A1,"dataReceived",this._onDataReceived,this);if(this._isMobileTable){var B1=this._oTable?this._oTable.getColumns():[];var C1=this._oTemplate?this._oTemplate.getCells():[];if(B1.length===C1.length){B1.forEach(function(D1,E1){C1[E1].setBindingContext(D1.getVisible()?undefined:null);});}}this._oTable.bindRows({path:n1,filters:s1,sorter:y1,parameters:z1,length:A1.length,startIndex:A1.startIndex,template:this._oTemplate,events:A1.events});this._bIsTableBound=true;}else{m1.sort(y1);m1.filter(s1,"Application");}this._showOverlay(false);}};k1.prototype._onDataRequested=function(e){if(e&&e.getParameter&&e.getParameter("__simulateAsyncAnalyticalBinding")){return;}this._bIgnoreChange=true;this.fireDataRequested(e.getParameters());};k1.prototype._onDataReceived=function(e){if(e&&e.getParameter&&e.getParameter("__simulateAsyncAnalyticalBinding")){return;}this._bIgnoreChange=false;this._onDataLoadComplete(e,true);this.fireDataReceived(e);};k1.prototype._onBindingChange=function(e){if(this._bIgnoreChange){return;}var i,l1=false;i=(e&&e.getParameter)?e.getParameter("reason"):undefined;if(!i||i==="filter"||i==="context"||(!this._bDataLoadPending&&i==="change")){l1=true;}if(i==="change"||l1){this._onDataLoadComplete(e,l1);}};k1._addBindingListener=function(e,i,l1,m1){if(!e.events){e.events={};}if(!e.events[i]){e.events[i]=l1.bind(m1);}else{var n1=e.events[i];e.events[i]=function(){l1.apply(m1,arguments);n1.apply(m1,arguments);};}};k1.prototype._onDataLoadComplete=function(e,i){if(this._bDataLoadPending||i){this._bDataLoadPending=false;this.updateTableHeaderState();}};k1.prototype._isTableBound=function(){if(this._bIsTableBound){return true;}if(this._oTable){return this._oTable.isBound(this._sAggregation);}return false;};k1.prototype.setNoData=function(e){this._oNoData=e;if(this._bNoDataUpdated||this._isTableBound()){this._setNoDataText();}return this;};k1.prototype.getNoData=function(){return this._oNoData;};k1.prototype._setNoDataText=function(e){var i=this._oTable.setNoData;if(!i){i=this._oTable.setNoDataText;}if(!i){return;}var l1=e;if(!l1){l1=this.getNoData();}if(!l1){l1=C.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS");}i.call(this._oTable,l1,true);};k1.prototype.updateTableHeaderState=function(){this._refreshHeaderText();this._setExcelExportEnableState();};k1.prototype._createContent=function(){var i,e=0,l1,m1,n1,o1=[];if(this._aExistingColumns&&this._aExistingColumns.length){this._aColumnKeys=[].concat(this._aExistingColumns.reverse());}m1=this._parseIndexedColumns();e=this._aTableViewMetadata.length;for(i=0;i<e;i++){l1=this._aTableViewMetadata[i];if(l1.isInitiallyVisible){this._aColumnKeys.push(l1.name);}else{o1.push(l1.name);}if(!(l1.isInitiallyVisible||l1.inResult)){this._mLazyColumnMap[l1.name]=l1;}else{n1=this._createColumnForField(l1);this._oTable.addColumn(n1);}this._mFieldMetadataByKey[l1.name]=l1;}this._insertIndexedColumns(m1);this._aColumnKeys=this._aColumnKeys.concat(o1);this._updateColumnsPopinFeature();if(this.getShowDetailsButton()){this._oTable.setHiddenInPopin(I.system.phone?["Low","Medium"]:["Low"]);}this._storeInitialColumnSettings();};k1.prototype._createColumnForField=function(e){var i,l1;l1=this.getId()+"-"+e.name.replace(/[^A-Za-z0-9_.:-]+/g,"_");i=this._createColumn(e,l1);e.isColumnCreated=true;i.data("p13nData",{columnKey:e.name,leadingProperty:e.name,additionalProperty:e.additionalProperty,navigationProperty:e.navigationProperty,sortProperty:e.sortable?e.name:undefined,filterProperty:e.filterable?e.name:undefined,isGroupable:e.sortable&&e.filterable&&e.aggregationRole==="dimension",fullName:e.hasValueListAnnotation?e.fullName:null,type:e.filterType,typeInstance:e.modelType,maxLength:e.maxLength,precision:e.precision,scale:e.scale,align:e.align,edmType:e.type,displayBehaviour:e.displayBehaviour,description:e.description,isDigitSequence:e.isDigitSequence,isCurrency:e.isCurrencyField,unit:e.unit,width:e.width,aggregationRole:e.aggregationRole,nullable:e.nullable!=="false"});if(e.filterable&&i.setFilterProperty){i.setFilterProperty(e.name);}if(e.sortable&&i.setSortProperty){i.setSortProperty(e.name);}this._registerContentTemplateEvents(e.template);return i;};k1.prototype._parseIndexedColumns=function(){var i,e,l1,m1,n1,o1,p1,q1,r1;var s1=this._oTable.getColumns();var t1=null;if(this._oTemplate&&this._oTemplate.getCells){t1=this._oTemplate.getCells();}if(!s1){return null;}m1=[];e=s1.length;for(i=0;i<e;i++){l1=s1[i];n1=l1.data("p13nData");o1=null;p1=null;if(n1){o1=n1.columnIndex;p1=n1.columnKey;}q1=-1;if(o1!==null&&o1!==undefined){q1=parseInt(o1);}if(!isNaN(q1)&&q1>-1){if(t1){r1=t1[i];this._oTemplate.removeCell(r1);}else{r1=null;}this._aColumnKeys.splice(i-m1.length,1);m1.push({index:q1,columnKey:p1,column:l1,template:r1});this._oTable.removeColumn(l1);}}m1.sort(function(u1,v1){return u1.index-v1.index;});return m1;};k1.prototype._insertIndexedColumns=function(e){var i,l1,m1;if(!e){return;}l1=e.length;for(i=0;i<l1;i++){m1=e[i];this._aColumnKeys.splice(m1.index,0,m1.columnKey);this._oTable.insertColumn(m1.column,m1.index);if(m1.template){this._oTemplate.insertCell(m1.template,m1.index);}}};k1.prototype._updateColumnsPopinFeature=function(){if(!this._isMobileTable||!this.getDemandPopin()){return;}if(!this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(true);}var e=this._oTable.getColumns(true);if(!e){return;}e=e.filter(function(i){return i.getVisible();});e.forEach(function(i){if(i.getPopinDisplay()!="WithoutHeader"){i.setPopinDisplay("Inline");}});};k1.prototype._storeInitialColumnSettings=function(){this._aInitialSorters=[];P.createSort2Json(this._oTable,this._aInitialSorters,P.createArrayFromString(this.getIgnoreFromPersonalisation()));};k1.prototype._deactivateColumnsPopinFeature=function(){if(!this._isMobileTable){return;}if(this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(false);}var e=this._oTable.getColumns();if(!e){return;}var l1,m1=e.length;for(var i=0;i<m1;i++){l1=e[i];l1.setDemandPopin(false);l1.setMinScreenWidth("1px");}};k1.prototype._registerContentTemplateEvents=function(e){if(e.isA("sap.ui.comp.SmartToggle")){e=e.getEdit();}if(e&&e.attachChange){e.attachChange(function(i){this.fireFieldChange({changeEvent:i});},this);}};k1.prototype._updateInitialColumns=function(){var i=this._oTable.getColumns(),l1=i?i.length:0,m1,n1,o1;while(l1--){o1=null;m1=i[l1];if(m1){n1=m1.data("p13nData");if(typeof n1==="string"){try{n1=JSON.parse(n1);}catch(e){}if(n1){m1.data("p13nData",n1);}}if(n1){o1=n1["columnKey"];}if(o1){this._aExistingColumns.push(o1);}}}};k1.prototype._getRelevantColumnPaths=function(){var e={},l1=[],m1=[],n1=this._oTable.getColumns(),i,o1=n1?n1.length:0,p1,q1,r1,s1,t1;var u1=function(r1,v1){var w1,x1;if(r1){x1=r1.split(",");w1=x1.length;while(w1--){r1=x1[w1];if(r1&&v1.indexOf(r1)<0){v1.push(r1);}}}};for(i=0;i<o1;i++){p1=n1[i];r1=null;if(p1.getVisible()||(p1.getInResult&&p1.getInResult())){if(p1.getLeadingProperty){r1=p1.getLeadingProperty();}q1=p1.data("p13nData");if(q1){if(!r1){r1=q1["leadingProperty"];}s1=q1["additionalProperty"];t1=q1["navigationProperty"];}if(r1&&l1.indexOf(r1)<0){l1.push(r1);}u1(s1,l1);u1(t1,m1);}}e["select"]=l1;e["expand"]=m1;return e;};k1.prototype._createTable=function(){var e=this.getItems(),i=e?e.length:0,l1,m1;this._sAggregation="rows";while(i--){l1=e[i];if(l1 instanceof w||l1 instanceof R){break;}l1=null;}if(l1){this._oTable=l1;if(l1 instanceof u){this._isAnalyticalTable=true;}else if(l1 instanceof R){this._isMobileTable=true;this._oTemplate=(l1.getItems()&&l1.getItems().length>0)?l1.getItems()[0]:new b();l1.removeAllItems();}else if(l1 instanceof x){this._isTreeTable=true;}this._updateInitialColumns();}else{m1=this.getId()+"-ui5table";if(this.getTableType()==="AnalyticalTable"){this._isAnalyticalTable=true;this._oTable=new u(m1,{enableCustomFilter:true});}else if(this.getTableType()==="ResponsiveTable"){this._isMobileTable=true;this._oTable=new R(m1,{growing:true,autoPopinMode:this.getDemandPopin()});this._oTemplate=new b();}else if(this.getTableType()==="TreeTable"){this._isTreeTable=true;this._oTable=new x(m1,{selectionMode:"MultiToggle"});}else{this._oTable=new w(m1,{selectionMode:"MultiToggle"});}if(this._oTable.setVisibleRowCountMode){this._oTable.setVisibleRowCountMode("Auto");}this.insertItem(this._oTable,2);}if(!this._oTable.getLayoutData()){if(this._oTable instanceof R||(this._oTable.getVisibleRowCountMode&&this._oTable.getVisibleRowCountMode()!=="Auto")){this._oTable.setLayoutData(new l({growFactor:1,baseSize:"auto"}));}else{this._oTable.setLayoutData(new l({growFactor:1,baseSize:"0%"}));}}this._oTable.addStyleClass("sapUiCompSmartTableInnerTable");this._oTable.setEnableBusyIndicator(true);this._oTable.setBusyIndicatorDelay(100);if(this._oTable.setEnableCustomFilter){this._oTable.setEnableCustomFilter(this.getEnableCustomFilter());}if(this._oTable.setShowColumnVisibilityMenu){this._oTable.setShowColumnVisibilityMenu(false);}if(this._oTable.getEnableCustomFilter&&this._oTable.getEnableCustomFilter()&&this._bIsFilterPanelEnabled){if(this._oTable.setEnableCellFilter){this._oTable.setEnableCellFilter(false);}if(this._oTable.attachCustomFilter){this._oTable.attachCustomFilter(this._onCustomFilter,this);}}if(this._isAnalyticalTable){this._createColumn=this._createAnalyticalColumn;}else if(this._isMobileTable){if(this.getUseTablePersonalisation()){this._oTable.bActiveHeaders=true;this._oTable.attachEvent("columnPress",this._onColumnPress,this);this._oTable.attachSort=function(){this.attachEvent("sort",arguments[0],arguments[1],arguments[2]);};this._oTable.detachSort=function(){this.detachEvent("sort",arguments[0],arguments[1]);};if(this.getShowDetailsButton()){this._oTable.attachEvent("popinChanged",this._onPopinChanged,this);}}this._sAggregation="items";this._createColumn=this._createMobileColumn;this._oTable.bindRows=this._oTable.bindItems;}if(!this._isMobileTable){this._oTable.attachEvent("_rowsUpdated",function(){this._setExcelExportEnableState();},this);}if(this._oTable._setLargeDataScrolling){this._oTable._setLargeDataScrolling(true);}this._oTable.attachPaste(this._onInnerTablePaste,this);};k1.prototype._createResponsivePopover=function(){this._oFilterButton=new Z({text:C.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_RP_FILTER"),icon:"sap-icon://filter",press:[function(e){this._onCustomFilter(e);},this]});this._oSortButton=new $({sort:[function(e){this._onCustomSort(e);},this]});this._oColumnHeaderPopover=new Y({items:[this._oSortButton,this._oFilterButton]});};k1.prototype._onColumnPress=function(e){this._oColumnClicked=e.getParameter("column");var i=this._oColumnClicked.data("p13nData");if(!i){return;}var l1=i.filterProperty;var m1=i.sortProperty;if(!this._oColumnHeaderPopover){this._createResponsivePopover();}this._oFilterButton.setVisible(!!l1&&this._bIsFilterPanelEnabled);this._oSortButton.setVisible(!!m1&&this._bIsSortPanelEnabled);if((l1&&this._bIsFilterPanelEnabled)||(m1&&this._bIsSortPanelEnabled)){this._oColumnHeaderPopover.removeAllAriaLabelledBy();this._oColumnHeaderPopover.addAriaLabelledBy(this._oColumnClicked.getHeader());this._oColumnHeaderPopover.openBy(this._oColumnClicked);}};k1.prototype._filterByDataStateError=function(e){if(!e){var i=!!this._oMessageFilter;this._oMessageFilter=null;this._createInfoToolbar();if(i){this.rebindTable();}}else{var l1=this._getRowBinding();if(l1&&this._oDataStateIndicator){var m1=this._oDataStateIndicator,n1=m1.getFilter(),o1=n1?function(p1){return n1(p1,m1.getControl());}:undefined;l1.requestFilterForMessages(o1).then(function(p1){if(!p1){return;}this._oMessageFilter=p1;this.rebindTable();this._createInfoToolbar(true);}.bind(this));}}};k1.prototype._onCustomSort=function(){var e=this._oColumnClicked.data("p13nData");if(e){if(!e.sorted){e.sorted={"ascending":true};this._oColumnClicked.data("p13nData",e);}else{e.sorted.ascending=!e.sorted.ascending;}}var i=e.sorted;var l1=i&&i.ascending;this._oTable.fireEvent("sort",{column:this._oColumnClicked,sortOrder:l1?i1.Ascending:i1.Descending,columnAdded:false});};k1.prototype._onCustomFilter=function(e){this._showTableFilterDialog(e.getParameter("column")||this._oColumnClicked);};k1.prototype._onPopinChanged=function(e){var i=e.getParameter("hasPopin");var l1=e.getParameter("hiddenInPopin");if(l1.length||(i&&!this.bHideDetails)){this._oShowHideDetailsButton.setVisible(true);}else{this._oShowHideDetailsButton.setVisible(false);}};k1.prototype.getTable=function(){return this._oTable;};k1.prototype._showTableFilterDialog=function(e){if(this._oPersController){var i={filter:{visible:true}};if(e){i.filter["payload"]={column:e};}this._oPersController.openDialog(i);}};k1.prototype._createColumn=function(e,i){var l1;l1=new v(i,{autoResizable:true,hAlign:e.align,width:e.width,visible:e.isInitiallyVisible,label:new d(i+"-header",{textAlign:e.align,text:e.label}),sorted:e.sorted,sortOrder:e.sortOrder,tooltip:e.quickInfo,showSortMenuEntry:e.sortable&&this._bIsSortPanelEnabled,showFilterMenuEntry:e.filterable&&this._bIsFilterPanelEnabled,name:e.fieldName,template:e.template});return l1;};k1.prototype._createAnalyticalColumn=function(e,i){var l1;if(e.aggregationRole!=="measure"&&e.isMeasureField&&e.unit&&e.template.addStyleClass){e.template.addStyleClass("sapUiAnalyticalTableSumCellHidden sapUiAnalyticalTableGroupCellHidden");}else if(e.isCurrencyField&&e.template.addStyleClass){e.template.addStyleClass("sapUiCompCurrencyBold");}l1=new A(i,{autoResizable:true,hAlign:e.align,width:e.width,visible:e.isInitiallyVisible,inResult:e.inResult,label:new d(i+"-header",{textAlign:e.align,text:e.label}),tooltip:e.quickInfo,sorted:e.sorted,sortOrder:e.sortOrder,grouped:e.grouped,showIfGrouped:e.grouped,showSortMenuEntry:e.sortable&&this._bIsSortPanelEnabled,showFilterMenuEntry:e.filterable&&this._bIsFilterPanelEnabled,summed:e.summed,leadingProperty:e.name,template:e.template,groupHeaderFormatter:z.getInlineGroupFormatterFunction(e,true)});return l1;};k1.prototype._createMobileColumn=function(e,i){var l1;l1=new a(i,{hAlign:e.align,visible:e.isInitiallyVisible,header:new d(i+"-header",{textAlign:e.align,text:e.label,tooltip:e.quickInfo,wrapping:true,wrappingType:M.WrappingType.Hyphenated}),tooltip:e.quickInfo,width:e.isImageURL?"3em":undefined});if(this.getShowDetailsButton()&&e.importance){l1.setImportance(e.importance);}if(this._oTemplate){this._oTemplate.addCell(e.template);}return l1;};k1.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{};}return this._oCurrentVariant;};k1.prototype.applyVariant=function(e,i){this._oCurrentVariant=e;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null;}this._bApplyingVariant=true;if(this._oTable._setSuppressRefresh){this._oTable._setSuppressRefresh(true);}if(this._oPersController){if(this._oCurrentVariant===null||q.isEmptyObject(this._oCurrentVariant)){this._oPersController.resetPersonalization("ResetFull");}else{this._oPersController.setPersonalizationData(this._oCurrentVariant,true);}}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId()});};k1.prototype.variantsInitialized=function(){this._bVariantInitialised=true;this._checkAndTriggerBinding();};k1.prototype.getUiState=function(){var e=this._oPersController?this._oPersController.getDataSuiteFormatSnapshot():null;return new U({presentationVariant:{SortOrder:e?e.SortOrder:[],GroupBy:e?e.GroupBy:[],Total:e?e.Total:[],RequestAtLeast:this._getRequestAtLeastFields(),Visualizations:e?e.Visualizations:[]},selectionVariant:{SelectOptions:e?e.SelectOptions:[]},variantName:this.getCurrentVariantId()});};k1.prototype.setUiState=function(e){this._setUiState(e,false);};k1.prototype.setUiStateAsVariant=function(e){this._setUiState(e,true);};k1.prototype._setUiState=function(e,i){var l1=e.getPresentationVariant()&&e.getPresentationVariant().RequestAtLeast?[].concat(e.getPresentationVariant().RequestAtLeast):[];if(!W(l1,this._getRequestAtLeastFields())){this._aAlwaysSelect=l1;}if(this._oPersController){if(i){this._oPersController.setPersonalizationDataAsDataSuiteFormat(X({},e.getPresentationVariant(),e.getSelectionVariant()),true);}else{var m1=(this._oVariantManagement&&e.getVariantName())?this._oVariantManagement.getVariantContent(this,e.getVariantName()):{};this._oPersController.setDataSuiteFormatSnapshot(X({},e.getPresentationVariant(),e.getSelectionVariant()),m1,true);}}};k1.prototype._getRequestAtLeastFields=function(){var e=this.getRequestAtLeastFields();var i=e?e.split(","):[];return i.concat(this._aAlwaysSelect);};k1.prototype._personalisationRequestColumns=function(e){var l1=e.getParameter("columnKeys"),m1,i,n1,o1,p1,q1={};n1=l1.length;for(i=0;i<n1;i++){m1=l1[i];o1=this._mLazyColumnMap[m1];if(o1){p1=this._createColumnForField(o1);if(this._isMobileTable){this._oTable.addColumn(p1);}q1[o1.name]=p1;}}this._oPersController.addColumns(q1);};k1.prototype._beforePersonalisationModelDataChange=function(e){if(this._oTable.suspendUpdateAnalyticalInfo){this._oTable.suspendUpdateAnalyticalInfo();}};k1.prototype._afterPersonalisationModelDataChange=function(e){this._updateColumnsPopinFeature();};k1.prototype._personalisationModelDataChange=function(e){this._oCurrentVariant=e.getParameter("persistentData");var i=e.getParameter("runtimeDeltaDataChangeType");var l1=this._getChangeStatus(i);if(l1==="Unchanged"){return;}if(!(this._bApplyingVariant||this._bDeactivatingColumns)){if(!this.getUseVariantManagement()){this._persistPersonalisation();}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true);}}if(l1==="ModelChanged"&&this._isTableBound()){if(i&&i.columns==="ModelChanged"){this._bForceTableUpdate=true;}if(this._oSmartFilter){this._oSmartFilter.search();}else{this._reBindTable(null);}}if(this._isMobileTable){this._adaptCustomSort();}this._createInfoToolbar();};k1.prototype._adaptCustomSort=function(){if(this._oCurrentVariant){var e,i,l1,m1=[],n1;if(this._oCurrentVariant.sort&&this._oCurrentVariant.sort.sortItems){m1=this._oCurrentVariant.sort.sortItems;}this._oTable.getColumns().forEach(function(o1){e=o1.data("p13nData");i=e&&e.columnKey;if(i){l1=m1.filter(function(p1){return i===p1.columnKey;});n1=l1[0];if(n1){if(!e.sorted){e.sorted={"ascending":false};}if(n1.operation!==i1.Descending){e.sorted={"ascending":true};}o1.setSortIndicator(n1.operation);}else if(e&&e.sorted){e.sorted=null;o1.setSortIndicator(c.None);}}else if(o1.getSortIndicator()!==i1.None){o1.setSortIndicator(i1.None);}},this);}};k1.prototype.setUseInfoToolbar=function(e){this.setProperty("useInfoToolbar",e,true);if(this.getTable()){this._createInfoToolbar();}return this;};k1.prototype._updateInfoToolbar=function(i,e){if(!this._oInfoToolbar){this._oInfoToolbar=new O({active:true,visible:true,design:h1.Info,content:[new T({id:this.getId()+"-infoToolbarText",text:i,wrapping:false})],press:[e,this._handleInfoToolbarPress,this]});}else{this._oInfoToolbar.setVisible(true);this._oInfoToolbar.getContent()[0].setText(i);this._oInfoToolbar.detachPress(this._handleInfoToolbarPress,this);this._oInfoToolbar.attachPress(e,this._handleInfoToolbarPress,this);}};k1.prototype._handleInfoToolbarPress=function(e,i){this._showTableFilterDialog(i);};k1.prototype._createInfoToolbar=function(e){var i=this.getUseInfoToolbar(),l1=this.getTable(),m1=this.getId()+"-infoToolbarText",n1,o1=C.getLibraryResourceBundle("sap.ui.comp");if(i===j1.Off){if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);l1.removeAriaLabelledBy(m1);}return;}if(e){var p1=o1.getText("SMARTTABLE_INFOTOOLBAR_FILTERED_BY",[o1.getText("SMARTTABLE_INFOTOOLBAR_MESS_"+this._sDataStateType)]);this._updateInfoToolbar(p1);if(this._isMobileTable&&!l1.getInfoToolbar()){l1.setInfoToolbar(this._oInfoToolbar);}else if(!this._isMobileTable){var q1=l1.getExtension().some(function(w1){return w1.getId()===this._oInfoToolbar.getId();},this);if(!q1){l1.addExtension(this._oInfoToolbar);}}if(l1.getAriaLabelledBy().indexOf(m1)===-1){l1.addAriaLabelledBy(m1);}}else if(this._isMobileTable){if(l1.getInfoToolbar()&&!this._oInfoToolbar){Q.error("Custom infoToolbar is used, hence set useInfoToolbar property on the SmartTable with id='"+this.getId()+"' to Off");return;}var r1=this._oCurrentVariant&&this._oCurrentVariant.filter&&this._oCurrentVariant.filter.filterItems,s1=r1&&r1.length;if(s1){var t1=[],u1=L.getInstance();r1.forEach(function(w1){var x1=this._getColumnLabel(w1.columnKey);if(x1&&t1.indexOf(x1)===-1){t1.push(x1);}},this);var v1=o1.getText("SMARTTABLE_INFOTOOLBAR_FILTERED_BY",[u1.format(t1)]);n1=this._getColumnByKey(r1[0].columnKey);this._updateInfoToolbar(v1,n1);if(!l1.getInfoToolbar()){l1.setInfoToolbar(this._oInfoToolbar);}if(l1.getAriaLabelledBy().indexOf(m1)===-1){l1.addAriaLabelledBy(m1);}}else if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);l1.removeAriaLabelledBy(m1);}}else if(this._oInfoToolbar){this._oInfoToolbar.setVisible(false);}};k1.prototype._getChangeStatus=function(e){if(!e){return"ModelChanged";}if(e.sort==="ModelChanged"||e.filter==="ModelChanged"||e.columns==="ModelChanged"||e.group==="ModelChanged"){return"ModelChanged";}if(e.sort==="TableChanged"||e.filter==="TableChanged"||e.columns==="TableChanged"||e.group==="TableChanged"){return"TableChanged";}return"Unchanged";};k1.prototype._getTablePersonalisationData=function(){this._mSelectExpandForGroup=null;if(!this._oCurrentVariant){return null;}var e=[],i=[],l1=[],m1,n1,o1,p1,q1,r1,s1,t1,u1,v1,w1={},x1={},y1="",z1;if(this._isMobileTable&&this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){n1=this._oCurrentVariant.group.groupItems[0];if(this._aDeactivatedColumns.indexOf(n1.columnKey)<0){q1=this._getColumnByKey(n1.columnKey);if(q1){y1=q1.getHeader().getText();}v1=this._getPathFromColumnKeyAndProperty(n1.columnKey,"sortProperty");}if(v1){s1=v1;t1=null;var A1=this._mFieldMetadataByKey[n1.columnKey],B1;if(A1){t1=A1.unit||A1.description;B1=z.getInlineGroupFormatterFunction(A1);}o1=new r(s1,n1.operation==="GroupDescending",function(E1){var F1=E1.getProperty(s1),G1;if(B1){if(t1){G1=E1.getProperty(t1);}F1=B1(F1,G1);}if(F1===undefined||F1===null){F1="";}return{key:F1,text:y1?y1+": "+F1:F1};});this._mSelectExpandForGroup={select:[s1]};if(A1){if(A1.additionalProperty){this._mSelectExpandForGroup.select.push(A1.additionalProperty);}if(A1.navigationProperty){this._mSelectExpandForGroup.expand=[A1.navigationProperty];}}e.push(o1);}}if(this._oCurrentVariant.sort){p1=this._oCurrentVariant.sort.sortItems;}else{p1=this._aInitialSorters;}if(p1){p1.forEach(function(E1,F1){var G1=E1.operation==="Descending";v1=null;u1=null;if(this._aDeactivatedColumns.indexOf(E1.columnKey)<0){v1=this._getPathFromColumnKeyAndProperty(E1.columnKey,"sortProperty");}if(v1){if(o1&&o1.sPath===v1){o1.bDescending=G1;}else{var A1=this._mFieldMetadataByKey[E1.columnKey];if(!A1){q1=this._getColumnByKey(E1.columnKey);r1=q1.data("p13nData");}if(this._bMultiUnitBehaviorEnabled&&((A1&&A1.isCurrencyField)||(r1&&r1.isCurrency))){u1=A1?A1.unit:r1.unit;if(u1&&!w1[u1]){w1[u1]={index:F1,descending:G1};}}x1[v1]={};if(x1[u1]){delete w1[u1];}else if(w1[v1]){delete w1[v1];}e.push(new r(v1,G1));}}},this);var C1=Object.keys(w1),D1;if(C1.length){C1.reverse().forEach(function(E1){D1=o1?w1[E1].index+1:w1[E1].index;e.splice(D1,0,new r(E1,w1[E1].descending));});}}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(E1){var F1=E1.value1,G1=E1.value2,H1;v1=null;z1=false;q1=null;if(this._aDeactivatedColumns.indexOf(E1.columnKey)<0){q1=this._getColumnByKey(E1.columnKey);}if(q1){if(q1.getFilterProperty){v1=q1.getFilterProperty();}r1=q1.data("p13nData");if(r1){z1=r1.type==="time";if(!v1){v1=r1["filterProperty"];}}}if(v1){if(z1){if(F1 instanceof Date){F1=z.getEdmTimeFromDate(F1);}if(G1 instanceof Date){G1=z.getEdmTimeFromDate(G1);}}else{var I1=r1&&r1.typeInstance&&r1.typeInstance.getName()==="sap.ui.model.odata.type.DateTimeOffset";if(F1 instanceof Date&&!I1&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){F1=D.localToUtc(F1);G1=G1?D.localToUtc(G1):G1;}}var J1=(E1.exclude?l1:i);if(E1.operation==="Empty"){var K1=E1.exclude?t.NE:t.EQ;if(r1.edmType==="Edm.String"||r1.type==="string"){J1.push(new s(v1,K1,""));}if(r1.nullable){J1.push(new s(v1,K1,null));}}else{H1=E1.exclude?F.getTransformedExcludeOperation(E1.operation):E1.operation;J1.push(new s(v1,H1,F1,G1));}}},this);if(l1.length){m1=new s(l1,true);}}return{filters:i,excludeFilters:m1,sorters:e};};k1.prototype._getColumnByKey=function(e){var l1,m1,n1,i,o1;if(this._oTable){l1=this._oTable.getColumns();n1=l1.length;for(i=0;i<n1;i++){m1=l1[i];o1=m1.data("p13nData");if(o1&&o1.columnKey===e){return m1;}}}return null;};k1.prototype._getPathFromColumnKeyAndProperty=function(e,i){var l1=null,m1,n1;m1=this._getColumnByKey(e);if(m1){if(i=="sortProperty"&&m1.getSortProperty){l1=m1.getSortProperty();}else if(i=="filterProperty"&&m1.getFilterProperty){l1=m1.getFilterProperty();}else if(i=="leadingProperty"&&m1.getLeadingProperty){l1=m1.getLeadingProperty();}if(!l1){n1=m1.data("p13nData");if(n1){l1=n1[i];}}}return l1;};k1.prototype._persistPersonalisation=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){var e=this.getCurrentVariantId();if(!this._bSaving){this._bSaving=true;this._oVariantManagement.fireSave({name:"Personalisation",implicit:true,global:false,overwrite:!!e,key:e,def:true});delete this._bSaving;}}};k1.prototype.getCurrentVariantId=function(){return this._oVariantManagement?this._oVariantManagement.getCurrentVariantId():"";};k1.prototype.setCurrentVariantId=function(e){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantId(e);}else{Q.error("sap.ui.comp.smarttable.SmartTable.prototype.setCurrentVariantId: VariantManagement does not exist, or is a page variant");}return this;};k1.prototype.isInitialised=function(){return!!this.bIsInitialised;};k1.prototype._aAvailablePanels=["Columns","Sort","Filter","Group"];k1.prototype.openPersonalisationDialog=function(e){if(!e||this._aAvailablePanels.indexOf(e)<0){Q.warning("sap.ui.comp.smarttable.SmartTable.prototype.openPersonalisationDialog: "+e+" is not a valid panel!");return;}if(this._oPersController){var i={};i[e.toLowerCase()]={visible:true};this._oPersController.openDialog(i);}};k1.prototype.deactivateColumns=function(e){this._aDeactivatedColumns=e||[];this._bDeactivatingColumns=true;if(this._oPersController){this._oPersController.addToSettingIgnoreColumnKeys(this._aDeactivatedColumns);}this._bDeactivatingColumns=false;};k1.prototype._onInnerTablePaste=function(e){if(!this.hasListeners("beforePaste")&&!this.hasListeners("paste")){return;}var i=e.getParameter("data");var l1=i.slice(0);var m1=this._getColumnInfoForPaste();if(this.fireBeforePaste({columnInfos:m1})){sap.ui.require(["sap/ui/core/util/PasteHelper"],function(n1){n1.parse(l1,m1).then(function(o1){this.firePaste({result:o1});}.bind(this));}.bind(this));}};k1.prototype._getColumnInfoForPaste=function(){var e=[],l1=this._oTable.getColumns(),i,m1=l1.length,n1,o1,p1,q1,r1,s1;if(this._isMobileTable&&l1.length){l1=l1.sort(function(t1,u1){return t1.getOrder()-u1.getOrder();});}for(i=0;i<m1;i++){n1=l1[i];p1=null;s1=null;if(n1.getVisible()){if(n1.getLeadingProperty){p1=n1.getLeadingProperty();}o1=n1.data("p13nData");if(!p1&&o1){p1=o1["leadingProperty"];}q1=o1.type==="numeric"?"number":o1.type;r1=o1["typeInstance"];if(o1.isCurrency||q1==="number"){s1=o1.unit;}else if(o1.description&&o1.displayBehaviour!=="idOnly"){s1=o1.description;}}e.push({columnId:n1.getId(),property:p1,ignore:!p1,type:r1});r1=G.getType("Edm.String");if(s1){e.push({columnId:n1.getId(),additionalProperty:true,property:s1,type:r1});}}return e;};k1.prototype.exit=function(){var i,e;this.detachEvent("_change",this._onPropertyChange,this);if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindTable,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this);this._oSmartFilter=null;}if(this._oTableProvider&&this._oTableProvider.destroy){this._oTableProvider.destroy();}this._oTableProvider=null;if(this._oPersController&&this._oPersController.destroy){this._oPersController.destroy();}this._oPersController=null;if(this._oVariantManagement){this._oVariantManagement.detachSave(this._variantSaved,this);this._oVariantManagement.detachAfterSave(this._variantAfterSave,this);if(!this._oVariantManagement.isPageVariant()&&this._oVariantManagement.destroy){this._oVariantManagement.destroy();}}this._oNumberFormatInstance=null;B.cleanUpFullScreen(this);if(this._oEditModel){this._oEditModel.destroy();}if(this._oNoData&&this._oNoData.destroy){this._oNoData.destroy();}this.oNoData=null;if(this._aTableViewMetadata){i=this._aTableViewMetadata.length;while(i--){e=this._aTableViewMetadata[i];if(e&&!e.isColumnCreated&&e.template){e.template.destroy();}}}this._aTableViewMetadata=null;this._mFieldMetadataByKey=null;this._mSelectExpandForGroup=null;this._oEditModel=null;this._oVariantManagement=null;this._oCurrentVariant=null;this._aExistingColumns=null;this._mLazyColumnMap=null;this._aColumnKeys=null;this._aDeactivatedColumns=null;this._aAlwaysSelect=null;this._oCustomToolbar=null;if(this._oToolbar&&!this._bToolbarInsertedIntoItems){this._oToolbar.destroy();}this._oToolbar=null;if(this._oUseExportToExcel&&!this.getUseExportToExcel()){this._oUseExportToExcel.destroy();}this._oUseExportToExcel=null;this._oTablePersonalisationButton=null;this._oP13nDialogSettings=null;if(this._oTemplate){this._oTemplate.destroy();}this._oTemplate=null;if(this._oColumnHeaderPopover){this._oColumnHeaderPopover.destroy();}this._oColumnHeaderPopover=null;this._oFilterButton=null;this._oSortButton=null;this._oInfoToolbar=null;this._oView=null;this._oTable=null;};return k1;});
