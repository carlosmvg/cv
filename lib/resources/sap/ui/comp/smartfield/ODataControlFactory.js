/*
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/library","sap/m/library","sap/ui/comp/library","sap/ui/model/BindingMode","sap/m/TextArea","sap/m/Link","sap/m/CheckBox","sap/m/ComboBox","sap/m/DatePicker","sap/m/DateTimePicker","sap/m/FlexItemData","sap/m/HBox","sap/m/Input","sap/m/Select","sap/m/Text","sap/ui/core/Renderer","sap/ui/comp/navpopover/SmartLink","./ControlFactoryBase","./FieldControl","./ODataControlSelector","./ODataHelper","./ODataTypes","./TextArrangementDelegate","sap/m/ObjectNumber","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/TimePicker","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartfield/Configuration","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/navpopover/NavigationPopoverHandler","sap/ui/core/InvisibleText","sap/base/Log","sap/base/assert","sap/base/security/URLWhitelist","sap/base/util/merge","sap/base/strings/capitalize"],function(c,m,l,B,T,L,C,a,D,b,F,H,I,S,d,R,e,f,g,O,h,j,k,o,p,q,r,s,t,u,M,v,N,w,x,y,U,z,A){"use strict";var V=c.ValueState;var E=c.TextAlign;var G=m.InputType;var J=m.FlexJustifyContent;var K=l.smartfield.CriticalityRepresentationType;var P=l.smartfield.ControlContextType;var Q=c.TextDirection;var W=m.FlexAlignContent;var X;var Y=f.extend("sap.ui.comp.smartfield.ODataControlFactory",{constructor:function(i,n,Z){f.call(this,i,n);this.sName="ODataControlFactory";this._oMetaData={annotations:{}};this._oMeta=Z;this._oHelper=new h(i,this._oBinding);this._oFieldControl=new g(n,this._oHelper);this._oTypes=new j(n);this._oSelector=new O(this._oMetaData,n,this._oTypes);this.oTextArrangementDelegate=new k(this);this._bInitialized=false;this.bPending=false;this._oAmountInputFlexItemData=null;this._oUOMInputFlexItemData=null;this._oUOMTextFlexItemData=null;this.oMeasureField=null;X=sap.ui.require("sap/ui/comp/smartfield/SmartField");if(!X){throw new Error("SmartField module not loaded for "+this);}}});Y.prototype._init=function(i){this._oMetaData.model=i.model;this._oMetaData.path=i.path;this._oMetaData.entitySet=i.entitySetObject||this._oHelper.oMeta.getODataEntitySet(i.entitySet);if(this._oHelper.oMeta){y(this._oMetaData.entitySet,'The entity set named "'+i.entitySet+'" was not found in the "'+this._oHelper.oMeta.getODataEntityContainer().name+'" entity container of the service metadata document. - '+this.getMetadata().getName());}this._oMetaData.entityType=i.entityType||this._oHelper.oMeta.getODataEntityType(this._oMetaData.entitySet.entityType);this._oMetaData.navigationPath=i.navigationPath||null;if(this._oModel){this._oHelper.checkNavigationProperty(this._oMetaData,this._oParent);this._oHelper.getProperty(this._oMetaData);var n=this.getEdmProperty();y(!!n,'The EDM property "'+i.path+'" was not found in the "'+this._oMetaData.entityType.namespace+"."+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(n){this._oMetaData.annotations.text=this._oHelper.getTextProperty2(this._oMetaData);this._oMetaData.annotations.uom=this._oHelper.getUnitOfMeasure2(this._oMetaData);this._oHelper.getValueListData(this._oMetaData);this._oMetaData.annotations.lineitem=this._oHelper.getAnalyzer().getLineItemAnnotation(this._oMetaData.entitySet.entityType);this._oHelper.getUOMValueListAnnotationPath(this._oMetaData);this._oMetaData.annotations.semantic=M.getSemanticObjectsFromProperty(n);this._oMetaData.annotations.semanticKeys=this._oHelper.getAnalyzer().getSemanticKeyAnnotation(this._oMetaData.entitySet.entityType);if(this._oMetaData.annotations.uom){this._oMetaData.annotations.uom.annotations={};this._oHelper.getValueListData(this._oMetaData.annotations.uom);}this._oHelper.getUOMTextAnnotation(this._oMetaData);if(this._oParent&&this._oParent.getExpandNavigationProperties()){var Z=this._oParent.getBindingContext(),$=Z&&Z.getObject(),_=$&&$.__metadata.created;if(!_){var a1=this._oHelper.getAutoExpandProperties(n);if(a1.length>0){this._oParent.bindElement({path:"",parameters:{expand:a1,select:a1}});}}}}}else{this._oMetaData.modelObject=i.modelObject;this._oMetaData.property=i.property;this._oMetaData.property.valueListAnnotation=null;this._oMetaData.property.valueListKeyProperty=null;this._oMetaData.property.valueListEntitySet=null;this._oMetaData.property.valueListEntityType=null;this._oMetaData.annotations.text=i.annotations.text;this._oMetaData.annotations.uom=i.annotations.uom;if(this._oMetaData.annotations.uom&&!this._oMetaData.annotations.uom.annotations){this._oMetaData.annotations.uom.annotations={};}this._oMetaData.annotations.valuelist=i.annotations.valuelist;this._oMetaData.annotations.valuelistType=i.annotations.valuelistType;this._oMetaData.annotations.lineitem=i.annotations.lineitem;this._oMetaData.annotations.semantic=i.annotations.semantic;this._oMetaData.annotations.valuelistuom=i.annotations.valuelistuom;}};Y.prototype._initValueList=function(i){var n=this._oMetaData.property,Z=i.primaryValueListAnnotation;this._oMetaData.annotations.valueListData=Z;n.valueListAnnotation=Z;n.valueListKeyProperty=this._oHelper.getODataValueListKeyProperty(Z);n.valueListEntitySet=this._oHelper.oMeta.getODataEntitySet(Z.valueListEntitySetName);n.valueListEntityType=this._oHelper.oMeta.getODataEntityType(this._oHelper.oMeta.getODataEntitySet(Z.valueListEntitySetName).entityType);};Y.prototype._getTextArrangementType=function(){var i=k.getPaths("ValueList",this._oMetaData);if(i.keyField&&i.descriptionField){return this._oTypes.getType(this._oMetaData.property,null,null,{composite:true,keyField:i.keyField,descriptionField:i.descriptionField});}return null;};Y.prototype._createEdmDisplay=function(){var i,n,Z,$,_=this,a1={width:true,textAlign:true},b1=this.getEdmProperty();if(b1){$=this._oHelper.oAnnotation.getText(b1);}var c1=this._oParent.data("configdata");var d1=((c1&&(c1.isInnerControl!==true))||this._oParent.isContextTable());var e1=this._oSelector.checkComboBox(d1);if(e1.combobox&&(this._oParent.getFetchValueListReadOnly()||($===undefined))){return this._createComboBox({valueHelp:{annotation:e1.annotation,noDialog:true,noTypeAhead:true},edit:false});}if(this._checkLink()&&!this._oSelector.useObjectIdentifier()){return this._createLink();}var f1=this.createAttributes(null,this._oMetaData.property,a1),g1=this._oSelector.checkDatePicker()||(b1?b1.type.startsWith("Edm.Date"):false);this.oType=null;if(g1){var h1=this.getFormatSettings("dateFormatSettings");if(h1&&b1&&b1.type==="Edm.DateTimeOffset"){h1.UTC=false;}this.oType=this._oTypes.getType(this._oMetaData.property,h1);f1.text={model:this._oMetaData.model,path:this._oMetaData.path,type:this.oType};}else{if(this._bTextInDisplayModeValueList&&this._oMetaData.property&&this._oMetaData.property.valueListAnnotation){this.oType=this._getTextArrangementType();}if(!this.oType){this.oType=this._oTypes.getType(this._oMetaData.property);}f1.text={model:this._oMetaData.model,path:this._oHelper.getEdmDisplayPath(this._oMetaData),type:this.oType};}if(b1){n=this._oHelper.oAnnotation.isMasked(b1);if(n){f1.text.formatter=j.maskValue;}if($){Z=this._oSelector.useObjectIdentifier(g1,n);if(Z){delete f1.width;delete f1.textAlign;f1.text={path:this._oMetaData.path};f1.title={path:this._oHelper.getEdmDisplayPath(this._oMetaData)};if(this._oParent.hasListeners("press")){f1.titleActive=true;f1.titlePress=function(m1){_._oParent.firePress(m1);};}else if(this._oMetaData.annotations.semantic&&this._oMetaData.annotations.semantic.defaultSemanticObject){var i1;var j1;var k1=this._oMetaData.annotations.semantic.additionalSemanticObjects.concat(this._oMetaData.annotations.semantic.defaultSemanticObject);s.getDistinctSemanticObjects().then(function(m1){i1=s.hasDistinctSemanticObject(k1,m1);if(i1){var n1=_._oParent.getBindingInfo("value");var o1=n1.parts[0].path;var p1=_._oHelper.oAnnotation.getLabel(_._oMetaData.property.property);if(_._oMetaData.annotations.lineitem&&_._oMetaData.annotations.lineitem.labels&&_._oMetaData.annotations.lineitem.labels[o1]){p1=_._oMetaData.annotations.lineitem.labels[o1];}j1=new N({semanticObject:_._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:_._oMetaData.annotations.semantic.additionalSemanticObjects,semanticObjectLabel:p1,fieldName:o1,navigationTargetsObtained:function(q1){var r1=sap.ui.getCore().byId(q1.getSource().getControl());var s1=q1.getParameters().mainNavigation;if(s1){s1.setDescription(r1.getText());}q1.getParameters().show(r1.getTitle(),s1,undefined,undefined);}});}});f1.titleActive={path:"$sapuicompsmartfield_distinctSO>/distinctSemanticObjects",formatter:function(m1){return s.hasDistinctSemanticObject(k1,m1);}};f1.titlePress=function(m1){if(i1&&j1){j1.setControl(m1.getSource(m1.getParameter("domRef")));j1.openPopover();}};}}else if(!(c1&&(c1.isInnerControl===true))){f1.text={};f1.text.parts=[];f1.text.parts.push(this._oMetaData.path);f1.text.parts.push(this._oHelper.getEdmDisplayPath(this._oMetaData));f1.text.formatter=function(m1,n1){if(e1.combobox){return _._formatDisplayBehaviour("defaultComboBoxReadOnlyDisplayBehaviour",m1,n1);}if(_.oType&&!_._bTextInDisplayModeValueList){m1=_.oType.formatValue(m1,"string");}return _._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",m1,n1);};}}else if(this._oSelector.checkCheckBox()){f1.text.formatter=function(m1){return _._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",m1);};}}if(Z){i=new p(this._oParent.getId()+"-objIdentifier",f1);if(this._oMetaData.annotations.semantic){i.setModel(s.getJSONModel(),"$sapuicompsmartfield_distinctSO");}}else{if(f1.text.type&&f1.text.type.isA("sap.ui.comp.smartfield.type.DateTime")&&f1.text.type.oConstraints&&f1.text.type.oConstraints.isDateOnly){f1.wrapping=false;}if(this._oParent.isContextTable()&&sap.ui.getCore().getConfiguration().getRTL()){f1.textDirection="LTR";}i=new d(this._oParent.getId()+"-text",f1);}if(Z&&c1&&c1.configdata&&c1.configdata.onText){delete c1.configdata.onText;}var l1={control:i,onCreate:"_onCreate",params:{getValue:"getText",noValidations:true,type:null}};if(this.oType){l1.type={type:this.oType,property:this._oMetaData.property};}return l1;};Y.prototype._createEdmTime=function(){var i=this.getFormatSettings("dateFormatSettings"),n={width:true,placeholder:true,valueState:true,valueStateText:true};var Z=Y.getBoundPropertiesMapInfoForControl(r.getMetadata().getName(),{propertyName:"value"})[0];var $={valueFormat:"HH:mm:ss"};$=Object.assign($,this.createAttributes(Z,this._oMetaData.property,n,{event:"change"}));if($.width===""){$.width="100%";}if(i){$[Z].type=this._oTypes.getType(this._oMetaData.property,i);}var _=new r(this._oParent.getId()+"-timePicker",$);return{control:_,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:$.value.type,property:this._oMetaData.property}}};};Y.prototype._createObjectStatus=function(){var i=this.createAttributes(null,this._oMetaData.property,null),n=this._oHelper.oAnnotation.getText(this.getEdmProperty());var Z=Y.getBoundPropertiesMapInfoForControl(q.getMetadata().getName(),{propertyName:"value"})[0];if(n){i[Z]={parts:[this._oHelper.getEdmDisplayPath(this._oMetaData)]};}else{i[Z]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};}this._addObjectStatusAttributes(i);var $=new q(this._oParent.getId()+"-objStatus",i);return{control:$,onCreate:"_onCreate",params:{getValue:"getText",noValidation:true}};};Y.prototype._addObjectStatusAttributes=function(i){var n,Z=this._oParent.getControlProposal(),$=Z.getObjectStatus();if($){n=$.getBindingInfo("criticality");}var _=function(b1){var c1={0:V.None,1:V.Error,2:V.Warning,3:V.Success};var d1={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":V.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":V.Warning,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":V.Error,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":V.Success};return d1[b1]||c1[b1]||V.None;};var a1=function(){var b1,c1={"Error":"sap-icon://status-negative","Warning":"sap-icon://status-critical","Success":"sap-icon://status-positive","None":"sap-icon://status-inactive"};if(n){if(n.formatter){b1=n.formatter.apply(null,arguments);}else{b1=arguments[0];}}else{b1=$.getCriticality();}if((b1===undefined)||(b1===null)){return null;}return c1[_(b1)];};if(n){i.state={formatter:function(){var b1;if(n.formatter){b1=n.formatter.apply(null,arguments);}else{b1=arguments[0];}return _(b1);},parts:n.parts};if($.getCriticalityRepresentationType()!==K.WithoutIcon){i.icon={formatter:a1,parts:n.parts};}}else{if($){i.state=_($.getCriticality());if($.getCriticalityRepresentationType()!==K.WithoutIcon){i.icon=a1();}}else{i.icon=a1();}}};Y.prototype._createEdmString=function(){var i={};if(this._oSelector.checkCheckBox()){return this._createCheckBox();}var n=this._oSelector.checkSelection();if(n.selection){return this._createSelect({valueHelp:Y.getValueHelpDropdownSettings(n)});}n=this._oSelector.checkComboBox();if(n.combobox){return this._createComboBox({valueHelp:Y.getValueHelpDropdownSettings(n),edit:true});}var Z={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true,valueStateText:true};var $=this.getEdmProperty();if(this._oHelper.oAnnotation.isMultiLineText($)){delete Z["width"];return this._createMultiLineText({attributesNamesMap:Z});}var _=this._oParent.isTextInEditModeSourceNotNone(),a1=/Edm.String|Edm.Guid/.test($.type);if(_||this._bTextInDisplayModeValueList){y(a1,"The ValueList and NavigationProperty"+"members of the sap.ui.comp.smartfield.TextInEditModeSource enumeration are only supported for OData "+"EDM Properties typed as Edm.String or Edm.Guid. - "+this.getMetadata().getName());}var b1=Y.getBoundPropertiesMapInfoForControl(I.getMetadata().getName(),{propertyName:"value"})[0];var c1=this._oParent._getComputedTextInEditModeSource(),d1,e1;if(this._oParent.data("defaultTextInEditModeSource")&&this._oParent.isPropertyInitial("textInEditModeSource")&&this._oParent.getMode()==="edit"){d1=true;}this.oTextArrangementDelegate.bValidMetadata=a1&&this.oTextArrangementDelegate.checkRequiredMetadata(c1,d1);if(this.oTextArrangementDelegate.bValidMetadata){e1=this.createAttributes("",this._oMetaData.property,Z);if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){i.sDisplayFormat="UpperCase";}e1[b1]=this.oTextArrangementDelegate.getBindingInfo(i);}else{e1=this.createAttributes(b1,this._oMetaData.property,Z);}if(v.isFiscalValue($)){e1.placeholder=e1.value.type.formatter.getPattern();return{control:new I(this._oParent.getId()+"-input",e1),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:e1.value.type,property:this._oMetaData.property}}};}var f1=new I(this._oParent.getId()+"-input",e1);if(this._oHelper.oAnnotation.isMasked($)){f1.setType(G.Password);}var g1=this.getCustomDataConfiguration();if(this.oTextArrangementDelegate.bValidMetadata){this._handleEventingForTextArrangement({control:f1});}else{this._handleEventingForEdmString({control:f1,edmProperty:this._oMetaData.property.property,currency:g1&&g1.currency});}return{control:f1,onCreate:"_onCreate",params:{valuehelp:{annotation:n.annotation,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"},getValue:"getValue",type:{type:e1.value.type,property:this._oMetaData.property}}};};Y.getValueHelpDropdownSettings=function(i){return{annotation:i.annotation,noDialog:true,noTypeAhead:true};};Y.prototype._getMaxLength=function(){return this._oTypes.getMaxLength(this._oMetaData.property,this._oParent.getBindingInfo("value"));};Y.prototype._addAriaLabelledBy=function(i){var n,Z,$;if((this._oParent.getControlContext()===P.None)||(this._oParent.getControlContext()===P.Form)||(this._oParent.getControlContext()===P.SmartFormGrid)){f.prototype._addAriaLabelledBy.apply(this,arguments);$=this._oParent.data("configdata");if($&&$.configdata.isInnerControl&&$.configdata.isUOM){if(i){Z=i.control;if(Z instanceof H){if(Z.getItems().length>0){Z=Z.getItems()[0];}}}if(Z&&Z.getAriaLabelledBy&&Z.getAriaLabelledBy().length===0){var _=this.getEdmProperty();if(this._oHelper.oAnnotation.getLabel(_)){n=new w({text:this._oHelper.oAnnotation.getLabel(_)});Z.addAriaLabelledBy(n);this._oParent.addAggregation("_ariaLabelInvisibleText",n);}}}}};Y.prototype._handleEventingForEdmString=function(i){var n=i.control;if(!n){return;}var Z=this._oHelper.oAnnotation.isUpperCase(i.edmProperty);n.attachChange(function onCurrencyInputFieldChange($){var _={},a1=$&&$.getParameters(),b1=$&&$.getSource();if(a1){var c1=a1.value;if(Z&&c1){c1=c1.toUpperCase();n.setValue(c1);}_.value=c1;_.newValue=c1;if(a1.validated){_.validated=a1.validated;}if(n._oSuggestionPopup&&n._oSuggestionPopup.isOpen()){if(!a1.validated){if(n._iPopupListSelectedIndex>=0){return;}}}if(i.currency){var d1=this.getCurrencyValidationSettings();d1.oSource=b1;this.updateModelPropertiesForCurrency("value",d1);}try{this._oParent.fireChange(_);}catch(e1){x.error(e1);}}}.bind(this));};Y.prototype._handleEventingForTextArrangement=function(i){var n=i.control;if(!n){return;}n.attachChange(function(Z){try{this._oParent.fireChange(arguments);}catch($){x.error($);}}.bind(this));};Y.prototype.getUOMChangeHandler=function(i){return function(n){try{var Z=i.smartFieldRootControl,$=n.getParameters(),_=$.value,a1=n.getSource();if(i.currency){var b1=this.getCurrencyValidationSettings(i);b1.oSource=a1;this.updateModelPropertiesForCurrency("value",b1);}Z.fireChange({value:_,newValue:_,unitChanged:!!i.unit,validated:!!$.validated});}catch(c1){x.error(c1);}}.bind(this);};Y.prototype.getCurrencyValidationSettings=function(i){var n;if(i){n=i.smartFieldRootControl;}else{var Z=this.getCustomDataConfiguration();n=Z&&Z.smartFieldRootControl;}var $=n.getInnerControls();return{amountField:$[0],currencyField:$[1],errorState:n._oError,checkValidity:n.checkValuesValidity.bind(n),rootControl:n};};Y.prototype.updateModelPropertiesForCurrency=function(i,n){var Z=n.amountField,$=n.currencyField,_=n.oSource,a1=Z.getValue(),b1,c1="";if($){var d1=$.getMetadata().getName();b1=Y.getBoundPropertiesMapInfoForControl(d1,{propertyName:i})[0];var e1="get"+A(b1);c1=$[e1]();}var f1=[a1,c1];var g1={rawValues:f1,handleSuccess:false};var h1=n.checkValidity(g1);function i1(l1){var m1=Z.getModel(),n1=Z.getBinding(i),o1,p1;if($){o1=$.getBinding(b1);p1=o1.getType();}var q1=n1.getType(),r1=n1.getExternalValue(),s1=o1&&o1.getExternalValue(),t1=q1.parseValue(a1,"string",f1),u1=t1[1],v1=q1.formatValue(t1,"string"),w1=p1&&p1.formatValue(u1,"string");if(m1.getDefaultBindingMode()===B.TwoWay){if(!l1){n1.setValue(t1);}}if(!l1){Z.setValue(v1);}var x1=false,y1=true;if(n1.hasValidation()&&!l1){var z1={element:Z,property:i,type:q1,newValue:v1,oldValue:r1,mParameters:{originSource:_}};Z.fireValidationSuccess(z1,x1,y1);}if(o1&&o1.hasValidation()){var A1={element:$,property:b1,type:p1,newValue:w1,oldValue:s1,mParameters:{originSource:_}};$.fireValidationSuccess(A1,x1,y1);}}function j1(l1){}function k1(){var l1=n.errorState;if(l1.bComplex&&l1.bFirst&&l1.bSecond){var m1=Z.getBinding(i).getExternalValue();f1=[m1,c1];var g1={rawValues:f1,innerControls:[$],handleSuccess:false};var h1=n.checkValidity(g1);h1.then(i1.bind(this,true)).catch(j1);}}h1.then(i1).catch(j1).finally(k1);};Y.prototype._createComboBox=function(i){var n=null,Z={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true};var $=Y.getBoundPropertiesMapInfoForControl(a.getMetadata().getName(),{propertyName:"value"})[0];var _={change:function(a1){if(a1.getParameter("itemPressed")){return;}var b1=a1.getSource().getSelectedKey();this._oParent.fireChange({value:b1,newValue:b1});}.bind(this),selectionChange:this._oHelper.getSelectionChangeHandler(this._oParent)};_=Object.assign(_,this.createAttributes($,this._oMetaData.property,Z));if(_.width===""){_.width="100%";}if(i.edit){n=new a(this._oParent.getId()+"-comboBoxEdit",_);}else{n=this._createDisplayedComboBox(_);}return{control:n,onCreate:"_onCreate",params:{valuehelp:{annotation:i.valueHelp.annotation,aggregation:"items",noDialog:i.valueHelp.noDialog,noTypeAhead:i.valueHelp.noTypeAhead},getValue:"getSelectedKey",type:{type:_.selectedKey.type,property:this._oMetaData.property}}};};Y.prototype._createDisplayedComboBox=function(i){var n=a.extend("sap.ui.comp.smartfield.DisplayComboBox",{metadata:{library:"sap.ui.comp",properties:{wrapping:{type:"boolean",group:"Appearance",defaultValue:true}}},renderer:function(Z,$){var _=$.getWidth(),a1=$.getValue(),b1=$.getTextDirection(),c1=$.getTextAlign(),d1=$.getTooltip_AsString(),e1=$.getWrapping();Z.write("<span");Z.writeControlData($);Z.addClass("sapMText");Z.addClass("sapUiSelectable");if(e1){if(a1&&(a1.length>0)&&!/\s/.test(a1)){Z.addClass("sapMTextBreakWord");}}else{Z.addClass("sapMTextNoWrap");}if(_){Z.addStyle("width",_);}else{Z.addClass("sapMTextMaxWidth");}if(b1!==Q.Inherit){Z.writeAttribute("dir",b1.toLowerCase());}if(d1){Z.writeAttributeEscaped("title",d1);}if(c1){c1=R.getTextAlign(c1,b1);if(c1){Z.addStyle("text-align",c1);}}var f1=e1?"sapMTextRenderWhitespaceWrap":"sapMTextRenderWhitespace";Z.addClass(f1);Z.writeClasses();Z.writeStyles();Z.write(">");a1.replace(/\r\n|\n\r|\r/g,"\n");Z.writeEscaped(a1);Z.write("</span>");},updateDomValue:function(Z){if(!this.isActive()){return this;}Z=this._getInputValue(Z);if(this.$().text()!==Z){this.$().text(Z);this._bCheckDomValue=true;}return this;},getValue:function(){return this.getProperty("value");},getFocusDomRef:function(){return this.getDomRef();},getEditable:function(){return false;}});return new n(this._oParent.getId()+"-comboBoxDisp",i);};Y.prototype._createSelect=function(i){var n={width:true,name:true,valueState:true};var Z=Y.getBoundPropertiesMapInfoForControl(S.getMetadata().getName(),{propertyName:"value"})[0];var $={change:this._oHelper.getSelectionChangeHandler(this._oParent),forceSelection:false};$=Object.assign($,this.createAttributes(Z,this._oMetaData.property,n));if($.width===""){$.width="100%";}return{control:new S(this._oParent.getId()+"-select",$),onCreate:"_onCreate",params:{valuehelp:{annotation:i.valueHelp.annotation,aggregation:"items",noDialog:i.valueHelp.noDialog,noTypeAhead:i.valueHelp.noTypeAhead},getValue:"getSelectedKey",type:{type:$.selectedKey.type,property:this._oMetaData.property}}};};Y.prototype._createCheckBox=function(){var i=Y.getBoundPropertiesMapInfoForControl(C.getMetadata().getName(),{propertyName:"value"})[0];var n=this.createAttributes(i,null,{},{event:"select",parameter:"selected"});n.editable=(this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable());n.selected.type=this._oTypes.getAbapBoolean();return{control:new C(this._oParent.getId()+"-cBox",n),onCreate:"_onCreate",params:{getValue:"getSelected"}};};Y.prototype._createEdmDateTime=function(){var i=this.getFormatSettings("dateFormatSettings"),n;var Z={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var $=this.createAttributes(null,this._oMetaData.property,Z,{event:"change",parameter:"value"});if(this._oSelector.checkDatePicker()){n=Y.getBoundPropertiesMapInfoForControl(D.getMetadata().getName(),{propertyName:"value"})[0];$[n]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,i,{displayFormat:"Date"}),model:this._oMetaData.model,mode:this._oParent.getBindingMode("value")};if(i&&i.style){$.displayFormat=i.style;}return{control:new D(this._oParent.getId()+"-datePicker",$),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:$.value.type,property:this._oMetaData.property}}};}n=Y.getBoundPropertiesMapInfoForControl(b.getMetadata().getName(),{propertyName:"value"})[0];$[n]={path:this._oMetaData.path,model:this._oMetaData.model,type:this._oTypes.getType(this._oMetaData.property,i),mode:this._oParent.getBindingMode("value")};return{control:new b(this._oParent.getId()+"-input",$),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:$.value.type,property:this._oMetaData.property}}};};Y.prototype._createEdmDateTimeOffset=function(){var i=this.getFormatSettings("dateFormatSettings");if(i){i.UTC=false;}var n=Y.getBoundPropertiesMapInfoForControl(b.getMetadata().getName(),{propertyName:"value"})[0];var Z={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var $=this.createAttributes(null,this._oMetaData.property,Z,{event:"change",parameter:"value"});$[n]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,i),mode:this._oParent.getBindingMode("value")};return{control:new b(this._oParent.getId()+"-input",$),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:$.value.type,property:this._oMetaData.property}}};};Y.prototype._createEdmNumeric=function(){var i=this._oSelector.checkComboBox();if(i.combobox){return this._createComboBox({valueHelp:{annotation:i.annotation,noDialog:true,noTypeAhead:true},edit:true});}var n={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var Z=Y.getBoundPropertiesMapInfoForControl(I.getMetadata().getName(),{propertyName:"value"})[0];var $=this.createAttributes(Z,this._oMetaData.property,n,{event:"change",parameter:"value"});if(this._oParent.isContextTable()&&sap.ui.getCore().getConfiguration().getRTL()){$.textDirection="LTR";}return{control:new I(this._oParent.getId()+"-input",$),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:$.value.type,property:this._oMetaData.property}}};};Y.prototype._createEdmUOM=function(){var i=this.getEdmProperty(),n=this._oMetaData.annotations.uom.property.property,Z=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(i,n);var $={currency:Z,edmProperty:n};var _=this._createEdmUOMAttributes($),a1=sap.ui.getCore().getConfiguration().getRTL(),b1=a1&&this._oParent.isContextTable(),c1=this._oParent.getId(),d1;if(b1){_.textDirection="LTR";}var e1=new I(c1+"-input",_);this.oMeasureField=e1;if(this._oParent.data("suppressUnit")==="true"){var f1={getValue:"getValue"};if(!Z){f1.type={type:_.value.type,property:this._oMetaData.property};}return{control:e1,onCreate:"_onCreate",params:f1};}if(!Z){d1={type:_.value.type,property:this._oMetaData.property};}var g1={change:this.getUOMChangeHandler({smartFieldRootControl:this._oParent,unit:true}),textAlign:this._getEdmUOMTextAlignment()};var h1=Y.getBoundPropertiesMapInfoForControl(X.getMetadata().getName(),{propertyName:"value"})[0];var i1=this._oHelper.getUOMPath(this._oMetaData);g1[h1]={model:this._oMetaData.model,path:i1};this.mapBindings(g1,Y._getEmbeddedSmartFieldMapSettings());if(this._oParent.getConfiguration()){g1.configuration=new u({preventInitialDataFetchInValueHelpDialog:this._getPreventInitialDataFetchInVHDialog()});}var j1=new X(c1+"-sfEdit",g1),k1=this;j1.data("configdata",{"configdata":{currency:Z,smartFieldRootControl:this._oParent,measureField:this.oMeasureField,isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:i1,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,valuelistType:this._oMetaData.annotations.uom.annotations.valuelistType,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(m1){e1.setLayoutData(new F({growFactor:1}));j1.setLayoutData(k1._getStaticUOMTextFlexItemData({shrinkFactor:0,styleClass:"sapUiCompSmartFieldFlexItemUnitDisplay"}));j1.addStyleClass("sapUiCompSmartFieldUOMDisplayText");if(m1){if(b1&&(typeof m1.setTextDirection==="function")){m1.setTextDirection("LTR");}m1.addStyleClass("sapUiCompSmartFieldUnit");}},onInput:function(m1){e1.setLayoutData(k1._getDynamicAmountInputFlexItemData({control:j1}));j1.setLayoutData(k1._getStaticUOMInputFlexItemData({growFactor:0,styleClass:"sapUiCompSmartFieldFlexItemUnitEdit",minWidth:""}));if(m1){if(b1&&(typeof m1.setTextDirection==="function")){m1.setTextDirection("LTR");}m1.addStyleClass("sapUiCompSmartFieldUnit");}}}});j1.data("errorCheck","setComplexClientErrorSecondOperandNested");e1.addAriaLabelledBy(j1.getId()+"-text");if(j1.getVisible()){e1.addStyleClass("smartFieldPaddingRight");}e1.addStyleClass("sapUiCompSmartFieldValue");var l1=new H({justifyContent:J.End,items:[e1,j1],fitContainer:true,width:this._oParent.getWidth()});l1.addStyleClass("sapUiCompUOM");l1.enhanceAccessibilityState=function(m1,n1){this._oParent.enhanceAccessibilityState(m1,n1);}.bind(this);if(this._oParent.isContextTable()){if(b1){l1.addStyleClass("sapUiCompDirectionLTR");}l1.addStyleClass("sapUiCompUOMInTable");if(this._oParent.getMode()!=="edit"){l1.addStyleClass("sapUiCompUOMInTableDisplay");}}return{control:l1,onCreate:"_onCreateUOM",params:{getValue:true,valuehelp:true,type:d1}};};Y.prototype._createEdmUOMAttributes=function(i){i=i||{};var n=this.createUOMDefaultAttributes(i);var Z=Y.getBoundPropertiesMapInfoForControl(I.getMetadata().getName(),{propertyName:"value"})[0];var $=i.currency||(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property));if($){n[Z]={parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)}],model:this._oMetaData.model,mode:B.OneWay,type:this._oTypes.getCurrencyType(this._oMetaData.property)};}else{n[Z]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};}return n;};Y.prototype.createUOMDefaultAttributes=function(i){return{textAlign:this._getEdmUOMTextAlignment(),placeholder:this.getAttribute("placeholder"),name:this.getAttribute("name"),change:this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:i.currency}),valueState:this.getValueStateBindingInfoForRecommendationStateAnnotation()};};Y.prototype._getEdmUOMTextAlignment=function(){var i=this.getAttribute("textAlign");if(!i){i=E.Initial;}if(i===E.Initial){if(this._oParent.isContextTable()){return E.End;}return E.Begin;}return i;};Y.prototype._createEdmUOMDisplay=function(){var i=this,n=this._oHelper.getUOMPath(this._oMetaData),Z=this._getEdmUOMTextAlignment(),$=null,_=this.getEdmProperty(),a1=sap.ui.getCore().getConfiguration().getRTL(),b1=a1&&this._oParent.isContextTable();var c1=Y.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];var d1={textAlign:Z};d1[c1]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:n}],model:this._oMetaData.model,formatter:this._oTypes.getDisplayFormatter(_,{currency:this._oHelper.oAnnotation.isCurrency(_),mask:this._oHelper.oAnnotation.isMasked(_),type:this._oTypes.getType(this._oMetaData.property)}),useRawValues:true};if(b1){d1.textDirection="LTR";}var e1=new d(this._oParent.getId()+"-text",d1);n=this._oHelper.getUOMPath(this._oMetaData);d1={change:this.getUOMChangeHandler({smartFieldRootControl:this._oParent,unit:true}),textAlign:this._getEdmUOMTextAlignment()};c1=Y.getBoundPropertiesMapInfoForControl(X.getMetadata().getName(),{propertyName:"value"})[0];d1[c1]={model:this._oMetaData.model,path:n};this.mapBindings(d1,Y._getEmbeddedSmartFieldMapSettings());e1.addStyleClass("smartFieldPaddingRight");e1.addStyleClass("sapUiCompSmartFieldValue");if(this._checkSuppressUnit()){return{control:e1};}$=new X(this._oParent.getId()+"-sfDisp",d1);$.data("configdata",{"configdata":{isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:n,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(g1){if(g1){if(g1.setWrapping){g1.setWrapping(false);}if(b1&&(typeof g1.setTextDirection==="function")){g1.setTextDirection("LTR");}g1.addStyleClass("sapUiCompSmartFieldUnit");}},onInput:function(g1){e1.setLayoutData(new F({growFactor:0}));$.setLayoutData(new F({growFactor:0}));if(g1){if(b1&&(typeof g1.setTextDirection==="function")){g1.setTextDirection("LTR");}g1.addStyleClass("sapUiCompSmartFieldUnit");}},getContextEditable:function(){return i._oParent.getContextEditable();}}});$.data("errorCheck","setComplexClientErrorSecondOperandNested");var f1=new H({alignItems:W.Center,items:[e1,$],fitContainer:true,width:this._oParent.getWidth()});f1.enhanceAccessibilityState=function(g1,h1){this._oParent.enhanceAccessibilityState(g1,h1);}.bind(this);if(this._oParent.isContextTable()){f1.setJustifyContent("End");this._oParent.addStyleClass("sapUiCompUOMInTable");if(b1){f1.addStyleClass("sapUiCompDirectionLTR");}f1.addStyleClass("sapUiCompUOMInTable");}return{control:f1};};Y.prototype._createEdmUOMObjectStatus=function(){var i,n=this.getEdmProperty(),Z=this._oTypes.getDisplayFormatter(n,{currency:this._oHelper.oAnnotation.isCurrency(n)}),$=this._oHelper.getUOMPath(this._oMetaData),_={};var a1=Y.getBoundPropertiesMapInfoForControl(q.getMetadata().getName(),{propertyName:"value"})[0];_[a1]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:$}],formatter:function(){var b1=Z.apply(this,arguments);return b1+arguments[1];},useRawValues:true};this._addObjectStatusAttributes(_);i=new q(this._oParent.getId()+"-objStatus",_);i.addStyleClass("sapUiCompUOM");return{control:i};};Y.prototype._createEdmUOMObjectNumber=function(){var i,n,Z=this._getEdmUOMTextAlignment();var $=Y.getBoundPropertiesMapInfoForControl(o.getMetadata().getName(),{propertyName:"value"});if(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property)){i={model:this._oMetaData.model,textAlign:Z};i[$[0]]={parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)}],type:this._oTypes.getCurrencyType(this._oMetaData.property)};i[$[1]]={path:this._oHelper.getUOMPath(this._oMetaData)};}else{i={model:this._oMetaData.model,textAlign:Z};i[$[0]]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};i[$[1]]={path:this._oHelper.getUOMPath(this._oMetaData)};}n=new o(this._oParent.getId()+"-objNumber",i);n.addStyleClass("sapUiCompUOM");return{control:n};};Y.prototype._createEdmSemantic=function(){var i=this,n=this._oParent.getBindingPath("value"),Z=this.getEdmProperty(),$=this._oHelper.oAnnotation.getLabel(Z);if(this._oMetaData.annotations.lineitem&&this._oMetaData.annotations.lineitem.labels&&this._oMetaData.annotations.lineitem.labels[n]){$=this._oMetaData.annotations.lineitem.labels[n];}var _={semanticObject:this._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:this._oMetaData.annotations.semantic.additionalSemanticObjects,semanticObjectLabel:$,fieldName:n,width:this.getAttribute("width"),createControlCallback:function(){var c1=this.createControl(true);if(c1){return c1.control;}return null;}.bind(this)};var a1=this._oHelper.oAnnotation.getText(Z);this.oType=this._oTypes.getType(this._oMetaData.property);if(a1){_.text={parts:[this._oMetaData.path,this._oHelper.getEdmDisplayPath(this._oMetaData)],model:this._oMetaData.model,formatter:function(c1,d1){if(i.oType){c1=i.oType.formatValue(c1,"string");}if(c1&&d1){return i._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",c1,d1);}return c1?c1:"";}};_.navigationTargetsObtained=function(c1){var d1=this.getBinding("text");if(!Array.isArray(d1.getValue())){c1.getParameters().show();return;}var e1=d1.getValue();var f1=i._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour")||"idOnly";var g1=t.getTextsFromDisplayBehaviour(f1,e1[0],e1[1]);var h1=c1.getParameters().mainNavigation;if(h1){h1.setDescription(g1.secondText);}c1.getParameters().show(g1.firstText,h1,undefined,undefined);};}else{var b1=this._oHelper.getUOMPath(this._oMetaData);if(b1){_.text={parts:[{path:n},{path:b1}],model:this._oMetaData.model,formatter:this._oHelper.oAnnotation.isCurrency(Z,this._oMetaData.annotations.uom.property.property)?t.getAmountCurrencyFormatter():t.getMeasureUnitFormatter(),useRawValues:true};_.uom={path:b1};}else{_.text={path:n,model:this._oMetaData.model,type:this.oType};}}return{control:new e(this._oParent.getId()+"-sl",_),onCreate:"_onCreate",params:{getValue:"getInnerControlValue"}};};Y.prototype._createMultiLineText=function(i){var n=Y.getBoundPropertiesMapInfoForControl(T.getMetadata().getName(),{propertyName:"value"})[0];var Z=this.createAttributes(n,this._oMetaData.property,i.attributesNamesMap);var $=this.getFormatSettings("multiLineSettings");Z=z(Z,$);if(this._oParent.isContextTable()){Z.width="100%";}var _=new T(this._oParent.getId()+"-textArea",Z);this._handleEventingForEdmString({control:_,edmProperty:this._oMetaData.property.property});return{control:_,onCreate:"_onCreate",params:{type:{type:Z.value.type,property:this._oMetaData.property},getValue:"getValue"}};};Y.prototype._createLink=function(){var i=this,n=this._oParent,Z=n.getBindingInfo("url");var $={text:"",href:""};var _=Y.getBoundPropertiesMapInfoForControl(L.getMetadata().getName(),{propertyName:"url"})[0];if(Z){$[_]=this._oBinding.toBinding(Z);}else{$[_]=n.getUrl();}if(n.hasListeners("press")){$.press=function(g1){g1.preventDefault();n.firePress(g1);};}var a1=n.getBindingInfo("value");var b1=Y.getBoundPropertiesMapInfoForControl(L.getMetadata().getName(),{propertyName:"value"});if(a1){var c1=this._oMetaData,d1=c1.path,e1=c1.property.property;if(c1.annotations.text&&(e1.type==="Edm.String")){$[b1[0]]={parts:[c1.path,this._oHelper.getEdmDisplayPath(c1)],formatter:this._formatText.bind(i)};}else if(Y.isSpecialLink(e1)){var f1=Y[Y._getLinkFormatterFunctionName(e1)];$[b1[0]]={path:d1};$[b1[1]]={path:d1,formatter:null};if(typeof f1==="function"){$[b1[1]].formatter=f1;}}else{$[b1[0]]=this._oBinding.toBinding(a1);}}else{$[b1[0]]=n.getValue();}return{control:new L(n.getId()+"-link",$),onCreate:"_onCreate",params:{noValidation:true}};};Y.prototype._createEdmBoolean=function(){var i=this._oSelector.checkComboBox(),n=this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable(),Z=this,$=null,_;if(i.combobox){if(n||this._oParent.getFetchValueListReadOnly()){return this._createComboBox({valueHelp:{annotation:i.annotation,noDialog:true,noTypeAhead:true},edit:n});}}var a1,b1;if(n){b1=Y.getBoundPropertiesMapInfoForControl(C.getMetadata().getName(),{propertyName:"value"})[0];a1=this.createAttributes(b1,this._oMetaData.property,{},{event:"select",parameter:"selected"});_=new C(this._oParent.getId()+"-cBoxBool",a1);$={getValue:"getSelected"};}else{b1=Y.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];a1=this.createAttributes(b1,this._oMetaData.property,{width:true,textAlign:true});a1[b1]={model:this._oMetaData.model,path:this._oMetaData.path,formatter:function(c1){return Z._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",c1);}};_=new d(this._oParent.getId()+"-text",a1);}return{control:_,onCreate:"_onCreate",params:$};};Y.prototype._createValueHelp=function(){var i=this._oParent.getContent();if(!i){return;}var n={annotation:this._oMetaData.annotations.valuelist,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"};this._getValueHelpDialogTitle(n);n.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:i,edmProperty:this.getEdmProperty(),valueHelp:n,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(Z){this._oParent.fireValueListChanged({changes:Z.mParameters.changes});}.bind(this)});};Y.prototype.getValueListProviderConfiguration=function(i){var n=f.prototype.getValueListProviderConfiguration.apply(this,arguments);if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){n.displayFormat="UpperCase";}return n;};Y.prototype._checkSuppressUnit=function(){if(this._oParent.data("suppressUnit")==="true"){return true;}var i=this._oParent.getBindingInfo("uomVisible");return(!i&&!this._oParent.getUomVisible());};Y.prototype.getEdmProperty=function(){var i=this._oHelper;if(i){return i.getEdmProperty(this._oMetaData);}return null;};Y.prototype.getEntityType=function(){if(this._oMetaData){return this._oMetaData.entityType;}return null;};Y.prototype._checkLink=function(){var i=this._oParent.getBindingInfo("url"),n=this.getEdmProperty();if(i||this._oParent.getUrl()||Y.isSpecialLink(n)){return true;}return this._oParent.hasListeners("press");};Y._getEmbeddedSmartFieldMapSettings=function(){return{"uomEditable":"editable","uomEnabled":"enabled","uomVisible":"visible","mandatory":"mandatory"};};Y.getBoundPropertiesMapInfoForControl=function(i,n){n=n||{};var Z=null;switch(i){case"sap.m.Input":case"sap.m.TimePicker":case"sap.m.DatePicker":case"sap.m.DateTimePicker":case"sap.m.TextArea":Z={value:["value"]};break;case"sap.m.Text":case"sap.m.ObjectIdentifier":case"sap.ui.comp.navpopover.SmartLink":Z={value:["text"]};break;case"sap.m.Link":Z={url:["href"],value:["text","href"]};break;case"sap.m.ObjectStatus":Z={value:["text","state","icon"]};break;case"sap.m.ObjectNumber":Z={value:["number","unit"]};break;case"sap.m.Select":case"sap.m.ComboBox":case"sap.ui.comp.smartfield.DisplayComboBox":Z={value:["selectedKey"]};break;case"sap.m.CheckBox":Z={value:["selected"]};break;case"sap.ui.comp.smartfield.SmartField":var $=Object.keys(X.getMetadata().getProperties());Z={};$.forEach(function(_,a1,b1){Z[_]=[b1[a1]];});break;}if(Z&&n.propertyName){return Z[n.propertyName]||null;}return Z;};Y.isSpecialLink=function(i){return M.isEmailAddress(i)||M.isPhoneNumber(i)||M.isURL(i);};Y._getLinkFormatterFunctionName=function(i){return"_format"+M.getLinkDisplayFormat(i);};Y._formatEmailAddress=function(i){return"mailto:"+i;};Y._formatPhoneNumber=function(i){return"tel:"+i;};Y._formatURL=function(i){return U.validate(i)?i:"";};Y.prototype._formatText=function(i,n){if(i&&n){return this._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",i,n);}return i||"";};Y.prototype._getCreator=function(i){return this._oSelector.getCreator(i);};Y.prototype._onCreate=function(i,n){var Z,$,_=true,a1=this;if(n){if(n.noValidation){_=false;}if(n.valuehelp&&this.shouldCreateValueHelpForControl(i)){this._getValueHelpDialogTitle(n.valuehelp);n.valuehelp.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:i,edmProperty:this.getEdmProperty(),valueHelp:n.valuehelp,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(b1){a1._oParent.fireValueListChanged({changes:b1.mParameters.changes});}});}if(n.getValue){Z=n.getValue;n.getValue=function(){return i[Z]();};}if(n.type){$=this._oFieldControl.getMandatoryCheck(n.type.property);if($){n.type.type.oFieldControl=$;}}}if(_){this.addValidations(i,this._oParent.data("errorCheck")||"setSimpleClientError");}if(!this._checkUOM()){i.addStyleClass("sapUiCompSmartFieldValue");}};Y.prototype._checkUOM=function(){var i=this._oParent.data("configdata");if(i&&i.configdata){if(i.configdata.onInput||i.configdata.onText){return true;}}return false;};Y.prototype.getValueStateBindingInfoForRecommendationStateAnnotation=function(i,n,Z){i=i||this.getEdmProperty();var $=i&&i["com.sap.vocabularies.UI.v1.RecommendationState"];if(!$){return null;}y(!($.Path===undefined),'Missing "Path" attribute of the "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+i.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());y(!($.Path===""),'Missing path name of "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+i.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());n=n||this._oHelper.findProperty(this._oMetaData.entityType.property,$.Path);y(!!n,'The EDM property was not found in the "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(n&&(n.type==="Edm.Byte")){return{model:Z||this._oMetaData.model,path:$.Path,formatter:Y.formatRecommendationState};}y(n&&(n.type==="Edm.Byte"),'The EDM property "'+n.name+'" of "'+this._oMetaData.entityType.name+'" entity type must be typed as Edm.Byte. - '+this.getMetadata().getName());return null;};Y.formatRecommendationState=function(i){i=String(i);switch(i){case"0":return V.None;case"1":return V.Information;case"2":return V.Warning;default:return V.None;}};Y.prototype._getDynamicAmountInputFlexItemData=function(i){var n="sapUiCompSmartFieldFlexItemAmountEdit",Z="",$=i.control;if($&&!$.getVisible()){n="sapUiCompSmartFieldFlexItemAmountNoUnitEdit";Z="100%";}var _=this._oAmountInputFlexItemData;if(_&&!_.bIsDestroyed){_.setMaxWidth(Z);_.setStyleClass(n);return _;}this._oAmountInputFlexItemData=new F({growFactor:1,maxWidth:Z,styleClass:n});return this._oAmountInputFlexItemData;};Y.prototype._getStaticUOMInputFlexItemData=function(i){var n=this._oUOMInputFlexItemData;if(n&&!n.bIsDestroyed){return n;}this._oUOMInputFlexItemData=new F(i);return this._oUOMInputFlexItemData;};Y.prototype._getStaticUOMTextFlexItemData=function(i){var n=this._oUOMTextFlexItemData;if(n&&!n.bIsDestroyed){return n;}this._oUOMTextFlexItemData=new F(i);return this._oUOMTextFlexItemData;};Y.prototype._getValueHelpDialogTitle=function(i){i.dialogtitle=this._oParent.getComputedTextLabel();if(!i.dialogtitle){var n=this.getEdmProperty();i.dialogtitle=this._oHelper.oAnnotation.getLabel(n)||n.name;}};Y.prototype._onCreateUOM=function(i,n){var Z=i.getItems(),$;this.addValidations(Z[0],"setComplexClientErrorFirstOperand");if(n&&n.getValue){n.getValue=function(){return Z[0].getValue();};}n.uom=function(){return Z[1].getValue();};n.uomset=function(_){Z[1].setValue(_);};if(n.type){$=this._oFieldControl.getMandatoryCheck(n.type.property);if($){n.type.type.oFieldControl=$;}}};Y.prototype.triggerCreationOfControls=function(i){try{if(i){this._init(i);}this._setUOMEditState();var n=this._hasBoundFieldControl();var Z=this._bReBindOnVL&&n;if(!Z){this._oFieldControl.bindProperties({metadata:this._oMetaData});}this._oParent._toggleInnerControlIfRequired();this._addLabelAndQuickInfo();if(!Z){this._oParent.fireInitialise();}}catch($){x.error($,null,this.getMetadata().getName());}};Y.prototype._checkTextInDisplayModeValueList=function(){return!!(!this._oSelector.checkComboBox().combobox&&this._oParent.getMode()==="display"&&this._oParent.getFetchValueListReadOnly()&&this._oHelper.getValueListAnnotationPath(this._oMetaData)&&!this._oHelper.oAnnotation.getText(this.getEdmProperty()));};Y.prototype.reBindIfNecessary=function(){if(this._bInitialized&&this.bPending===false&&this._checkTextInDisplayModeValueList()){if(!this._oModel){return;}this._oModel.getMetaModel().loaded().then(function(){var i;if(!this._oParent){return false;}this._init(this._oMeta);i=this._oMetaData.annotations.valuelist;if(typeof i==="string"){return this._oHelper.loadValueListAnnotation(i);}return false;}.bind(this)).then(function(i){if(i&&this._oParent&&this._oParent.getMode()==="display"){this.reBind();}}.bind(this)).catch(function(){});}};Y.prototype.reBind=function(){this._bReBindOnVL=true;this.bind().finally(function(){this._bReBindOnVL=false;}.bind(this));};Y.prototype._hasBoundFieldControl=function(){var n=this._oFieldControl.getPropertyNames();for(var i=0;i<n.length;i++){if(this._oParent.getBinding(n[i])){return true;}}return false;};Y.prototype.bind=function(){if(!(!this._bInitialized&&!this.bPending)&&!this._bReBindOnVL){return Promise.resolve();}this._bInitialized=true;var i=this._oParent.data("configdata");if(i&&i.configdata){this.triggerCreationOfControls(this._oMeta);return Promise.resolve();}if(!this._oModel){return Promise.resolve();}var n=!!(this._oParent&&this._oParent.isTextInEditModeSourceNotNone());if(!n&&this._oModel.bMetaModelLoaded&&(this._oParent.getMode()!=="display"||!this._oParent.getFetchValueListReadOnly())){this.triggerCreationOfControls(this._oMeta);return Promise.resolve();}this.bPending=true;var Z=this._oModel.getMetaModel().loaded().catch(function(_){x.error("The meta model could not be loaded.",_,this.getMetadata().getName());}.bind(this));var $=Z.then(function onMetaModelLoaded(){if(!this._oParent){this.bPending=false;return Promise.reject();}this._init(this._oMeta);this._bTextInDisplayModeValueList=this._checkTextInDisplayModeValueList();if((this._oParent.getMode()!=="display"&&n)||this._bTextInDisplayModeValueList){var _=this._oMetaData.annotations.valuelist;if(typeof _==="string"){return this._oHelper.loadValueListAnnotation(_);}else{this.bPending=false;this.triggerCreationOfControls();return Promise.reject();}}this.bPending=false;this.triggerCreationOfControls(this._oMeta);}.bind(this)).then(function onValueListAnnotationLoaded(_){if(!n&&!this._bTextInDisplayModeValueList){return;}if(!this._oParent){return;}this.bPending=false;if(_){this._initValueList(_);}this.triggerCreationOfControls();if(_&&this.oTextArrangementDelegate){this.oTextArrangementDelegate.fetchIDAndDescriptionCollectionIfRequired();this._handleModelContextChangeEvent=function(){if(this._oParent&&this._oParent.getBindingContext()){this.oTextArrangementDelegate.fetchIDAndDescriptionCollectionIfRequired();}}.bind(this);this._oParent.attachModelContextChange(this._handleModelContextChangeEvent);}}.bind(this)).catch(function(_){if(_){x.error(_,null,this.getMetadata().getName()+".onMetaModelLoaded");}}.bind(this));return $;};Y.prototype._handleModelContextChangeEvent=function(){};Y.prototype._addLabelAndQuickInfo=function(){var i=this.getDataProperty();i=i.property;var n=this._oHelper.oAnnotation.getLabel(i);var Z=this._oHelper.oAnnotation.getQuickInfo(i);if(n){this._oParent._sAnnotationLabel=n;}if(Z&&this._oParent.isPropertyInitial("tooltipLabel")){this._oParent.setTooltipLabel(Z);}};Y.prototype.rebindOnCreated=function(){var i,Z=this._oFieldControl.getControlFormatters(this._oMetaData,["editable"]);for(var n in Z){i=this._oBinding.fromFormatter(this._oMetaData.model,Z[n]);this._oParent.bindProperty(n,i);}};Y.prototype._setUOMEditState=function(){if(this._oFieldControl.hasUomEditState(this._oMetaData)){var i=this._oFieldControl.getUOMEditState(this._oMetaData);if(i){var n=this._oBinding.fromFormatter(this._oMetaData.model,i);this._oParent.bindProperty("uomEditState",n);}}};Y.prototype.getDataProperty=function(){return this._oMetaData.property;};Y.prototype.getDropdownItemKeyType=function(i){var n=i.getMetadata().getName();if((n==="sap.ui.comp.smartfield.DisplayComboBox")||(n==="sap.m.ComboBox")||(n==="sap.m.Select")){var Z=Y.getBoundPropertiesMapInfoForControl(n,{propertyName:"value"})[0];var $=i.getBindingInfo(Z);return($&&$.type)||null;}return null;};Y.prototype.getMetaData=function(){return this._oMetaData;};Y.prototype.getODataHelper=function(){return this._oHelper;};Y.prototype.destroy=function(){if(this._oFieldControl){this._oFieldControl.destroy();}if(this._oSelector){this._oSelector.destroy();}if(this._oTypes){this._oTypes.destroy();}if(this._oHelper){this._oHelper.destroy();}if(this.oType){this.oType.destroy();this.oType=null;}if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.destroy();}this._oHelper=null;this._oFieldControl=null;this._oTypes=null;this._oSelector=null;this._oMetaData=null;this._oAmountInputFlexItemData=null;this._oUOMInputFlexItemData=null;this._oUOMTextFlexItemData=null;this.oMeasureField=null;this.oTextArrangementDelegate=null;f.prototype.destroy.apply(this,arguments);};return Y;},true);
