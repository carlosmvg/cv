sap.ui.define(["sap/ui/base/Object","sap/ui/base/Event","sap/ui/core/mvc/ControllerExtension","sap/ui/model/Context","sap/ui/model/Filter","sap/m/Table","sap/m/ListBase","sap/m/MessageBox","sap/ui/generic/app/navigation/service/NavError","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/lib/FeLogger","sap/ui/model/analytics/odata4analytics","sap/suite/ui/generic/template/lib/MetadataAnalyser","sap/base/util/extend","sap/base/util/deepExtend","sap/suite/ui/generic/template/lib/FeError"],function(B,E,C,a,F,R,L,M,N,t,b,o,c,d,f,g){"use strict";var s="lib.CommonUtils";var h=sap.ui.getCore();var l=new b(s).getLogger();function m(e,P){var i=sap.ui.require(P);return typeof i==="function"&&(e instanceof i);}function n(e){return m(e,"sap/ui/comp/smarttable/SmartTable");}function p(e){return m(e,"sap/ui/comp/smartchart/SmartChart");}function q(e){return m(e,"sap/ui/table/Table");}function r(e){return m(e,"sap/ui/table/AnalyticalTable");}function u(e){return m(e,"sap/ui/table/TreeTable");}function v(e){return m(e,"sap/m/Table");}function w(e){var T=e&&sap.ui.getCore().byId(e);if(T){T.focus();}}var n=t.testableStatic(n,"CommonUtils_isSmartTable");function x(y,S,z){var A;var D=Object.create(null);var O=Object.create(null);function P(e){var i;if(n(e)){i=e.getCustomToolbar();}else if(p(e)){i=e.getToolbar();}if(i){var j=a1(i);if(j&&j.annotatedActionIds){O[e.getId()]=JSON.parse(atob(j.annotatedActionIds));}if(j&&j.deleteButtonId){O[e.getId()].push({ID:j.deleteButtonId,RecordType:"CRUDActionDelete"});}}}function G(e){if(!O[e.getId()]){P(e);}return O[e.getId()];}function H(e){var i,j,k,P1;i=e.getEntitySet();j=y.getOwnerComponent().getModel().getMetaModel();k=j.getODataEntitySet(i);P1=j.getODataEntityType(k.entityType);return P1;}function I(e,i,j){var k=e instanceof E?e.getSource():e;var P1=k.getId();var Q1=D[P1];if(!Q1){if(j){return null;}Q1={control:k,infoObject:Object.create(null),categories:[]};(i||Function.prototype)(Q1.infoObject,Q1.categories,k);D[P1]=Q1;}return Q1.infoObject;}function J(e,i){for(var j in D){var k=D[j];if(k.categories.indexOf(e)>=0){i(k.infoObject,k.control);}}}function K(e){S.oApplication.attachControlToParent(e,y.getView());}function Q(e){if(e.getVisible&&!e.getVisible()){return null;}return e.getParent()||e.oContainer;}function T(e){var i=y.getView();var j=false;for(var k=i.getVisible()&&h.byId(e);k&&!j;k=Q(k)){j=k===i;}return j;}function U(e,j){var k="";for(var i=0;i<e.length;i++){var P1=e[i];if(T(P1)){if(j){var Q1=h.byId(P1);if(n(Q1)||v(Q1)||q(Q1)){k=k||P1;continue;}}return P1;}}return k;}function V(e,i,j,k){return S.oApplication.getDialogFragmentForView(y.getView(),e,i,j,k);}function W(e,i,j,k,P1){return S.oApplication.getDialogFragmentForViewAsync(y.getView(),e,i,j,k,P1);}var X;function Y(){var e=y.getOwnerComponent();X=X||e.getModel("i18n").getResourceBundle();return X.getText.apply(X,arguments);}function Z(k,e,i,j){var P1,Q1,R1,S1;var T1=y.getOwnerComponent();var U1=e.indexOf("::"+T1.getEntitySet()+"--")+2;P1=e.substring(U1,e.lastIndexOf("::"));P1=P1.replace(/--/g,"|").replace(/::/g,"|");R1=i||k;Q1=P1&&P1!='|'?k+"|"+P1:R1;S1=Y(Q1,j);if(S1===Q1&&Q1!=R1){S1=Y(R1,j);}return S1;}function $(e,i){var i=i||e.getSelectionBehavior();if(i==="DATAPOINT"){return{"dataPoints":e.getSelectedDataPoints().dataPoints,"count":e.getSelectedDataPoints().count};}else if(i==="CATEGORY"){return{"dataPoints":e.getSelectedCategories().categories,"count":e.getSelectedCategories().count};}else if(i==="SERIES"){return{"dataPoints":e.getSelectedSeries().series,"count":e.getSelectedSeries().count};}}function _(e,j,k){var P1=[];if(n(e)){e=e.getTable();}else if(p(e)){e.getChartAsync().then(function(S1){e=S1;if(e&&e.getMetadata().getName()==="sap.chart.Chart"){var T1=false;j=j||e.getSelectionBehavior();k=k||$(e,j);if(k&&k.count>0){if(j==="DATAPOINT"){T1=true;}var U1=k.dataPoints;var V1=[];for(var i=0;i<U1.length;i++){if(T1){if(U1[i].context){P1.push(U1[i].context);}}else{V1.push(U1[i].dimensions);}}if(!T1){P1[0]=V1;}}}});}if(e instanceof L){P1=e.getSelectedContexts();}else if(q(e)){var Q1=e.getPlugins().filter(function(S1){return S1.isA("sap.ui.table.plugins.SelectionPlugin");})[0];var R1=Q1?Q1.getSelectedIndices():e.getSelectedIndices();if(R1){for(var i=0;i<R1.length;i++){P1.push(e.getContextByIndex(R1[i]));}}}return P1;}function a1(e){var i={};if(e instanceof sap.ui.core.Element){e.getCustomData().forEach(function(j){i[j.getKey()]=j.getValue();});}return i;}function b1(e){var j,k,P1;var Q1=n1(e);if(!n(Q1)&&!p(Q1)){Q1=Q1.getParent();}var R1=_(Q1);var S1=Q1.getModel();k=k1(Q1);i1(k,R1,S1,Q1);j=G(Q1);for(var i=0;i<j.length;i++){P1=j[i];c1(P1,S1,R1,Q1);}}function c1(e,i,j,k){var P1;if(e.RecordType==="CRUDActionDelete"){P1=g1(i,j,k);k.getModel("_templPriv").setProperty("/listReport/deleteEnabled",P1);}else if(e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){var Q1=i.getMetaModel();P1=f1(i,Q1,j,e.RecordType,e.Action,k);}var R1=y.getView().byId(e.ID);if(R1&&/generic\/controlProperties/.test(R1.getBindingPath("enabled"))&&P1!==undefined){e1(e.ID,"enabled",P1);}}function d1(e){var i;var j=n1(e);var k=_(j);var P1=e.getModel();i=l1();i1(i,k,P1,j);}function e1(i,e,j){var k=y.getView().getModel("_templPriv");var P1=k.getProperty("/generic/controlProperties/"+i);if(!P1){P1={};P1[e]=j;k.setProperty("/generic/controlProperties/"+i,P1);}else{k.setProperty("/generic/controlProperties/"+i+"/"+e,j);}}function f1(e,i,k,P1,Q1,R1){var S1,T1,U1,V1;var W1=false;if(P1==="com.sap.vocabularies.UI.v1.DataFieldForAction"){S1=i.getODataFunctionImport(Q1);U1=S1&&S1["sap:action-for"];if(U1&&U1!==""&&U1!==" "){if(k.length>0){V1=S1["sap:applicable-path"];if(V1&&V1!==""&&V1!==" "){for(var j=0;j<k.length;j++){if(!k[j]){continue;}T1=e.getObject(k[j].getPath());if(T1&&T1[V1]){W1=true;break;}}}else{W1=true;}}}else{W1=true;}}else if(P1==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(k.length>0||(p(R1)&&R1.getDrillStackFilters().length>0)){W1=true;}}return W1;}function g1(e,i,j){if(i.length===0){return false;}var k=h1(j);var P1=k&&k.Deletable&&k.Deletable.Path;return i.some(function(Q1){var R1=e.getObject(Q1.getPath()+"/DraftAdministrativeData");var S1=!(R1&&R1.InProcessByUser&&!R1.DraftIsProcessedByMe);return S1&&!(P1&&!e.getProperty(P1,Q1));});}function h1(e){var i=e.getModel()&&e.getModel().getMetaModel();var j=i&&i.getODataEntitySet(e.getEntitySet());var k=j&&j["Org.OData.Capabilities.V1.DeleteRestrictions"];return k;}function i1(e,i,j,k){var P1=m1(k);var Q1=y.getView().getModel("_templPriv");var R1=Q1.getProperty("/generic/listCommons/breakoutActionsEnabled");if(P1){var S1=y.byId("template::IconTabBar");var T1="";if(S1){T1=S1.getSelectedKey();}j1(R1,P1,e,i,j,T1,k);}Q1.setProperty("/generic/listCommons/breakoutActionsEnabled",R1);}function j1(e,i,j,k,P1,Q1,R1){var S1;for(var T1 in i){S1=true;var U1=i[T1].id+((Q1&&!i[T1].determining)?"-"+Q1:"");if(R1&&R1.getId().indexOf("AnalyticalListPage")>-1){S1=!!e[U1].enabled;}if(i[T1].requiresSelection){if(k.length>0){if(R1&&p(R1)){if(i[T1].filter==="chart"){S1=true;}}else if(R1&&n(R1)){if(i[T1].filter!=="chart"){S1=true;}}if(i[T1].applicablePath!==undefined&&i[T1].applicablePath!==""){S1=false;for(var V1=0;V1<k.length;V1++){var W1="";var X1=i[T1].applicablePath.split("/");if(X1.length>1){for(var Y1=0;Y1<X1.length-1;Y1++){W1+="/"+X1[Y1];}}var Z1=P1.getObject(k[V1].getPath()+W1);var $1=X1[X1.length-1];if(Z1[$1]===true){S1=true;break;}}}}else if(p(R1)){if((R1.getId().indexOf("AnalyticalListPage")>-1?i[T1].filter==="chart":true)){if(R1.getDrillStackFilters().length>0){S1=true;}else{S1=false;}}}else{if(i[T1].filter!=="chart"){S1=false;}}}e[U1]={enabled:S1};}}function k1(e){var i=[];var j=m1(e);for(var k in j){i.push(j[k].id);}return i;}function l1(){var e=[];var i=m1();for(var j in i){if(i[j].determining){e.push(j);}}return e;}function m1(e){var i=z.getExtensions();var j=a1(e).sectionId;if(!j){return i&&i["Actions"];}else{return i&&i.Sections&&i.Sections[j]&&i.Sections[j].Actions;}}function n1(e){var i=e;while(i){if(i instanceof R||q(i)||n(i)||p(i)){return i;}i=i.getParent&&i.getParent();}return null;}function o1(e){if(n(e)){e=e.getTable();}if(q(e)){return e.getBindingInfo("rows");}else if(e instanceof R){return e.getBindingInfo("items");}return null;}function p1(e,i,j){var k=o1(e);if(k&&k.binding){if(i){k.binding.refresh(i);}else{k.binding.refresh();}if(!j&&y.getView().getModel("ui").getProperty("/editable")){z.messagesRefresh();}}else if(e&&e.rebindTable){e.rebindTable();}}function q1(e){var i=y.getOwnerComponent();var j=i.getModel();var k,P1;var Q1=!S.oApplication.checkEtags();if(Q1){P1=o1(e);if(P1){k=P1.path;var R1=e.getEntitySet();var S1=j.getMetaModel();var T1=S1.getODataEntitySet(R1);if(y.getMetadata().getName()==='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage'&&r1(j,T1)){j.invalidateEntityType(T1.entityType);}else{j.invalidate(s1.bind(null,k));}var U1=i.getId();var V1=Object.create(null);V1[U1]=true;S.oApplication.refreshAllComponents(V1);}}}function r1(e,i){var j=new o.Model(o.Model.ReferenceByModel(e));var k=j.findQueryResultByName(i.name);var P1=k&&k.getParameterization();return!!P1;}function s1(e,k,i){var j=e[0]==="/"?e.substr(1):e;if(k.split("(")[0]===j){return true;}else{return false;}}function t1(e,i){var j;if(z.isDraftEnabled()){j=S.oDraftController.isActiveEntity(e)?1:6;}else{var k=y.getOwnerComponent();j=k.getModel("ui").getProperty("/editable")?6:1;}z.navigateAccordingToContext(e,j,i);}function u1(e){if(e instanceof N){if(e.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){M.show(Y("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:Y("ST_GENERIC_ERROR_TITLE")});}else{M.show(e.getErrorCode(),{title:Y("ST_GENERIC_ERROR_TITLE")});}}}function v1(e,i){G1(function(){A=S.oApplication.getNavigationHandler();var j={semanticObject:e.semanticObject,action:e.action};var k=A.mixAttributesAndSelectionVariant(e.parameters);if(typeof y.adaptNavigationParameterExtension==="function"){y.adaptNavigationParameterExtension(k,j);}A.navigate(e.semanticObject,e.action,k.toJSONString(),null,u1);},Function.prototype,i,"LeavePage");}function w1(e){var P1=[],Q1,R1,S1;var T1=y.getOwnerComponent();var U1=T1.getModel().getMetaModel();if(!e){return{};}var V1=T1.getAppComponent().getConfig().pages[0];if(!V1){return{};}var W1=function(i){S1=U1.getODataEntitySet(i.entitySet).entityType;R1=U1.getODataEntityType(S1);Q1={};Q1={entitySet:i.entitySet,aKeys:U1.getODataEntityType(S1).key.propertyRef,navigationProperty:i.navigationProperty};for(var j=0,Y1=Q1.aKeys.length;j<Y1;j++){var k=0,Z1=R1.property.length;for(k;k<Z1;k++){if(Q1.aKeys[j].name===R1.property[k].name){Q1.aKeys[j].type=R1.property[k].type;break;}}}};var X1=function(e,V1){if(!V1.pages){return P1;}for(var i=0,j=V1.pages.length;i<j;i++){if(!V1.pages[i]){break;}if(e===V1.pages[i].entitySet){W1(V1.pages[i]);P1.splice(0,0,Q1);break;}P1=X1(e,V1.pages[i]);if(P1.length>0){W1(V1.pages[i]);P1.splice(0,0,Q1);}}return P1;};return X1(e,V1);}function x1(k,e){var P1,Q1,i,R1;for(i=0,R1=k.length;i<R1;i++){if(k[i].navigationProperty){Q1+="/"+k[i].navigationProperty;}else{Q1="/"+k[i].entitySet;}for(var j=0,S1=k[i].aKeys.length;j<S1;j++){if(j===0){Q1+="(";P1="";}else{P1=",";}switch(k[i].aKeys[j].type){case"Edm.Guid":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){Q1+=P1+k[i].aKeys[j].name+"="+"guid'"+e.DraftAdministrativeData[k[i].aKeys[j].name]+"'";}else{Q1+=P1+k[i].aKeys[j].name+"="+"guid'"+e[k[i].aKeys[j].name]+"'";}break;case"Edm.Boolean":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){Q1+=P1+k[i].aKeys[j].name+"="+false;}else{Q1+=P1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;default:if(typeof e[k[i].aKeys[j].name]==="string"){Q1+=P1+k[i].aKeys[j].name+"="+"'"+e[k[i].aKeys[j].name]+"'";}else{Q1+=P1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;}if(j===(S1-1)){Q1+=")";}}}return Q1;}function y1(e,k,y){var P1,Q1,R1,S1,T1,U1,V1;var W1={semanticObject:"",action:""};A=S.oApplication.getNavigationHandler();P1=A.mixAttributesAndSelectionVariant({},k);for(S1 in e.semanticAttributesOfSemanticObjects){for(R1 in e.semanticAttributesOfSemanticObjects[S1]){if(!P1.getSelectOption(R1)){P1.addParameter(R1,"");}}T1=P1.getPropertyNames();W1.semanticObject=S1;y.adaptNavigationParameterExtension(P1,W1);U1=P1.getSelectOptionsPropertyNames();V1=P1.getParameterNames();for(var i=0,X1=T1.length;i<X1;i++){if(U1.indexOf(T1[i])<0&&V1.indexOf(T1[i])<0){delete e.semanticAttributesOfSemanticObjects[S1][T1[i]];P1.removeSelectOption(T1[i]);}}if(S1===e.semanticObject){var Y1=e.semanticAttributesOfSemanticObjects[""];for(var j=0,X1=V1.length;j<X1;j++){P1.removeParameter(V1[j]);if(!(V1[j]in Y1)){var Z1=e.semanticAttributesOfSemanticObjects[e.semanticObject][V1[j]];Z1=(typeof Z1==="undefined"||Z1===null)?"":String(Z1);P1.addParameter(V1[j],Z1);}}P1=A.mixAttributesAndSelectionVariant(e.semanticAttributesOfSemanticObjects[S1],P1.toJSONString());Q1=P1.toJSONString();}}delete e.semanticAttributes;A.processBeforeSmartLinkPopoverOpens(e,Q1);}function z1(e,j){var k=function(T1){for(var i=0;i<T1.length;i++){j(T1[i].name);}};var P1=y.getView().getModel().getMetaModel();var Q1=P1.getODataEntitySet(e,false);var R1=P1.getODataEntityType(Q1.entityType,false);k(R1.key.propertyRef);var S1=S.oDraftController.getDraftContext();if(S1.isDraftEnabled(e)){k(S1.getSemanticKey(e));j("IsActiveEntity");j("HasDraftEntity");j("HasActiveEntity");}}function A1(i,j,k,P1,Q1){if(P1&&k&&k.getAnalyticBindingPath&&k.getConsiderAnalyticalParameters()){try{var R1=k.getAnalyticBindingPath();var S1=i.getEntitySet();var T1=i.getModel();var U1=T1.getMetaModel();var V1=U1.getODataEntitySet(S1);var W1=y.getOwnerComponent();var X1=W1.getAppComponent();var Y1=c.getParametersByEntitySet(X1.getModel(),S1);if(j){R1=j(V1,Y1);}if(R1){P1(R1);}}catch(e){l.warning("Mandatory parameters have no values");}}}function B1(e,j,k){for(var i=0;i<j.length;i++){var P1=j[i];var Q1=P1.lastIndexOf("/");var R1;if(Q1<0){if(S.oApplication.getNavigationProperty(e,P1)){R1=P1;}else{continue;}}else{R1=P1.substring(0,Q1);}if(k.indexOf(R1)===-1){k.push(R1);}}}function C1(e,i,j){var k=e.getParameter("bindingParams"),P1=e.getSource().getId();k.parameters=k.parameters||{};k.parameters.transitionMessagesOnly=z.getNoStateMessagesForTables();var Q1=function(X1,Y1,P1){if(i&&i[X1]){var Z1=true;var $1=function(){var _1=arguments[0];if(!(_1 instanceof C)){throw new g(s,"Please provide a valid ControllerExtension in order to execute extension "+X1);}if(!Z1){throw new g(s,"Extension "+X1+" must be executed synchronously");}var a2=Array.prototype.slice.call(arguments,1);Y1.apply(null,a2);};i[X1]($1,P1);Z1=false;}};var R1=function(X1){if(!P1||y.byId(P1)===e.getSource()){k.filters.push(X1);}};if(i.addTemplateSpecificFilters){i.addTemplateSpecificFilters(k.filters);}Q1("addExtensionFilters",R1,P1);var S1=e.getSource();if(y.getMetadata().getName()!=='sap.suite.ui.generic.template.ObjectPage.view.Details'){A1(S1,i.resolveParamaterizedEntitySet,j,i.setBindingPath,i.isAnalyticalListPage?"AnalyticalListPage":"ListReport");}var T1=S1.getEntitySet();var U1=k.parameters.select&&k.parameters.select.split(",")||[];var V1=k.parameters.expand&&k.parameters.expand.split(",")||[];var W1=function(X1,P1){if(X1&&(!P1||y.byId(P1)===e.getSource())){var Y1=X1.split(',');Y1.forEach(function(Z1){if(Z1&&U1.indexOf(Z1)===-1){U1.push(Z1);}});}};if(!i.isAnalyticalListPage){z1(T1,W1);}Q1("ensureExtensionFields",W1,P1);(i.addNecessaryFields||Function.prototype)(U1,W1,T1);B1(T1,U1,V1);if(V1.length>0){k.parameters.expand=V1.join(",");}if(U1.length>0){k.parameters.select=U1.join(",");}}function D1(e,i,j){if(!e){return Y("DRAFT_OBJECT");}else if(i){return Y(j?"LOCKED_OBJECT":"UNSAVED_CHANGES");}else{return"";}}function E1(){return new Promise(function(e){var i;W("sap.suite.ui.generic.template.fragments.DraftAdminDataPopover",{formatText:function(){var j=Array.prototype.slice.call(arguments,1);var k=arguments[0];if(!k){return"";}if(j.length>0&&(j[0]===null||j[0]===undefined||j[0]==="")){if(j.length>3&&(j[3]===null||j[3]===undefined||j[3]==="")){return(j.length>2&&(j[1]===null||j[1]===undefined||j[1]===""))?"":j[2];}else{return Y(k,j[3]);}}else{return Y(k,j[0]);}},closeDraftAdminPopover:function(){i.close();},formatDraftLockText:D1},"admin").then(function(j){i=j;e(i);});});}function F1(e,i,j,k){return S.oDataLossHandler.performIfNoDataLoss(e,i,k,true,true);}function G1(e,i,j,k,P1){return S.oDataLossHandler.performIfNoDataLoss(e,i,k,P1,false);}function H1(e,i){i=f({busy:{set:true,check:true},dataloss:{popup:true,navigation:false}},i);var j,k;var P1=new Promise(function(T1,U1){j=T1;k=U1;});var Q1=i.busy.set?function(){S.oApplication.getBusyHelper().setBusy(P1,false,{actionLabel:i.sActionLabel});return e();}:e;var R1=i.mConsiderObjectsAsDeleted?function(T1){S.oApplication.prepareDeletion(i.mConsiderObjectsAsDeleted);return Q1();}:Q1;var S1=function(){var T1=(i.dataloss.popup?G1(R1,k,null,(i.dataloss.navigation?"LeavePage":"Proceed"),true):R1());if(T1 instanceof Promise){T1.then(j,k);}else{j(T1);}};S.oApplication.performAfterSideEffectExecution(S1,i.busy.check&&k);return P1;}function I1(e){var i=e.getId()+"-variant";var j=sap.ui.getCore().byId(i);var k=j.getDefaultVariantKey();return k===j.STANDARDVARIANTKEY?"":k;}function J1(e){var i=e.getId()+"-variant";var j=sap.ui.getCore().byId(i);var k=j.getDefaultVariantKey();return k===j.STANDARDVARIANTKEY?"":k;}function K1(e){var j;var k=z.getTemplatePrivateModel();var P1=y.getOwnerComponent();var Q1,R1,S1,T1,U1,V1=[],W1=[],i,X1,Y1,Z1,$1,_1,a2;var b2,c2;Q1=P1.getAppComponent();R1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");S1=k.getProperty("/generic/supportedIntents/");if(p(e)){j=e.getToolbar();}else if(n(e)){j=e.getCustomToolbar();}T1=j.getContent();U1=T1.length;for(i=0;i<U1;i++){X1=a1(T1[i]);if(X1.hasOwnProperty("SemanticObject")&&X1.hasOwnProperty("Action")){Y1=X1.SemanticObject;Z1=X1.Action;$1={semanticObject:Y1,action:Z1,ui5Component:Q1};V1.push([$1]);_1=d({},$1);_1.bLinkIsSupported=false;W1.push(_1);}}if(V1.length>0&&R1){a2=R1.getLinks(V1);a2.done(function(d2){S1=k.getProperty("/generic/supportedIntents/");b2=d2.length;for(i=0;i<b2;i++){if(d2[i][0].length>0){W1[i].bLinkIsSupported=true;}Y1=W1[i].semanticObject;Z1=W1[i].action;c2=k.getProperty("/generic/supportedIntents/"+Y1);if(!c2){S1[Y1]={};S1[Y1][Z1]={"visible":W1[i].bLinkIsSupported};}else if(!c2[Z1]){c2[Z1]={"visible":W1[i].bLinkIsSupported};}else{c2[Z1]["visible"]=W1[i].bLinkIsSupported;}}k.updateBindings();});}}function L1(e,i){var j=i&&y.byId(i);var k=(i&&!j)?Promise.reject():new Promise(function(P1,Q1){S.oApplication.performAfterSideEffectExecution(function(){var R1=S.oApplication.getBusyHelper();if(R1.isBusy()){Q1();return;}if(j&&(!j.getVisible()||(j.getEnabled&&!j.getEnabled()))){Q1();return;}var k=j?e(j):e();if(k instanceof Promise){k.then(P1,Q1);R1.setBusy(k);}else{P1(k);}});});k.catch(Function.prototype);return k;}function M1(e,i){if(e.oSmartTable){N1(e.oSmartTable,i);}if(e.oSmartChart){N1(e.oSmartChart,i);}}function N1(e,i){var j=e.getUiState();var k=j.getPresentationVariant();if(!k.SortOrder&&e.isA("sap.ui.comp.smarttable.SmartTable")){var P1=e.getCustomData().find(function(V1){return V1.getKey()==="TemplateSortOrder";});var Q1=P1&&P1&&P1.getValue();if(Q1){k.SortOrder=[];var R1=Q1.split(", ");R1.forEach(function(V1){var W1=V1.split(" ");if(W1.length>1){k.SortOrder.push({Property:W1[0],Descending:W1[1]==="true"});}});}}var S1=function(V1){var W1=e.getModel().getMetaModel();var X1=W1.getODataEntitySet(e&&e.getEntitySet());var Y1=W1.getODataEntityType(X1.entityType);var Z1=Y1.property;return Z1.some(function($1){return $1.name===V1.Property;});};var T1=i.filter(function(V1){return S1(V1);});var U1=T1.concat(k.SortOrder);U1=U1.filter(function(V1){return V1!==undefined;});k.SortOrder=U1;j.setPresentationVariant(k);e.setUiState(j);}function O1(e,i,j,k,P1){var Q1,R1={};if(!i){Q1=[];}else if(Array.isArray(i)){Q1=i;}else{Q1=[i];}if(j){R1.urlParameters=j;}if(k&&k.bInvocationGroupingChangeSet){R1.operationGrouping="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet";}R1.triggerChanges=z.isDraftEnabled();z.executeBeforeInvokeActionFromExtensionAPI(P1);var S1=S.oApplicationController.invokeActions(e,Q1,R1);if(k&&k.bSetBusy){z.getBusyHelper().setBusy(S1);}S1.then(z.executeAfterInvokeActionFromExtensionAPI.bind(null,P1));return S1;}var i1=t.testable(i1,"fillEnabledMapForBreakoutActions");var k1=t.testable(k1,"getBreakoutActionIds");var n1=t.testable(n1,"getOwnerControl");var _=t.testable(_,"getSelectedContexts");var G=t.testable(G,"fnGetToolbarCutomData");return{isSmartTable:n,isSmartChart:p,isUiTable:q,isAnalyticalTable:r,isTreeTable:u,isMTable:v,getPositionableControlId:U,getMetaModelEntityType:H,getText:Y,getContextText:Z,getNavigationKeyProperties:w1,mergeNavigationKeyPropertiesWithValues:x1,executeGlobalSideEffect:function(){if(z.isDraftEnabled()){var e=y.getView();var i=y.getOwnerComponent();var j=i.getAppComponent();var k=j.getForceGlobalRefresh();var P1=i.getModel("ui");e.attachBrowserEvent("keydown",function(Q1){var R1=Q1.target.type==="search";var S1=Q1.target.type==="textarea";var T1=Q1.target.id.indexOf("rowAction")>-1;var U1=Q1.target.id.indexOf("ColumnListItem")>-1;if(Q1.keyCode===13&&Q1.ctrlKey!==true&&P1.getProperty("/editable")&&!R1&&!S1&&!T1&&!U1){S.oApplication.addSideEffectPromise(new Promise(function(V1,W1){setTimeout(function(){var X1=S.oApplicationController.executeSideEffects(e.getBindingContext(),null,null,k);X1.then(function(){V1();setTimeout(function(){var Y1=document.getElementById(Q1.target.id);if(Y1){Y1.focus();}});},W1);});}));}});}},setEnabledToolbarButtons:b1,setEnabledFooterButtons:d1,fillEnabledMapForBreakoutActions:i1,getBreakoutActions:m1,getSelectedContexts:_,getSelectionPoints:$,getDeleteRestrictions:h1,getSmartTableDefaultVariant:I1,getSmartChartDefaultVariant:J1,setPrivateModelControlProperty:e1,navigateFromListItem:t1,navigateExternal:v1,semanticObjectLinkNavigation:y1,getCustomData:function(e){var j=e.getSource().getCustomData();var k={};for(var i=0;i<j.length;i++){k[j[i].getKey()]=j[i].getValue();}return k;},getCustomDataText:function(e){return new Promise(function(j,k){e.getCustomData().forEach(function(P1){var Q1=P1.getKey();if(Q1==="text"){var R1=P1.getBinding("value");var S1=!R1&&P1.getBindingInfo("value");if(!R1&&!S1){j(P1.getValue());return;}var T1=function(U1){j(U1.getSource().getExternalValue());return;};if(R1){R1.attachChangeOnce(T1);}else{S1.events={change:T1};for(var i=0;i<S1.parts.length;i++){S1.parts[i].targetType="string";}}}});});},onBeforeRebindTableOrChart:C1,formatDraftLockText:D1,showDraftPopover:function(e,i){E1().then(function(j){var k=j.getModel("admin");k.setProperty("/IsActiveEntity",e.getProperty("IsActiveEntity"));k.setProperty("/HasDraftEntity",e.getProperty("HasDraftEntity"));j.bindElement({path:e.getPath()+"/DraftAdministrativeData"});if(j.getBindingContext()){j.openBy(i);}else{j.getObjectBinding().attachDataReceived(function(){j.openBy(i);});}});},getContentDensityClass:function(){return S.oApplication.getContentDensityClass();},attachControlToView:K,getDialogFragment:V,getDialogFragmentAsync:W,processDataLossConfirmationIfNonDraft:G1,processDataLossTechnicalErrorConfirmation:F1,securedExecution:H1,getOwnerControl:n1,getTableBindingInfo:o1,refreshSmartTable:p1,refreshModel:q1,getElementCustomData:a1,triggerAction:function(e,i,j,k,P1){G1(function(){S.oCRUDManager.callAction({functionImportPath:j.Action,contexts:e,sourceControl:k,label:j.Label,operationGrouping:""}).then(function(Q1){if(Q1&&Q1.length>0){var R1=Q1[0];if(R1.response&&R1.response.context&&(!R1.actionContext||R1.actionContext&&R1.response.context.getPath()!==R1.actionContext.getPath())){S.oApplication.getBusyHelper().getUnbusy().then(S.oViewDependencyHelper.setMeToDirty.bind(null,y.getOwnerComponent(),i));}}});},Function.prototype,P1,"Proceed");},checkToolbarIntentsSupported:K1,executeIfControlReady:L1,getControlInformation:I,executeForAllInformationObjects:J,focusControl:w,setControlSortOrder:M1,invokeActionsForExtensionAPI:O1};}return B.extend("sap.suite.ui.generic.template.lib.CommonUtils",{constructor:function(e,S,i){d(this,x(e,S,i));}});});
