sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/m/MessageBox","sap/m/plugins/DataStateIndicator","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/generic/app/navigation/service/SelectionVariant","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/detailTemplates/detailUtils","sap/suite/ui/generic/template/ObjectPage/controller/SideContentHandler","sap/suite/ui/generic/template/ObjectPage/extensionAPI/ExtensionAPI","sap/suite/ui/generic/template/js/AnnotationHelper","sap/m/Table","sap/ui/layout/DynamicSideContent","sap/suite/ui/generic/template/lib/ShareUtils","sap/ui/dom/jquery/Selectors","sap/suite/ui/generic/template/lib/FeLogger","sap/suite/ui/generic/template/ObjectPage/controller/MultipleViewsHandler","sap/suite/ui/generic/template/lib/MessageUtils","sap/ui/events/KeyCodes","sap/base/util/merge","sap/ui/model/FilterProcessor","sap/suite/ui/generic/template/js/StableIdHelper","sap/ui/core/Element","sap/uxap/ObjectPageSubSection","sap/ui/core/MessageType","sap/base/util/extend","sap/base/util/UriParameters","sap/base/util/isEmptyObject","sap/ui/dom/getFirstEditableInput","sap/ui/dom/jquery/Focusable","sap/suite/ui/generic/template/lib/FeError","sap/suite/ui/generic/template/lib/CreateWithDialogHandler"],function(C,M,D,F,S,a,t,d,b,E,A,R,c,f,g,h,l,m,K,n,o,p,q,O,r,s,U,u,v,w,y,z){"use strict";var B="ObjectPage.controller.ControllerImplementation";var L=new h(B).getLogger();var G=25;var H=10;var I={};function J(e){e.setSelectedSection(null);}function N(e){return e.data("inlineCreate")==="true";}function P(e){var i=e.getBlocks().concat(e.getMoreBlocks()).concat(e.getActions());return i;}function Q(e,j){if(e.getBindings){var k=e.getBindings();for(var i=0;i<k.length;i++){Q(k[i],j);}}else{var x=e.getType();e.setType(x,j);}}var T=/[A-Za-z].*[A-Za-z]/;var V={getMethods:function(W,X,Y){var Z=d.getControllerBase(W,X,Y);W.oController=Y;var $;var _=new b(Y,X,Z.stateChanged);var a1;var b1;var c1;var d1;var e1;var f1=Object.create(null);var g1=null;var h1=[];var i1=null;var j1=null;var k1=null;var l1;var m1;function n1(e){var i=e.getParameter("bindingParams");i.parameters=i.parameters||{};i.parameters.usePreliminaryContext=true;i.parameters.batchGroupId="facets";return i;}function o1(){L.info("Activate object","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");var e=X.oServices.oCRUDManager.activateDraftEntity();var i=$.getModel("ui");var j=i.getProperty("/createMode");e.then(function(x){C1();if(j){m.showSuccessMessageIfRequired(X.oCommonUtils.getText("OBJECT_CREATED"),X.oServices);}else{m.showSuccessMessageIfRequired(X.oCommonUtils.getText("OBJECT_SAVED"),X.oServices);}var U2=Y.getOwnerComponent();X.oServices.oViewDependencyHelper.setAllPagesDirty([U2.getId()]);X.oServices.oViewDependencyHelper.unbindChildren(U2);X.oServices.oApplication.invalidatePaginatorInfo();var V2=U2.getNavToListOnSave();X.oServices.oApplication.navigateAfterActivation(!V2&&x.context);},Function.prototype);var k={activationPromise:e};X.oComponentUtils.fire(Y,"AfterActivate",k);}function p1(e){var i=Y.getView();var j=i.getModel();var k=j.hasPendingChanges(true);var x=j.getPendingChanges();var U2=Object.create(null);if(x){for(var V2 in x){if(x.hasOwnProperty(V2)){var W2=j.getContext("/"+V2);U2[V2]={context:W2,change:x[V2]};}}}X.oCommonEventHandlers.submitChangesForSmartMultiInput();var X2=X.oServices.oCRUDManager.saveEntity();X2.then(function(Z2){if(!e){var $2=X.oComponentUtils.getTemplatePrivateModel();$2.setProperty("/objectPage/displayMode",1);W.setEditable(false);}q1(Z2,i,k,U2,e);});var Y2={saveEntityPromise:X2};X.oComponentUtils.fire(Y,"AfterSave",Y2);}function q1(e,i,j,k,x){var U2=$.getModel("ui");var V2=U2.getProperty("/createMode");var W2=Y.getOwnerComponent();X.oServices.oViewDependencyHelper.setParentToDirty(W2,W2.getEntitySet(),1);X.oServices.oViewDependencyHelper.unbindChildren(W2);var X2=W2.getNavToListOnSave();var Y2=!X2||x;if(Y2){if(V2){X.oComponentUtils.adaptUrlAfterNonDraftCreateSaved(i.getBindingContext(),x);}o2($);}else{W.navigateUp();}var Z2;if(V2){Z2="OBJECT_CREATED";}else{Z2=j?"OBJECT_SAVED":"OBJECT_NOT_MODIFIED";}m.showSuccessMessageIfRequired(X.oCommonUtils.getText(Z2),X.oServices);for(var $2 in k){var _2=k[$2];var a3=_2.context;var b3=_2.change;var c3=Object.keys(b3)||[];var d3=c3.indexOf("__metadata");if(d3>-1){c3.splice(d3,1);}X.oServices.oApplicationController.executeSideEffects(a3,c3);}}function r1(e){var i=e.getSource().getId();s1("SaveAndContEdit",i);}function s1(e,i){var j=function(e,i){var x;var U2;var V2;if(X.oComponentUtils.isDraftEnabled()){x=1;U2=o1;V2="activate";}else{x=3;if(e==="SaveAndContEdit"){U2=p1.bind(null,true);V2=i;}else{U2=p1.bind(null,false);V2="save";}}var W2=X.oComponentUtils.getCRUDActionHandler();X.oCommonUtils.executeIfControlReady(W2.handleCRUDScenario.bind(null,x,U2),V2);};var k=Promise.resolve(Y.beforeSaveExtension());k.then(j.bind(null,e,i),jQuery.noop());}function t1(e){if(N(e.getSource())){var i=e.getParameter("bindingParams");if(i.filters&&i.filters.length){var j=o.groupFilters(i.filters);if(!e.getParameter("messageFilterActive")){i.filters=new F({filters:[new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:true}),j],and:true}),new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:false}),new F({filters:[j,new F({path:"HasActiveEntity",operator:"EQ",value1:false})],and:false})],and:true})],and:false});}else{i.filters=j;}}var k=i.sorter[0]&&i.sorter[0].getGroupFunction();var x=k&&function(U2){var V2=U2.getObject();if(V2.IsActiveEntity||V2.HasActiveEntity){var W2=s({},k(U2));W2.key=W2.key.charAt(0)==="ยง"?"ยง"+W2.key:W2.key;return W2;}return{key:"ยง",text:X.oCommonUtils.getText("NEW_ENTRY_GROUP")};};if(e.getSource().data("disableInlineCreateSort")==="false"){i.sorter.unshift(new S("HasActiveEntity",false,x));}}}function u1(){return $.getHeaderTitle();}function v1(e){var i=X.oComponentUtils.getTemplatePrivateModel();var j={shareEmailPressed:function(){var k=i.getProperty("/objectPage/headerInfo/objectTitle");var x=i.getProperty("/objectPage/headerInfo/objectSubtitle");if(x){k=k+" - "+x;}var U2=document.URL.replace(/\(/g,'%28').replace(/\)/g,'%29');sap.m.URLHelper.triggerEmail(null,k,U2);},shareJamPressed:function(){f.openJamShareDialog(i.getProperty("/objectPage/headerInfo/objectTitle")+" "+i.getProperty("/objectPage/headerInfo/objectSubtitle"));},getModelData:function(){return{serviceUrl:"",title:i.getProperty("/objectPage/headerInfo/objectTitle"),subtitle:i.getProperty("/objectPage/headerInfo/objectSubtitle"),customUrl:f.getCustomUrl()};}};f.openSharePopup(X.oCommonUtils,e,j);}function w1(){return X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.RelatedAppsSheet",{buttonPressed:function(e){var i=e.getSource();var j=i.getBindingContext("buttons");var k=j.getProperty("link");var x=j.getProperty("param");var U2=k.intent;var V2=U2.split("#")[1].split("-")[0];var W2=U2.split("-")[1].split("?")[0].split("~")[0];var X2={semanticObject:V2,action:W2,parameters:x};X.oServices.oDataLossHandler.performIfNoDataLoss(function(){var Y2=Y.getView().getBindingContext();X.oCommonEventHandlers.onRelatedAppNavigation(X2,Y2);},Function.prototype);}},"buttons");}var x1;function y1(){x1=function(e){var i=e.getSource().getParent();var j=X.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=Y.getOwnerComponent();var x=k.getModel("_templPrivGlobal");var U2={objectPage:{currentEntitySet:k.getProperty("entitySet")}};x.setProperty("/generic/multipleViews",U2);var V2=X.oServices.oCRUDManager.deleteEntity();var W2=k.getBindingContext().getPath();var X2=Object.create(null);X2[W2]=V2;var Y2={deleteEntityPromise:V2};X.oComponentUtils.fire(Y,"AfterDelete",Y2);i.close();};return X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(e){var i=e.getSource().getParent();i.close();},onDelete:function(e){x1(e);}},"delete",Function.prototype,true);}function z1(){var i;var e=X.oServices.oApplication.getBusyHelper();if(e.isBusy()){return;}var j=X.oComponentUtils.getTemplatePrivateModel();var k=(j.getProperty("/objectPage/headerInfo/objectTitle")||"").trim();var x=j.getProperty("/objectPage/headerInfo/objectSubtitle");var U2=X.oComponentUtils.getViewLevel();var i=U2>1;var V2={};V2.title=X.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");V2.text=X.oCommonEventHandlers.getDeleteText(k,x,!i,i);var W2=Promise.resolve(Y.beforeDeleteExtension());W2.then(function(X2){s(V2,X2);y1().then(function(Y2){var Z2=Y2.getModel("delete");Z2.setData(V2);Y2.open();});},Function.prototype);}function A1(e){var i=e.getParameter("columnInfos");var j=i&&i.length-1;while(j>=0){if(i[j].ignore){i.splice(j,1);}j-=1;}var k=i.reduce(function(U2,V2){if(!V2.type&&!V2.customParseFunction){U2.push(V2);}return U2;},[]);if(k.length>0){var x=X.oCommonUtils.getText("DATA_PASTE_UNSUPPORTED_FORMAT_MESSAGE");M.show(x,{icon:M.Icon.ERROR,title:X.oCommonUtils.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE]});}}function B1(e){var j;var k=e.getSource();var x=k.getId();var U2=x.split("::Table")[0]+"::addEntry";var V2=Y.byId(U2);if(!V2){return;}var W2=e.getParameter("result");if(W2){if(W2.errors){var X2=W2.errors.map(function(e3){return e3.message;});var Y2=X.oCommonUtils.getText("DATA_PASTE_ERROR_MESSAGE",[X2.length]);var Z2=X.oCommonUtils.getText("DATA_PASTE_ERROR_CORRECTION_MESSAGE");var $2=X.oCommonUtils.getText("DATA_PASTE_ERROR_CORRECTION_NOTE");X2.unshift("");X2.unshift($2);X2.unshift(Z2);M.show(Y2,{icon:M.Icon.ERROR,title:X.oCommonUtils.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],details:X2.join("<br>")});}else if(W2.parsedData){j=W2.parsedData;if(j&&j.length){var _2=j.length;var a3;var b3,c3=[];var d3=sap.m.DraftIndicatorState.Saved;for(var i=0;i<_2;i++){a3=i<_2-1;b3=X.oCommonEventHandlers.addEntry(V2,true,undefined,j[i],a3);c3.push(b3);}Promise.all(c3).then(function(){var e3=Y.getOwnerComponent();var f3=e3.getAppComponent();var g3=f3.getModel("_templPrivGlobal");g3.setProperty("/generic/draftIndicatorState",d3);});}}}}function C1(){var e=X.oComponentUtils.getTemplatePrivateModel();var i=e.getProperty("/objectPage/aPasteAttachedTables");var j=i.length;var k;var x;while(j>=0){k=i[j];x=Y.byId(k+"::Table");if(x&&x.isA("sap.ui.comp.smarttable.SmartTable")&&x.hasListeners("paste")){x.detachBeforePaste(A1);x.detachPaste(B1);i.splice(j,1);}j-=1;}}function D1(e){X.oCommonUtils.executeIfControlReady(z1,"delete");}function E1(e,i){var j,k;if(e){k=e.context||e;if(X.oServices.oDraftController.getDraftContext().hasDraft(k)){X.oServices.oViewDependencyHelper.setRootPageToDirty();j=k.context||k;}}if(j){X.oServices.oApplication.invalidatePaginatorInfo();X.oServices.oApplication.switchToDraft(j);}else{var x=X.oComponentUtils.getTemplatePrivateModel();x.setProperty("/objectPage/displayMode",2);o2($);}W.setEditable(true);}var F1;function G1(e){e=!!e&&typeof e==="boolean";X.oServices.oCRUDManager.editEntity(e).then(function(i){if(i.draftAdministrativeData){F1(i.draftAdministrativeData.CreatedByUserDescription||i.draftAdministrativeData.CreatedByUser);}else{E1(i.context,false);}});}F1=function(e){var i;X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.UnsavedChangesDialog",{onEdit:function(){i.close();G1(true);},onCancel:function(){i.close();}},"Dialog").then(function(j){i=j;var k=i.getModel("Dialog");var x=X.oCommonUtils.getText("DRAFT_LOCK_EXPIRED",[e]);k.setProperty("/unsavedChangesQuestion",x);i.open();});};function H1(){var j="{\"SelectionVariantID\":\"\"}";var k=Y.getOwnerComponent();var U2=k.getEntitySet();var V2=k.getModel();var W2=V2.getMetaModel();var X2=W2.getODataEntitySet(U2);var Y2=W2.getODataEntityType(X2.entityType);var Z2=Y2.property;var $2=[];for(var x in Z2){var _2=Z2[x]["com.sap.vocabularies.Common.v1.FieldControl"]&&Z2[x]["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(_2&&$2.indexOf(_2)<0){$2.push(_2);}}var a3=Y.getView().getBindingContext();var b3=a3.getObject();var c3=new a();for(var i in Z2){var d3=Z2[i].type;var e3=Z2[i].name;var f3=b3[Z2[i].name];if($2.indexOf(e3)>-1){continue;}if(e3&&(f3||d3==="Edm.Boolean")){if(d3==="Edm.Time"&&f3.ms!==undefined){f3=f3.ms;}if(typeof f3!=="string"){try{f3=f3.toString();}catch(e){f3=f3+"";}}c3.addParameter(e3,f3);}}j=c3.toJSONString();return j;}function I1(e,i){var j=true;var k=i.getModel();i=i instanceof R?i.getParent():i;var x=X.oCommonUtils.getDeleteRestrictions(i);var U2=x&&x.Deletable&&x.Deletable.Path;if(U2){j=k.getProperty(U2,e);}return j;}var J1;function K1(e,j,k){var x=[];J1=function(U2){var V2=X.oServices.oApplication.getBusyHelper();var W2=U2.getSource().getParent();x=[];var X2;var Y2;var Z2=Y.getView().getModel().getObject(j[0].getPath());for(var i=0;i<j.length;i++){if(I1(j[i],e)){x.push(j[i].getPath());}}var $2=X.oServices.oCRUDManager.deleteEntities({pathes:x});V2.setBusy($2);X.oServices.oApplicationController.executeSideEffects(e.getBindingContext(),[],[e.getTableBindingPath()]);$2.then(function(a3){X.oCommonUtils.refreshSmartTable(e);if(Z2.IsActiveEntity===false){Y2=0;}else{Y2=a3.length;}X2=x.length-Y2;var b3="";if(X2>0){if(X.oCommonUtils.isUiTable(e.getTable())){var c3=e.getTable().getPlugin("sap.ui.table.plugins.SelectionPlugin");if(c3){c3.clearSelection();}}if(X2>1){b3=X.oCommonUtils.getContextText("DELETE_SUCCESS_PLURAL_WITH_COUNT",e.getId(),null,[X2]);}else{if(Y2>0){b3=X.oCommonUtils.getContextText("DELETE_SUCCESS_WITH_COUNT",e.getId(),null,[X2]);}else{b3=X.oCommonUtils.getContextText("ITEM_DELETED",e.getId());}}}if(Y2>0){if(Y2>1){b3+=b3&&b3+"\n";b3+=X.oCommonUtils.getContextText("DELETE_ERROR_PLURAL_WITH_COUNT",e.getId(),null,[Y2]);}else{if(X2>0){b3+="\n";b3+=X.oCommonUtils.getContextText("DELETE_ERROR_WITH_COUNT",e.getId(),null,[Y2]);}else{b3+=X.oCommonUtils.getContextText("DELETE_ERROR",e.getId());}}}if(b3){if(Y2>0){M.error(b3);}else{m.showSuccessMessageIfRequired(b3,X.oServices);}}});var _2={deleteEntitiesPromise:$2,sUiElementId:k,aContexts:j};X.oComponentUtils.fire(Y,"AfterLineItemDelete",_2);W2.close();};return X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(i){var U2=i.getSource().getParent();U2.close();},onDelete:function(i){J1(i);}},"delete",Function.prototype,true);}function L1(e){var i=X.oCommonUtils.getOwnerControl(e);if(!X.oCommonUtils.isSmartTable(i)){i=i.getParent();}var j=X.oCommonUtils.getSelectedContexts(i);var k=e.getParent().getParent().getId();M1(i,j,k);}function M1(e,j,k){if(j.length===0){M.error(X.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:X.oCommonUtils.getContentDensityClass()});return;}var x=[];var U2;var V2=[];if("getMode"in e.getTable()){U2=e.getTable().getMode();}for(var i=0;i<j.length;i++){if(I1(j[i],e)){x.push(j[i].getPath());}else{V2.push(j[i]);}}var W2={};W2.undeletableCount=0;W2.tableMode=U2;if(j.length>1){W2.title=X.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[j.length]);W2.text=X.oCommonUtils.getContextText("DELETE_SELECTED_ITEMS",e.getId());}else{W2.title=X.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");W2.text=X.oCommonEventHandlers.getSelectedItemContextForDeleteMessage(e,j[0],true);}if(V2.length>0){W2.undeletableText=X.oCommonUtils.getContextText("DELETE_UNDELETABLE_ITEMS",e.getId(),null,[V2.length,j.length]);if(U2==='Delete'){W2.undeletableCount=V2.length;W2.undeletableText=undefined;W2.text=X.oCommonUtils.getText("DELETE_UNDELETABLE_ITEM");}}var X2={sUiElementId:k,aContexts:j};var Y2=Promise.resolve(Y.beforeLineItemDeleteExtension(X2));Y2.then(function(Z2){s(W2,Z2);K1(e,j,k).then(function($2){if(!V2.length){W2.undeletableText=undefined;}var _2=$2.getModel("delete");_2.setData(W2);$2.open();});},Function.prototype);}function N1(){var i=Y.byId("imageDialog");var e=i?Promise.resolve(i):X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.ImageDialog",{onImageDialogClose:function(){i.close();}},"headerImage");e.then(function(j){i=j;});return e;}function O1(){var e=X.oComponentUtils.getTemplatePrivateModel();e.setProperty("/objectPage/isHeaderExpanded",true);var i=Y.getView().byId("template::ObjectPage::ObjectPageHeader");i.attachStateChange(function(j){var k=j.getParameter("isExpanded");e.setProperty("/objectPage/isHeaderExpanded",k);});}function P1(){var e;var j=X.oComponentUtils.getTemplatePrivateModel();var k=function(i){return function(x){var U2=x.getSource();var V2=U2.getExternalValue();j.setProperty("/objectPage/headerInfo/"+i,V2);if(i==="objectTitle"){X.oComponentUtils.setText(V2);if(!V2){var W2=X.oComponentUtils.getHeaderDataAvailablePromise();W2.then(function(X2){V2=U2.getExternalValue();if(V2){return;}var Y2=Y.getView();var Z2=X2.getObject();var $2=Y2.getModel("ui");var _2=$2.getProperty("/createMode");if(_2&&Z2&&(Z2.IsActiveEntity===undefined||Z2.IsActiveEntity===false||Z2.HasActiveEntity===false)){e=e||X.oCommonUtils.getText("NEW_OBJECT");j.setProperty("/objectPage/headerInfo/objectTitle",e);X.oComponentUtils.setText(e);}});}}};};$.getCustomData().forEach(function(x){var U2=x.getKey();if(U2==="objectTitle"||U2==="objectSubtitle"){var V2=x.getBinding("value");var W2=!V2&&x.getBindingInfo("value");if(!V2&&!W2){j.setProperty("/objectPage/headerInfo/"+U2,x.getValue());return;}var X2=k(U2);if(V2){V2.attachChange(X2);Q(V2,"string");}else{W2.events={change:X2};for(var i=0;i<W2.parts.length;i++){W2.parts[i].targetType="string";}}}});}function Q1(e){e.preventDefault();var i=X.oCommonUtils.getControlInformation(e,null,true);if(i){X.oServices.oDataLossHandler.performIfNoDataLoss(i.navigate,Function.prototype);}}function R1(e){return!!(e&&X.oCommonUtils.getPositionableControlId(e));}function S1(e){var j="";for(var i=0;i<e.length;i++){if(R1([e[i]])){var k=q.registry.get(e[i]);return T1(k);}}if(Y&&Y.getOwnerComponent()&&Y.getOwnerComponent().getModel("i18n")){j=Y.getOwnerComponent().getModel("i18n").getResourceBundle().getText("GENERIC_MESSAGE_GROUP_NAME");}return j;}function T1(e){if(!e){return"";}if(e instanceof sap.uxap.ObjectPageSection){return e.getTitle();}else{return T1(e.getParent());}}function U1(e){var j=$.getSections();for(var i=0;i<j.length;i++){if(j[i].getTitle()===e){return i+1;}}return 9999999;}var V1=new sap.ui.model.Sorter("msg>");function W1(e){switch(e){case r.Error:return 1;case r.Warning:return 2;case r.Success:return 3;case r.Information:return 4;case r.None:return 5;default:return 6;}}V1.fnCompare=function(e,i){var j=U1(S1(e.controlIds))*H+W1(e.type);var k=U1(S1(i.controlIds))*H+W1(i.type);if(j<k){return-1;}if(j>k){return 1;}return 0;};function X1(e,i){L.info("Set binding context to "+e,"Subsection: "+i.getId(),"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");var j=P(i);j.forEach(function(k){k.setBindingContext(e);});}function Y1(e,i,j,k,x,U2){var V2={bWaitForViewportEnter:i,waitFor:{bLayoutFinished:e,bStateApplied:j,bRebindCompleted:k},activeHandler:x||function(W2,X2){if(P(W2).length&&P(W2)[0].getBindingContext()===null){X1(undefined,W2);X2.refresh(null,true,true);}},inActiveHandler:U2||function(W2,X2){X1(null,W2);}};return V2;}function Z1(e){var i=e.getBlocks()[0];X.oComponentUtils.onVisibilityChangeOfReuseComponent(true,i);}function $1(e){var i=e.getBlocks()[0];X.oComponentUtils.onVisibilityChangeOfReuseComponent(false,i);}var _1={lazyLoading:Y1(false,true,false,true),lazyLoadingAfterHeader:Y1(true,true,false,true),activateAfterHeaderDataReceived:Y1(true,false,false,true),activateWithBindingChange:Y1(false,false,false,true),reuseComponent:Y1(true,true,false,true,Z1,$1)};function a2(e,i,j,k){if(k instanceof c){k=k.getMainContent()[0];}else if(!k.getContent){return;}k.getContent().forEach(function(x){if(X.oCommonUtils.isSmartTable(x)){if(i||e[x.getEntitySet()]){if(x.isInitialised()){X.oCommonUtils.refreshSmartTable(x,null,j);}else{x.attachInitialise(X.oCommonUtils.refreshSmartTable.bind(null,x,null,j));}if(!i){X.oServices.oApplicationController.executeSideEffects(Y.getOwnerComponent().getBindingContext(),[],[x.getTableBindingPath()]);}}}});}function b2(e){return X.oCommonUtils.getControlInformation(e);}function c2(e){h1.push(e);X.oCommonUtils.getControlInformation(e,function(i,j){var k=P(e);_.initSideContentInfoObject(k[0]);i.refresh=function(V2,W2,X2){var Y2=a2.bind(null,V2,W2,X2);k.forEach(Y2);};var x=X.oCommonUtils.getElementCustomData(e).loadingStrategy;var U2=_1[x];i.loadingStrategy=U2||Y1(false,false,false,false,Function.prototype,Function.prototype);j.push("subSection");if(!i.loadingStrategy.bWaitForViewportEnter){j.push("subSectionNotWaitingForViewPort");}});}function d2(e){var j=[];for(var i=0;i<e.length;i++){if(e[i].getVisible()){j.push(e[i]);}}return j;}function e2(e){var i=e?e.getSubSections():$.getSections();var j=d2(i);return j.length===1&&!!(e||e2(j[0]));}function f2(e,i){var j=e.getParent();var k="sapSmartTemplatesObjectPageSubSectionGridExpand",x="sapUxAPObjectPageSubSectionFitContainer";while(j){if(j.isA("sap.ui.layout.Grid")){i?j.addStyleClass(k):j.removeStyleClass(k);}else if(j.isA("sap.uxap.ObjectPageSubSection")){i?j.addStyleClass(x):j.removeStyleClass(x);e.setFitContainer(i);return null;}else{L.warning("Unexpected parent "+j.toString()+" in fnHandleUiTableExpand method");}j=j.getParent();}}function g2(e,i){var j="sapUiSizeCompact",k="sapUiSizeCondensed",x;x=document.body;if(!e.bCondensedTableLayout||!(e.bSetFitContainer||i.hasStyleClass("sapUiSizeCondensed"))){return null;}else if(e.bSetFitContainer&&x.classList.contains(j)){i.addStyleClass(k);}else{i.removeStyleClass(k);}}function h2(e,i,j){if(i.isA("sap.m.Table")){i.setGrowingThreshold(j.growingThreshold);i.setGrowingScrollToLoad(j.bGrowingScrollOnLoad);}else if(i.isA("sap.ui.table.Table")){f2(e,j.bSetFitContainer);g2(j,i);}}function i2(e,i,j){var k={growingThreshold:10,bSetFitContainer:false,bGrowingScrollOnLoad:false};var x=Y.getOwnerComponent().mProperties;k.bCondensedTableLayout=x.condensedTableLayout;if(x&&x.sections){var U2=x.sections[j];if(U2&&U2.hasOwnProperty("condensedTableLayout")){k.bCondensedTableLayout=U2.condensedTableLayout;}}var V2;if($.getUseIconTabBar()){V2=i.getParent();while(V2&&V2.sParentAggregationName!=="sections"){V2=V2.getParent();}}if(e2(V2)){k.growingThreshold=G;k.bGrowingScrollOnLoad=true;k.bSetFitContainer=true;}h2(e,i,k);}function j2(e){var j=$.getSections().filter(function(W2){return(W2.getTitle()==="Header"||!W2._bInternalVisible)?false:true;});var k;for(var i=0;i<j.length;i++){var x=j[i];var U2=x.getId();var V2=$.getSelectedSection();if(U2===V2){k=(e)?j[(i+1===j.length)?0:i+1]:j[(i===0)?j.length-1:i-1];var g1=k.getId();$.setSelectedSection(g1);k2();break;}}}function k2(){Z.stateChanged();}function l2(e,i,j,k,x){var U2=A.createP13NColumnKey(x);var V2=A.getBindingForHiddenPath(x);if(V2==="{= !${} }"){e.push(U2);}if(typeof(V2)==="string"){var W2=V2.match(T)&&V2.match(T)[0];if(W2&&W2.indexOf("/")>0&&k.navigationProperty){var X2=Y.getOwnerComponent().getEntitySet();var Y2=W2.split("/",1)[0];if(j.getODataAssociationSetEnd(k,Y2).entitySet===X2){i[U2]=W2.split("/").slice(1).join("/");}}}else if(!V2){e.push(U2);}}function m2($){var e=$.getModel("ui");var i=X.oComponentUtils.getTemplatePrivateModel();var j=i.getProperty("/objectPage/displayMode");var k=e.getProperty("/createMode")||j===4;var x=e.getProperty("/editable")||j===2;var U2;if(k){U2="Create";}else if(x){U2="Edit";}else{U2="Display";}return U2;}function n2($,e){if(e==="Display"){var j=$.getHeaderTitle();var k=j.getActions();if(k&&k.length){for(var i=0;i<k.length;i++){if(k[i].getVisible&&k[i].getVisible()&&k[i].getEnabled&&k[i].getEnabled()){return k[i];}}}}else{var x=$.getSelectedSection();var U2=$.getUseIconTabBar();if(c1===true&&U2!==true){$.setSelectedSection(null);return v($.getDomRef());}var V2;var W2=function(Z2){var $2=Z2.getDomRef();$.setSelectedSection(Z2);V2=v($2);if(V2&&V2.type!=="checkbox"){return V2;}return w($2).firstFocusableDomRef();};var X2=$.getSections();var Y2;for(var i=0;i<X2.length;i++){if(X2[i].getVisible()&&((X2[i].getId()===x)||Y2)){Y2=X2[i+1]?X2[i+1].getId():undefined;V2=W2(X2[i]);if(V2){break;}}}return V2;}}function o2($){var e=Y.getOwnerComponent().getModel("_templPrivGlobal");var e1=e.getProperty("/generic/FCL/FCLActionButton");if(!e1){var i=m2($);if(document.readyState=='complete'){setTimeout(function(){var j=n2($,i);if(j){j.focus();}},0);}}}function p2(e,j,k,x,U2,V2){var W2=[];var X2=Object.create(null);for(var i=0;i<V2.length;i++){var Y2=V2[i];l2(W2,X2,x,U2,Y2);}if(!u(X2)||W2.length){j.columnHideInfos={staticHiddenColumns:W2,columnKeyToHiddenPath:X2};k.push("smartTableWithColumnHide");}}function q2(e){return e instanceof O?e:e.getParent&&q2(e.getParent());}function r2(e,j,k){j.push("smartTable");e.subSection=q2(k);if(k.getUseVariantManagement()){j.push("smartControlWithVariantManagement");b2(e.subSection).loadingStrategy.waitFor.bStateApplied=true;e.afterVariantInitialisePromise=new Promise(function(Y2){e.afterVariantInitialiseResolve=Y2;});}k=X.oCommonUtils.isMTable(k)?k.getParent():k;var x=Y.getOwnerComponent().getModel().getMetaModel();var U2=x.getODataEntitySet(k.getEntitySet());var V2=x.getODataEntityType(U2.entityType);var W2=V2["com.sap.vocabularies.UI.v1.LineItem"];var X2=k.getCustomData();for(var i=0;i<X2.length;i++){if(X2[i].getKey()==="lineItemQualifier"){W2=V2["com.sap.vocabularies.UI.v1.LineItem#"+X2[i].getValue()];break;}}p2(k,e,j,x,V2,W2||[]);}function s2(e){return X.oCommonUtils.getControlInformation(e,r2);}function t2(e){var i;var j=e.getSource();if(X.oCommonUtils.isSmartTable(j)){i=s2(j);}else if(X.oCommonUtils.isSmartChart(j)){i=v2(j);}if(!k1&&!i.afterVariantInitalisedResolve&&!i.bApplyingVariantFromState){Z.stateChanged();}}function u2(e,i,j){i.push("smartChart");if(j&&j.getUseVariantManagement()){i.push("smartControlWithVariantManagement");e.afterVariantInitialisePromise=new Promise(function(k){e.afterVariantInitialiseResolve=k;});}}function v2(e){return X.oCommonUtils.getControlInformation(e,u2);}function w2(e,i,j){i.push("searchField");var k=X.oCommonUtils.isMTable(j.getParent().getParent())?j.getParent().getParent().getParent():j.getParent().getParent();e.table=k;var x=s2(k);x.searchField=j;}function x2(e){return X.oCommonUtils.getControlInformation(e,w2);}function y2(e){x2(e);}function z2(e){var i=x2(e);i.searchString=e.getSource().getValue();i.table.rebindTable();}function A2(e,i){i.setValue("");if(e.searchString){e.searchString="";e.table.rebindTable();}}function B2(){X.oCommonUtils.executeForAllInformationObjects("searchField",A2);}function C2(e,i){var j=e.getPath();var k=true;for(var x=0;k;x++){var U2=i.getContextByIndex(x);var V2=U2&&U2.getPath();if(V2===j){return x;}else if(!U2){return-1;}}}function D2(e,j){var k=j.getFirstVisibleRow();var x=j.getVisibleRowCount();var U2=e.getPath();for(var i=0;i<x;i++){if(j.getContextByIndex(k+i).getPath()===U2){return j.getRows()[i];}}}function E2(e,i){var j=e.getTable();if(X.oCommonUtils.isMTable(j)){return;}function k(){var x=C2(i,j);if(x!==-1){j.setFirstVisibleRow(x);setTimeout(function(){var U2=D2(i,j);var V2=U2&&v(U2.getDomRef());if(V2){V2.focus();}},0);}}e.attachEventOnce("dataReceived",k);}function F2(e,i){X.oCommonEventHandlers.addEntry(e,true).then(E2.bind(null,i));}t.testable(E2,"setFocusOnTableRow");t.testable(D2,"getGridTableRow");t.testable(C2,"getGridTableRowIndexFromContext");function G2(e,i){var j=X.oCommonUtils.getOwnerControl(i);j=X.oCommonUtils.isMTable(j)?j.getParent():j;var k=N(j);if(!k){c1=false;d1=true;}if(!i.data("CrossNavigation")&&k){F2(i,j);return;}X.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){X.oCommonEventHandlers.addEntry(i,false);},Function.prototype,Z.state);}function H2(e){var i=p.getStableId({type:"ObjectPageAction",subType:"Create",sFacet:e});var j=p.getStableId({type:"ObjectPageAction",subType:"CreateWithDialog",sFacet:e});if(j&&Y.byId(j)){var k=Y.getOwnerComponent().mProperties&&Y.getOwnerComponent().mProperties.sections[e];var x=k&&k.tableSettings&&k.tableSettings.createWithParameterDialog&&k.tableSettings.createWithParameterDialog.fields;}if(!!x&&!u(x)){X.oCommonUtils.executeIfControlReady(b1.createWithDialogInOP.bind(null,Y.byId(j)),i);}else{X.oCommonUtils.executeIfControlReady(G2.bind(null,undefined),i);}}function I2(e,i){var j=i.getId();if(!f1[j]){var k=i.getDependents();k.some(function(U2){if(U2 instanceof D){f1[j]=U2;return true;}});}var x=$.getModel("ui");return x.getProperty("/editable");}function J2(){var e=Y.getOwnerComponent().getModel("ui");e.bindProperty("/editable").attachChange(function(){var i=f1;f1=Object.create(null);for(var k in i){var j=i[k];j.refresh();}});}function K2(e){var i=e.getId();var j="";var k={search:false,filter:false};var x=e.fetchVariant();if(x&&x.filter&&x.filter.filterItems.length>0){k.filter=true;}var U2=e.getToolbar().getContent().filter(function(V2){return V2.sId===e.getToolbar().getId()+'::SearchField';});if(U2.length>0&&U2[0].getValue().trim()!==""){k.search=true;}if(k.search||k.filter){j=X.oCommonUtils.getContextText("NOITEMS_SMARTTABLE_WITH_FILTER",i);}else{j=X.oCommonUtils.getContextText("NOITEMS_SMARTTABLE",i);}e.setNoData(j);}function L2(e){var i=[];if(e.fetchVariant()&&e.fetchVariant().filter&&e.fetchVariant().filter.filterItems){i=e.fetchVariant().filter.filterItems;}var j=e.getId();var k="";var x={search:false,filter:false};if(i&&i.length){x.filter=true;}var U2=e.getToolbar().getContent().filter(function(V2){return V2.sId===e.getToolbar().getId()+'::SearchField';});if(U2.length>0&&U2[0].getValue().trim()!==""){x.search=true;}if(x.search||x.filter){k=X.oCommonUtils.getContextText("NOITEMS_SMARTCHART_WITH_FILTER",j);}else{k=X.oCommonUtils.getContextText("NOITEMS_SMARTCHART",j);}e.getChartAsync().then(function(V2){V2.setCustomMessages({NO_DATA:k});});}W.refreshFacets=function(e){var i=function(j){var k=b2(j);k.refresh(e,false);};$.getSections().forEach(function(j){j.getSubSections().forEach(i);});};W.onComponentActivate=Z.onComponentActivate;W.getCurrentState=function(){var e=Object.create(null);if(g1){e.section={data:g1,lifecycle:{permanent:true,pagination:true}};}if(i1){e.subSection={data:i1,lifecycle:{permanent:true,pagination:true}};}var i={};X.oCommonUtils.executeForAllInformationObjects("smartControlWithVariantManagement",function(V2,W2){i[W2.getId()]=W2.getCurrentVariantId();});if(!u(i)){e.smartControlVariants={data:i,lifecycle:{session:true,permanent:true,page:false,pagination:false}};}e.sideContent=_.getCurrentState();e.multipleViews=a1.getCurrentState();var j=Object.create(null);Y.provideCustomStateExtension(j);for(var k in j){e["$custom$"+k]=j[k];}var x=true;var U2=function(V2,W2){if(!(V2 instanceof C)){throw new y(B,"State must always be set with respect to a ControllerExtension");}if(!x){throw new y(B,"State must always be provided synchronously");}var X2=V2.getMetadata().getNamespace();if(W2){for(var Y2 in W2){e["$extension$"+X2+"$"+Y2]=W2[Y2];}}};Y.templateBaseExtension.provideExtensionStateData(U2);x=false;return e;};function M2(){l1={bLayoutFinished:false,bStateApplied:false,bRebindCompleted:false};m1=true;}function N2(e){l1[e]=true;P2();}function O2(e){var i=true;for(var j in e.waitFor){if(e.waitFor[j]&&!l1[j]){i=false;break;}}return i;}function P2(){var e=m1?"subSectionNotWaitingForViewPort":"subSection";X.oCommonUtils.executeForAllInformationObjects(e,function(i,j){var k=O2(i.loadingStrategy);if(k){i.loadingStrategy.activeHandler(j,i);}});if(m1){$._triggerVisibleSubSectionsEvents();}}function Q2(){if(k1){k1();k1=null;N2("bStateApplied");}}function R2(){N2("bLayoutFinished");}function S2(){J($);R2();}W.applyState=function(I,e){var k=X.oComponentUtils.getHeaderDataAvailablePromise()||Promise.resolve();k.then(function(){var U2=null;var V2=Object.create(null);var W2=Object.create(null);for(var X2 in I){if(X2.indexOf("$custom$")===0){V2[X2.substring(8)]=I[X2];}else if(X2.indexOf("$extension$")===0){var Y2=X2.substring(11,X2.indexOf("$",11));var Z2=W2[Y2];if(!Z2){Z2=Object.create(null);W2[Y2]=Z2;}var $2=X2.substring(X2.indexOf("$",11)+1,X2.length);Z2[$2]=I[X2];}}Y.applyCustomStateExtension(V2,e);var _2=true;var a3=function(h3){if(!(h3 instanceof C)){throw new y(B,"State must always be retrieved with respect to a ControllerExtension");}if(!_2){throw new y(B,"State must always be restored synchronously");}var Y2=h3.getMetadata().getNamespace();return W2[Y2];};Y.templateBaseExtension.restoreExtensionStateData(a3,e);_2=false;var b3=Y.getOwnerComponent();var c3=b3.getAppComponent().getObjectPageHeaderType();var d3=b3.getModel("_templPrivGlobal");e1=d3.getProperty("/generic/FCL/FCLActionButton");if(e1===1){var e3=$.getHeaderTitle();var f3=(c3==="Dynamic"?e3.getNavigationActions():e3.getActions());if(f3&&f3.length){for(var i=0;i<f3.length;i++){if(f3[i].getId&&f3[i].getId().indexOf("template::FCLActionButtons")>0){var g3=f3[i].getItems();for(var j=0;j<g3.length;j++){if((g3[j].getId().toUpperCase().indexOf("FULLSCREEN")>0)&&g3[j].getVisible&&g3[j].getVisible()){U2=g3[j];}}}}}setTimeout(function(){d3.setProperty("/generic/FCL/FCLActionButton",0);e1=d3.getProperty("/generic/FCL/FCLActionButton");if(U2){U2.focus();}},0);}});_.applyState(I.sideContent,e);a1.applyState(I.multipleViews,e);X.oCommonUtils.executeForAllInformationObjects("smartControlWithVariantManagement",function(i,j){var U2;if(I.smartControlVariants&&I.smartControlVariants[j.getId()]!==undefined){U2=I.smartControlVariants[j.getId()];}else{if(X.oCommonUtils.isSmartTable(j)){U2=X.oCommonUtils.getSmartTableDefaultVariant(j);}else if(X.oCommonUtils.isSmartChart(j)){U2=X.oCommonUtils.getSmartChartDefaultVariant(j);}}i.afterVariantInitialisePromise.then(function(){if(j.getCurrentVariantId()!==U2||!e){i.bApplyingVariantFromState=true;j.setCurrentVariantId(U2);i.bApplyingVariantFromState=false;}});});if(e){if(g1!==(I.section||"")){Z.stateChanged();}Q2();R2();return;}B2();if(I.section){g1=I.section;L.info("Restoring Selected Section: "+g1,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");$.setSelectedSection(g1);if(I.subSection){var x;h1.some(function(i){if(i.getId()===I.subSection){x=i;return true;}return false;});if(x){x.getParent().setSelectedSubSection(x);}i1=I.subSection;L.info("Restoring Selected Subsection: "+i1,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");}R2();}else{Promise.all([k,X.oComponentUtils.getNavigationFinishedPromise()]).then(S2);g1="";}Q2();};W.beforeRebind=function(e){M2();e.then(function(){N2("bRebindCompleted");});if(!k1){j1=new Promise(function(i){k1=i;});}X.oCommonUtils.executeForAllInformationObjects("subSection",function(i,j){i.loadingStrategy.inActiveHandler(j);});};W.afterRebind=function(){L.info("Call of _triggerVisibleSubSectionsEvents","","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation (afterRebind)");$._triggerVisibleSubSectionsEvents();};W.applyHeaderContextToSmartTablesDynamicColumnHide=function(e){var i=e.getModel();var j=function(k,x,U2){if(u(x.columnHideInfos.columnKeyToHiddenPath)){return;}var V2=x.columnHideInfos.staticHiddenColumns.slice();var W2=k&&j.bind(null,false,x,U2);for(var X2 in x.columnHideInfos.columnKeyToHiddenPath){var Y2=x.columnHideInfos.columnKeyToHiddenPath[X2];if(e.getProperty(Y2)){V2.push(X2);}if(W2){var Z2=i.bindProperty(Y2,e);Z2.attachChange(W2);}}U2.deactivateColumns(V2);};X.oCommonUtils.executeForAllInformationObjects("smartTableWithColumnHide",j.bind(null,true));};var G1=t.testable(G1,"editEntity");var I1=t.testable(I1,"isEntryDeletable");var o1=t.testable(o1,"onActivateImpl");var p1=t.testable(p1,"onSaveImpl");t.testable(function(){return j1;},"getStateAppliedPromise");var T2={onInit:function(){$=Y.byId("objectPage");J2();var e=Y.getOwnerComponent();j1=new Promise(function(a3){k1=a3;});M2();var i=$.getSections();for(var k=0;k<i.length;k++){var j=i[k];var h1=j.getSubSections();h1.forEach(c2);}var x=u1();var U2=e.getAppComponent();var V2=U2.getObjectPageHeaderType()==="Dynamic";W.aBreadCrumbs=x&&(V2?x.getBreadcrumbs().getLinks():x.getBreadCrumbsLinks());if(V2){O1();}var W2=function(){m1=false;P2();};Z.onInit(null,W2,V1,S1);P1();X.oCommonUtils.executeGlobalSideEffect();$.attachEvent("subSectionEnteredViewPort",function(a3){var b3=a3.getParameter("subSection");L.info("Viewport entered ","Subsection: "+b3.getId(),"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");var c3=b2(b3);var d3=c3.loadingStrategy;var e3=O2(c3.loadingStrategy);if(e3){d3.activeHandler(b3,c3);}});b1=new z(I,Y,X);I.oCreateWithDialogHandler=b1;a1=new l(Y,X,Z.stateChanged);I.oMultipleViewsHandler=a1;var X2=X.oComponentUtils.getTemplatePrivateModel();X2.setProperty("/objectPage/aPasteAttachedTables",[]);X.oComponentUtils.attach(Y,"PageDataLoaded",function(a3){if($&&!e1){var b3=m2($);if(b3==="Create"&&d1!==true){c1=true;}else if((X.oComponentUtils.isDraftEnabled()&&b3==="Create"&&d1===true)||(!X.oComponentUtils.isDraftEnabled()&&b3==="Display"&&d1===true)){d1=false;}o2($);}});var Y2=X.oComponentUtils.getParameterModelForTemplating().getObject("/templateSpecific/sections");for(var Z2 in Y2){switch(Y2[Z2].annotation){case"com.sap.vocabularies.UI.v1.LineItem":var $2=Y.byId(p.getStableId({type:"ObjectPageTable",subType:"SmartTable",sFacet:Y2[Z2].facetId}));if($2){s2($2);}break;case"com.sap.vocabularies.UI.v1.Chart":var _2=Y.byId(Y2[Z2].facetId+"::Chart");if(_2){v2(_2);}break;}}},handlers:{onEditAndActiveToggle:function(e,i){X.oServices.oApplication.performAfterSideEffectExecution(function(){var j=X.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=e.getBindingContext();var x=X.oServices.oApplication.getDraftSiblingPromise(k);j.setBusy(x.then(function(U2){if(i){L.info("Navigating to draft entity","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");E1(U2,true);}else{L.info("Navigating to active entity","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");X.oServices.oApplication.navigateToSubContext(U2,true,1);}g(':focus').blur();}));});},onAfterVariantInitialise:function(e){var i=e.getSource();var j;if(X.oCommonUtils.isSmartTable(i)){j=s2(i);}else if(X.oCommonUtils.isSmartChart(i)){j=v2(i);}if(j.afterVariantInitialiseResolve){j.afterVariantInitialiseResolve();delete j.afterVariantInitialiseResolve;}},onAfterVariantSave:function(e){t2(e);},onAfterVariantApply:function(e){t2(e);},addEntry:H2,onCancelCreateWithPopUpDialog:function(){b1.onCancelPopUpDialog();},onSaveCreateWithPopUpDialog:function(e){b1.onSavePopUpDialog(e);},submitChangesForSmartMultiInput:function(){if(X.oComponentUtils.isDraftEnabled()){X.oCommonEventHandlers.submitChangesForSmartMultiInput();}},contextEditableChanged:function(e){var i=e.getSource();var j=i.getBindingInfo('editable');if(j&&j.binding&&j.binding.getValue&&!j.binding.getValue()){i.setEditable(false);}},deleteEntry:function(e){var i=e.getParameter('listItem');var j=i.getBindingContext();var k=X.oCommonUtils.getOwnerControl(e.getSource());if(!X.oCommonUtils.isSmartTable(k)){k=k.getParent();}var x=[j];var U2=e.getSource().getId();M1(k,x,U2);},deleteEntries:function(e){var i=p.getStableId({type:"ObjectPageAction",subType:"Delete",sFacet:e});X.oCommonUtils.executeIfControlReady(L1,i);},onSelectionChange:function(e){X.oCommonUtils.setEnabledToolbarButtons(e.getSource());},onMultiSelectionChange:function(e){X.oCommonEventHandlers.onMultiSelectionChange(e);},onCancel:function(e){var i=e.getSource();var j=Z.state.onCancel(i);j.then(function(){C1();if(!X.oComponentUtils.isDraftEnabled()){o2($);}});},onContactDetails:function(e){X.oCommonEventHandlers.onContactDetails(e);},onSmartFieldInitialise:function(e){var i=this.getView().getId();X.oCommonEventHandlers.onSmartFieldInitialise(e,i);},onPressDraftInfo:function(e){var i=Y.getView().getBindingContext();var j=sap.ui.getCore().byId(e.getSource().getId()+(e.getId()==="markChangesPress"?"-changes":"-lock"));X.oCommonUtils.showDraftPopover(i,j);},onPressDraftInfoObjectPageDynamicHeaderTitle:function(e){var i=Y.getView().getBindingContext();var j=Y.byId("template::ObjectPage::ObjectMarkerObjectPageDynamicHeaderTitle");X.oCommonUtils.showDraftPopover(i,j);},onShareObjectPageActionButtonPress:function(e){X.oCommonUtils.executeIfControlReady(v1,"template::Share");},onRelatedApps:function(e){var x,U2,V2,W2,X2,Y2,Z2;var $2,_2,a3,b3,c3;var d3=[];x=e.getSource();a3=sap.ushell&&sap.ushell.Container;U2=a3&&a3.getService("URLParsing");V2=U2.parseShellHash(document.location.hash);b3=V2.semanticObject;c3=V2.action;W2=Y.getView&&Y.getView().getBindingContext();var e3=X.oComponentUtils.getSettings();var f3=Y.getOwnerComponent().getModel().getMetaModel();var g3=W2.getObject();var h3=g3.__metadata.type;var i3=f3.getODataEntityType(h3);var j3=i3["com.sap.vocabularies.Common.v1.SemanticKey"];var k3={};if(j3&&j3.length>0){for(var j=0;j<j3.length;j++){var l3=j3[j].PropertyPath;if(!k3[l3]){k3[l3]=g3[l3];}}}else{for(var k in i3.key.propertyRef){var m3=i3.key.propertyRef[k].name;if(!k3[m3]){k3[m3]=g3[m3];}}}X2=Y.getOwnerComponent().getAppComponent();Y2=a3&&a3.getService("CrossApplicationNavigation");if(e3.relatedAppsSettings&&Object.keys(e3.relatedAppsSettings).length>0){var n3=[{semanticObject:b3}];d3.push(n3);for(var i=0;i<Object.keys(e3.relatedAppsSettings).length;i++){if(e3.relatedAppsSettings[i].semanticObject!==b3){n3=[{semanticObject:e3.relatedAppsSettings[i].semanticObject}];d3.push(n3);}}Z2=Y2.getLinks(d3);}else{Z2=Y2.getLinks({semanticObject:b3,params:k3,ui5Component:X2});}w1().then(function(o3){$2=o3;_2=$2.getModel("buttons");_2.setProperty("/buttons",[]);$2.openBy(x);Z2.done(function(p3){var q3=[],r3=[],s3;var t3=i3["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"];var u3=[];if(t3){for(var i=0;i<t3.length;i++){u3.push(t3[i].String);}}for(var i=0;i<i3.property.length;i++){if(i3.property[i]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]){var v3=i3.property[i]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"].length;for(var j=0;j<v3;j++){u3.push(i3.property[i]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"][j].String);}}}s3=X.oComponentUtils.getSettings().relatedAppsSettings;if(s3&&Object.keys(s3).length>0){for(var i=0;i<p3.length;i++){for(var j=0;j<p3[i].length;j++){for(var k=0;k<p3[i][j].length;k++){r3.push(p3[i][j][k]);}}}p3=r3;}p3.sort(function(A3,B3){if(A3.text<B3.text){return-1;}if(A3.text>B3.text){return 1;}return 0;});for(var i=0;i<p3.length;i++){var w3=p3[i];var x3=w3.intent;var y3=x3.split("-")[0].split("#")[1];var z3=x3.split("-")[1].split("?")[0];if((y3===b3?z3!==c3:true)&&u3.indexOf(z3)==-1){q3.push({enabled:true,text:w3.text,link:w3,param:k3});}}if(q3.length===0){q3.push({enabled:false,text:X.oCommonUtils.getText("NO_RELATED_APPS")});}_2.setProperty("/buttons",q3);});});},onEdit:function(e){var j=Y.byId("edit");var $=Y.byId("objectPage");var k=$.getSelectedSection();var x=$.getSections()||[];for(var i=0;i<x.length;i++){if(x[i].getVisible()&&x[i]._bInternalVisible!==false){if(x[i].getId()===k){c1=true;}else{c1=false;}break;}}if(j.data("CrossNavigation")){X.oCommonEventHandlers.onEditNavigateIntent(j);return;}X.oCommonUtils.executeIfControlReady(G1,"edit");},onSave:s1,onSaveAndContinueEdit:r1,onSmartFieldUrlPressed:function(e){X.oCommonEventHandlers.onSmartFieldUrlPressed(e,Z.state);},onBreadCrumbUrlPressed:Q1,onDelete:D1,onCallActionFromToolBar:function(e){X.oCommonEventHandlers.onCallActionFromToolBar(e,Z.state);},onCallAction:function(e,i,j){X.oServices.oApplication.performAfterSideEffectExecution(function(){var k=Y.getView().getBindingContext();if(k){X.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var x=Y.getOwnerComponent();var U2=x.getEntitySet();var V2={functionImportPath:e,contexts:[k],sourceControl:"",label:i,operationGrouping:j};X.oServices.oCRUDManager.callAction(V2).then(function(W2){var X2=W2&&W2[0];if(X2&&X2.response&&X2.response.context&&(!X2.actionContext||X2.actionContext&&X2.response.context.getPath()!==X2.actionContext.getPath())){X.oServices.oViewDependencyHelper.setParentToDirty(x,U2,1);}});},Function.prototype,Z.state,"Proceed");}},true);},onDataFieldForIntentBasedNavigation:function(e){e=n({},e);X.oServices.oApplication.performAfterSideEffectExecution(function(){X.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){X.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(e,Z.state);});},true);},onDataFieldWithIntentBasedNavigation:function(e){X.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(e,Z.state);},onDataFieldWithNavigationPath:function(e){X.oCommonEventHandlers.onDataFieldWithNavigationPath(e);},onChartInit:function(e){var i=e.getSource();v2(i);i.getChartAsync().then(function(j){var k=Y._templateEventHandlers.onSelectionChange;j.attachSelectData(k).attachDeselectData(k);X.oCommonUtils.checkToolbarIntentsSupported(i);});},onDataRequested:function(i){L.info("Data requested","SmartTable: "+i,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");a1.onDataRequested(i);},onDataReceived:function(e){X.oCommonEventHandlers.onDataReceived(e);},onBeforeRebindDetailTable:function(e){var i=e.getSource();e.mParameters.bindingParams.events["dataReceived"]=K2.bind(null,i);i.setNoData(X.oCommonUtils.getText("WAITING_SMARTTABLE"));var j=n1(e);var k=s2(i);var x=k.searchField;if(x){var U2=X.oCommonUtils.getControlInformation(x);if(U2.searchString){j.parameters.custom={search:U2.searchString};}}X.oCommonEventHandlers.onBeforeRebindTable(e,{ensureExtensionFields:Y.templateBaseExtension.ensureFieldsForSelect,addExtensionFilters:Y.templateBaseExtension.addFilters,isFieldControlRequired:true});Y.onBeforeRebindTableExtension(e);a1.onRebindContentControl(i.getId(),j);t1(e);if(X.oCommonUtils.isAnalyticalTable(i.getTable())){j.parameters.entitySet=i.getEntitySet();}},onListNavigate:function(e){X.oCommonEventHandlers.onListNavigate(e,Z.state);},onBeforeSemanticObjectLinkPopoverOpens:function(e){var i=e.getParameters();var j=H1();X.oCommonUtils.semanticObjectLinkNavigation(i,j,Y);},onBeforeSemanticObjectLinkNavigationCallback:function(){return new Promise(function(e){X.oServices.oDataLossHandler.performIfNoDataLoss(function(){e(true);},function(){e(false);});});},onSemanticObjectLinkNavigationPressed:function(e){var i=e.getParameters();var j=e.getSource();X.oCommonEventHandlers.onSemanticObjectLinkNavigationPressed(j,i);},onSemanticObjectLinkNavigationTargetObtained:function(e){var i=e.getParameters();var j=e.getSource();X.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(j,i,Z.state);},onSemanticObjectLinkNavigationTargetObtainedSmartLink:function(e){var i,j;i=e.getParameters();j=e.getSource();j=j.getParent().getParent().getParent().getParent();X.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(j,i,Z.state);},onHeaderImagePress:function(e){if(e.getSource().getSrc()===""){return;}var i=e.getSource().getId();var j=e.getSource().getSrc();N1().then(function(k){k.addAriaLabelledBy(i);var x=k.getModel("headerImage");x.setProperty("/src",j);if(sap.ui.Device.system.phone){k.setProperty("stretch",true);}k.open();});},sectionChange:k2,onSwitchTabs:j2,onInlineDataFieldForAction:function(e){X.oCommonEventHandlers.onInlineDataFieldForAction(e,Z.state);},onInlineDataFieldForIntentBasedNavigation:function(e){X.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(e.getSource(),Z.state);},onDeterminingDataFieldForAction:function(e){X.oCommonEventHandlers.onDeterminingDataFieldForAction(e);},onBeforeRebindChart:function(e){n1(e);var i=e.getSource();L2(i);i.getChartAsync().then(function(k){i.oModels=k.oPropagatedProperties.oModels;});var j={ensureExtensionFields:Function.prototype,addExtensionFilters:Y.templateBaseExtension.addFilters,isFieldControlRequired:true};X.oCommonUtils.onBeforeRebindTableOrChart(e,j);},onToggleDynamicSideContent:_.onToggleDynamicSideContent,sideContentBreakpointChanged:_.sideContentBreakpointChanged,onTableInit:function(e,i){var j=e.getSource();j.setEnableDataStateFiltering(true);var k=j.getTable();var x=s2(j);if(x.columnHideInfos){j.deactivateColumns(x.columnHideInfos.staticHiddenColumns);}X.oCommonUtils.checkToolbarIntentsSupported(j);$.attachEvent("subSectionVisibilityChange",function(e){if(k.isA("sap.m.Table")||k.isA("sap.ui.table.Table")){i2(j,k,i);}});if(N(j)&&!j.data("CrossNavigation")){k.addEventDelegate({onkeyup:function(e){if(e.ctrlKey&&e.keyCode===K.ENTER&&j.getEditable()){F2(j,j);e.preventDefault();e.setMarked();}}});}var U2=X.oComponentUtils.getTemplatePrivateModel();if(N(j)){k.addEventDelegate({onAfterRendering:function(e){var V2;if(j.getEditable()&&!j.hasListeners("paste")){j.attachBeforePaste(A1);j.attachPaste(B1);V2=U2.getProperty("/objectPage/aPasteAttachedTables");if(V2){V2.push(i);}}}});}},onPasteButtonPress:function(e){var i=X.oCommonUtils.getText("DATA_PASTE_ACTION_MESSAGE");M.information(i);},onSearchObjectPage:z2,onSearchLiveChange:y2,onSmartTablePaste:B1,onUITableExpand:f2,onSingleSectionOrSubsectionVisible:e2,dataStateFilter:I2},formatters:{sideContentActionButtonText:_.formatSideContentActionButtonText,setNoDataTextForSmartTable:function(e){if(X.oCommonUtils&&e){var i=X.oCommonUtils.getContextText("WAITING_SMARTTABLE",e);if(i!=="WAITING_SMARTTABLE"){return i;}return"";}},setVMVisibilityForVendor:function(){var e=new U(window.location.href);if(e.mParams["sap-ui-layer"]){var j=e.mParams["sap-ui-layer"];for(var i=0;i<j.length;i++){if(j[i].toUpperCase()==="VENDOR"){return true;}}}return false;},formatItemTextForMultipleView:function(i){return i&&a1?a1.formatItemTextForMultipleView(i):"";}},extensionAPI:new E(X,Y,Z,I)};T2.handlers=s(Z.handlers,T2.handlers);return T2;}};return V;});
