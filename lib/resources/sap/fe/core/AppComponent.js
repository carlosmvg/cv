/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2020 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/core/UIComponent","sap/m/NavContainer","sap/f/FlexibleColumnLayout","sap/fe/core/controllerextensions/Routing","sap/fe/core/RouterProxy","sap/fe/core/AppStateHandler","sap/base/Log","sap/base/util/merge","sap/fe/core/controllerextensions/EditFlow"],function(U,N,F,R,a,A,L,m,E){"use strict";var b={FCL:{VIEWNAME:"sap.fe.templates.RootContainer.view.Fcl",ROUTERCLASS:"sap.f.routing.Router"},NAVCONTAINER:{VIEWNAME:"sap.fe.templates.RootContainer.view.NavContainer",ROUTERCLASS:"sap.m.routing.Router"}};var c=U.extend("sap.fe.core.AppComponent",{metadata:{config:{fullWidth:true},manifest:{"sap.ui5":{services:{resourceModel:{factoryName:"sap.fe.core.services.ResourceModelService","startup":"waitFor","settings":{"bundles":["sap.fe.core.messagebundle"],"modelName":"sap.fe.i18n"}},draftModelService:{"factoryName":"sap.fe.core.services.DraftModelService","startup":"waitFor"},routingService:{factoryName:"sap.fe.core.services.RoutingService","startup":"waitFor"},shellServices:{factoryName:"sap.fe.core.services.ShellServices",startup:"waitFor"},ShellUIService:{factoryName:"sap.ushell.ui5service.ShellUIService"},navigationService:{factoryName:"sap.fe.core.services.NavigationService",startup:"waitFor"},asyncComponentService:{factoryName:"sap.fe.core.services.AsyncComponentService","startup":"waitFor"}},rootView:{viewName:b.NAVCONTAINER.VIEWNAME,type:"XML",async:true,id:"appRootView"},routing:{config:{controlId:"appContent",routerClass:b.NAVCONTAINER.ROUTERCLASS,viewType:"XML",controlAggregation:"pages",async:true,containerOptions:{propagateModel:true}}}}},designtime:"sap/fe/core/designtime/AppComponent.designtime",library:"sap.fe.core"},_oRouterProxy:null,_isFclEnabled:function(){var M=this.getMetadata().getManifestEntry("/sap.ui5",true);return b.FCL.VIEWNAME===M.rootView.viewName;},getRouterProxy:function(){return this._oRouterProxy;},getAppStateHandler:function(){return this._oAppStateHandler;},getRootViewController:function(){return this.getRootControl().getController();},getRootContainer:function(){return this.getRootControl().getContent()[0];},init:function(){this.bInitializeRouting=true;this._oRouting=new R();this._oRouterProxy=new a();this._oAppStateHandler=new A();var t=this;var M=this.getModel();if(M){M.getMetaModel().requestObject("/$EntityContainer/").catch(function(e){var r=this.getRootContainer(),d=sap.ui.getCore().getLibraryResourceBundle("sap.fe.core");t._oRouting.navigateToMessagePage(d.getText("C_APP_COMPONENT_SAPFE_APPSTART_TECHNICAL_ISSUES"),{title:d.getText("C_COMMON_SAPFE_ERROR"),description:e.message,navContainer:r});}.bind(this));}var o=this.getMetadata().getManifestEntry("/sap.ui5",true);if(o.rootView.viewName===b.FCL.VIEWNAME&&o.routing.config.routerClass===b.FCL.ROUTERCLASS){L.info('Rootcontainer: "'+b.FCL.VIEWNAME+'" - Routerclass: "'+b.FCL.ROUTERCLASS+'"');}else if(o.rootView.viewName===b.NAVCONTAINER.VIEWNAME&&o.routing.config.routerClass===b.NAVCONTAINER.ROUTERCLASS){L.info('Rootcontainer: "'+b.NAVCONTAINER.VIEWNAME+'" - Routerclass: "'+b.NAVCONTAINER.ROUTERCLASS+'"');}else{throw Error("\nWrong configuration for the couple (rootView/routerClass) in manifest file.\n"+"Current values are :("+o.rootView.viewName+"/"+o.routing.config.routerClass+")\n"+"Expected values are \n"+"\t - ("+b.NAVCONTAINER.VIEWNAME+"/"+b.NAVCONTAINER.ROUTERCLASS+")\n"+"\t - ("+b.FCL.VIEWNAME+"/"+b.FCL.ROUTERCLASS+")");}U.prototype.init.apply(t,arguments);},onServicesStarted:function(){var t=this;if(this.bInitializeRouting){this._oRouting.initializeRouting(this).then(function(){t.getRouterProxy().init(t,t._isFclEnabled());}).catch(function(e){L.error("cannot cannot initialize routing: "+e);});if(this.getModel()){var d=this.getDraftModelService();if(d.isDraftModel()){t.setModel(d.getDraftAccessModel(),"$draft");}}if(this.getRootViewController()&&this.getRootViewController().attachShellTitleHandler){this.getRootViewController().attachShellTitleHandler();}else{this.getRootControl().attachAfterInit(function(){if(t.getRootViewController()&&t.getRootViewController().attachShellTitleHandler){t.getRootViewController().attachShellTitleHandler();}});}}},exit:function(){this._oRouting.fireOnAfterNavigation();this._oRouterProxy.exit();E.onExitApplication(this.getId());},getMetaModel:function(){return this.getModel().getMetaModel();},exitApplication:function(){this._oRouting.fireOnAfterNavigation();E.onExitApplication(this.getId());},destroy:function(){this.exitApplication();var M=this.oModels[undefined];var h=jQuery.extend({},M.oRequestor.mHeaders);U.prototype.destroy.apply(this,arguments);M.oRequestor.mHeaders=h;}});return c;});
