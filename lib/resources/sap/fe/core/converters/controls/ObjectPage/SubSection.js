sap.ui.define(["../../ManifestSettings","../../helpers/ID","../Common/Form","../Common/DataVisualization","../../helpers/ConfigurableObject","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/helpers/Key"],function(M,I,F,D,C,A,K){"use strict";var _={};var a=K.KeyHelper;var b=A.isActionNavigable;var g=A.getEnabledBinding;var c=A.getActionsFromManifest;var P=C.Placement;var d=C.insertCustomElements;var e=D.getDataVisualizationConfiguration;var f=F.isReferenceFacet;var h=F.createFormDefinition;var S=I.SubSectionID;var j=I.FormID;var k=I.CustomSubSectionID;var l=M.SectionType;var m=M.ActionType;function o(i,E){var G=Object.keys(i);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(i);if(E)H=H.filter(function(J){return Object.getOwnPropertyDescriptor(i,J).enumerable;});G.push.apply(G,H);}return G;}function n(E){for(var i=1;i<arguments.length;i++){var G=arguments[i]!=null?arguments[i]:{};if(i%2){o(Object(G),true).forEach(function(H){p(E,H,G[H]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(E,Object.getOwnPropertyDescriptors(G));}else{o(Object(G)).forEach(function(H){Object.defineProperty(E,H,Object.getOwnPropertyDescriptor(G,H));});}}return E;}function p(i,E,G){if(E in i){Object.defineProperty(i,E,{value:G,enumerable:true,configurable:true,writable:true});}else{i[E]=G;}return i;}var q;(function(q){q["Unknown"]="Unknown";q["Form"]="Form";q["DataVisualization"]="DataVisualization";q["XMLFragment"]="XMLFragment";q["Placeholder"]="Placeholder";})(q||(q={}));_.SubSectionType=q;var t=["com.sap.vocabularies.UI.v1.LineItem","com.sap.vocabularies.UI.v1.PresentationVariant","com.sap.vocabularies.UI.v1.SelectionPresentationVariant"];var r=function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return i.some(function(E){var G,H;return t.indexOf(E===null||E===void 0?void 0:(G=E.Target)===null||G===void 0?void 0:(H=G.$target)===null||H===void 0?void 0:H.term)>-1;});};function s(i,E){var G=i.reduce(function(G,H){switch(H.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":G.push(H);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":if(r(H.Facets)||!H.Facets.every(function(J){return J.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet";})){H.Facets.forEach(function(J){return G.push(J);});}else{G.push(H);}break;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":break;}return G;},[]);return G.map(function(H){return w(H,E,"");});}_.createSubSections=s;var u=function(i,E){var G,H;return((G=i.ID)===null||G===void 0?void 0:G.toString())||((H=i.Label)===null||H===void 0?void 0:H.toString())||E;};function v(i,E){var G=new Array();switch(i.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":G=i.Facets.filter(function(i){return f(i);}).reduce(function(G,i){return x(G,i,E);},[]);break;case"com.sap.vocabularies.UI.v1.ReferenceFacet":G=x([],i,E);break;}return G;}function w(i,E,G){var H,J;var L=S({Facet:i});var N={id:L,key:u(i,L),title:E.getBindingExpression(i.Label),type:q.Unknown,annotationPath:E.getEntitySetBasedAnnotationPath(i.fullyQualifiedName),visible:E.getInverseBindingExpression((H=i.annotations)===null||H===void 0?void 0:(J=H.UI)===null||J===void 0?void 0:J.Hidden,true)};if(G&&G!==""){N.title=G;}var O="";switch(i.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":if(i.Facets&&r(i.Facets)){return w(i.Facets[0],E,N.title);}var Q=n({},N,{type:q.Form,formDefinition:h(i),actions:v(i,E)});return Q;case"com.sap.vocabularies.UI.v1.ReferenceFacet":if(!i.Target.$target){O="Unable to find annotationPath ".concat(i.Target.value);}else{switch(i.Target.$target.term){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":case"com.sap.vocabularies.UI.v1.PresentationVariant":case"com.sap.vocabularies.UI.v1.SelectionPresentationVariant":var R=n({},N,{type:q.DataVisualization,presentation:e({annotation:i.Target.$target,path:i.Target.value},E)});return R;case"com.sap.vocabularies.UI.v1.FieldGroup":case"com.sap.vocabularies.UI.v1.Identification":case"com.sap.vocabularies.UI.v1.DataPoint":case"com.sap.vocabularies.UI.v1.StatusInfo":case"com.sap.vocabularies.Communication.v1.Contact":var T=n({},N,{type:q.Form,formDefinition:h(i),actions:v(i,E)});return T;default:O="For ".concat(i.Target.$target.term," Fragment");break;}}break;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":O="For Reference URL Facet";break;}var U=n({},N,{text:O});return U;}_.createSubSection=w;function x(i,E,G){var H=E.Target.$target;var J={};var L=[];if(H){switch(H.term){case"com.sap.vocabularies.UI.v1.FieldGroup":L=H.Data;J=c(G.getManifestControlConfiguration(H).actions);break;case"com.sap.vocabularies.UI.v1.Identification":case"com.sap.vocabularies.UI.v1.StatusInfo":L=H;break;}}return L.reduce(function(i,N){var O,Q;switch(N.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":if(N.RequiresContext===true){throw new Error("Requires Context should not be true for form action : "+N.Label);}else{var R,T;var U=[];if(N.Mapping){U=B(N.Mapping);}i.push({type:m.DataFieldForIntentBasedNavigation,id:j({Facet:E},N),key:a.generateKeyFromDataField(N),text:N.Label,annotationPath:"",visible:G.getInverseBindingExpression((R=N.annotations)===null||R===void 0?void 0:(T=R.UI)===null||T===void 0?void 0:T.Hidden,true),press:".handlers.onDataFieldForIntentBasedNavigation($controller, '"+N.SemanticObject+"','"+N.Action+"', '"+JSON.stringify(U)+"', undefined ,"+N.RequiresContext+")",customData:"{ semanticObject: '"+N.SemanticObject+"', action: '"+N.Action+"' }"});}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":var V=G.getManifestControlConfiguration(H).actions;var W="DataFieldForAction::"+N.Action.replace(/\//g,"::");i.push({type:m.DataFieldForAction,id:j({Facet:E},N),key:a.generateKeyFromDataField(N),text:N.Label,annotationPath:"",enabled:g(N.ActionTarget,G),visible:G.getInverseBindingExpression((O=N.annotations)===null||O===void 0?void 0:(Q=O.UI)===null||Q===void 0?void 0:Q.Hidden,true),press:".editFlow.onCallAction('"+N.Action+"', { contexts: ${$view>/#fe::ObjectPage/}.getBindingContext(), invocationGrouping : '"+(N.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated")+"', label: '"+N.Label+"', model: ${$source>/}.getModel(), isNavigable: "+b(V&&V[W])+"})"});break;}i=d(i,J);return i;},i);}function y(i){var E={};Object.keys(i).forEach(function(G){return E[G]=z(i[G],G);});return E;}_.createCustomSubSections=y;function z(i,E){var G=i.position;if(!G){G={placement:P.After};}switch(i.type){case l.XMLFragment:return{id:i.id||k(E),actions:c(i.actions),key:E,title:i.title,type:q.XMLFragment,position:G,visible:i.visible,fragmentName:i.name||""};case l.Default:default:return{id:i.id||k(E),actions:c(i.actions),key:E,title:i.title,position:G,visible:i.visible,type:q.Placeholder};}}_.createCustomSubSection=z;function B(i){var E=[];i.forEach(function(G){var H={"LocalProperty":{"$PropertyPath":G.LocalProperty.value},"SemanticObjectProperty":G.SemanticObjectProperty};E.push(H);});return E;}return _;},false);
