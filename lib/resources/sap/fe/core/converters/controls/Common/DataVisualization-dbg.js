sap.ui.define(["./Table", "./Chart"], function (Table, Chart) {
  "use strict";

  var _exports = {};
  var createChartVisualization = Chart.createChartVisualization;
  var createTableVisualization = Table.createTableVisualization;
  var createDefaultTableVisualization = Table.createDefaultTableVisualization;

  var getVisualizationsFromPresentationVariant = function (presentationVariantAnnotation, visualizationPath, converterContext) {
    var visualizationAnnotations = [];
    var visualizations = presentationVariantAnnotation.Visualizations || [];
    var baseVisualizationPath = visualizationPath.split("@")[0];

    if (visualizations) {
      // Only allow one line item / chart
      var hasLineItem = false;
      var hasChart = false;
      var hasVisualization = false; // used to allow only first visualization in OP

      visualizations.forEach(function (visualization) {
        switch (visualization.$target.term) {
          case "com.sap.vocabularies.UI.v1.LineItem":
            if (!hasLineItem) {
              if (!(converterContext.getTemplateConverterType() === "ObjectPage" && hasVisualization)) {
                visualizationAnnotations.push({
                  visualization: visualization.$target,
                  annotationPath: "".concat(baseVisualizationPath).concat(visualization.value)
                });
                hasLineItem = true;
                hasVisualization = true;
              }
            }

            break;

          case "com.sap.vocabularies.UI.v1.Chart":
            if (!hasChart && sap.ui.Device && sap.ui.Device.system.desktop && (converterContext.getTemplateConverterType() === "AnalyticalListPage" && !converterContext.getManifestWrapper().getViewConfiguration() || converterContext.getTemplateConverterType() === "ObjectPage" && !hasVisualization)) {
              visualizationAnnotations.push({
                visualization: visualization.$target,
                annotationPath: "".concat(baseVisualizationPath).concat(visualization.value)
              });
              hasChart = true;
              hasVisualization = true;
            }

            break;
        }
      });
    }

    return visualizationAnnotations;
  };

  function isPresentationCompliant(presentationVariant) {
    return presentationVariant && presentationVariant.Visualizations && !!presentationVariant.Visualizations.find(function (visualization) {
      return visualization.$target.term === "com.sap.vocabularies.UI.v1.LineItem";
    });
  }

  _exports.isPresentationCompliant = isPresentationCompliant;

  function isPresentationALPCompliant(presentationVariant) {
    var bHasTable = false,
        bHasChart = false;

    if (presentationVariant && presentationVariant.Visualizations) {
      var aVisualizations = presentationVariant.Visualizations;
      aVisualizations.map(function (oVisualization) {
        if (oVisualization.$target.term === "com.sap.vocabularies.UI.v1.LineItem") {
          bHasTable = true;
        }

        if (oVisualization.$target.term === "com.sap.vocabularies.UI.v1.Chart") {
          bHasChart = true;
        }
      });
    }

    return bHasChart && bHasTable;
  }

  _exports.isPresentationALPCompliant = isPresentationALPCompliant;

  function getDefaultLineItem(entityType) {
    var _entityType$annotatio;

    return (_entityType$annotatio = entityType.annotations.UI) === null || _entityType$annotatio === void 0 ? void 0 : _entityType$annotatio.LineItem;
  }

  _exports.getDefaultLineItem = getDefaultLineItem;

  function getDefaultChart(entityType) {
    var _entityType$annotatio2;

    return (_entityType$annotatio2 = entityType.annotations.UI) === null || _entityType$annotatio2 === void 0 ? void 0 : _entityType$annotatio2.Chart;
  }

  _exports.getDefaultChart = getDefaultChart;

  function getDefaultPresentationVariant(entityType) {
    var _entityType$annotatio3, _entityType$annotatio4;

    return (_entityType$annotatio3 = entityType.annotations) === null || _entityType$annotatio3 === void 0 ? void 0 : (_entityType$annotatio4 = _entityType$annotatio3.UI) === null || _entityType$annotatio4 === void 0 ? void 0 : _entityType$annotatio4.PresentationVariant;
  }

  _exports.getDefaultPresentationVariant = getDefaultPresentationVariant;

  function getDataVisualizationConfiguration(visualization, converterContext) {
    var visualizationAnnotations = [];
    var presentationVariantAnnotation;
    var presentationPath = "";
    var chartVisualization, tableVisualization;
    var sTerm = visualization && visualization.annotation && visualization.annotation.term;

    if (sTerm) {
      switch (sTerm) {
        case "com.sap.vocabularies.UI.v1.LineItem":
        case "com.sap.vocabularies.UI.v1.Chart":
          visualizationAnnotations.push({
            visualization: visualization.annotation,
            annotationPath: visualization.path
          });
          break;

        case "com.sap.vocabularies.UI.v1.PresentationVariant":
          presentationVariantAnnotation = visualization.annotation;
          visualizationAnnotations = visualizationAnnotations.concat(getVisualizationsFromPresentationVariant(visualization.annotation, visualization.path, converterContext));
          break;

        case "com.sap.vocabularies.UI.v1.SelectionPresentationVariant":
          presentationVariantAnnotation = visualization.annotation.PresentationVariant; // Presentation can be inline or outside the SelectionPresentationVariant

          presentationPath = converterContext.getRelativeAnnotationPath(presentationVariantAnnotation.fullyQualifiedName, converterContext.getAnnotationEntityType(visualization.annotation));

          if (!isPresentationCompliant(presentationVariantAnnotation)) {
            var entityType = converterContext.getEntitySet().entityType;
            var defaultLineItemAnnotation = getDefaultLineItem(entityType);

            if (defaultLineItemAnnotation) {
              visualizationAnnotations.push({
                visualization: defaultLineItemAnnotation,
                annotationPath: converterContext.getRelativeAnnotationPath(defaultLineItemAnnotation.fullyQualifiedName, entityType)
              });
            }
          } else {
            visualizationAnnotations = visualizationAnnotations.concat(getVisualizationsFromPresentationVariant(presentationVariantAnnotation, visualization.path, converterContext));
          }

          break;
      }

      visualizationAnnotations.map(function (visualizationAnnotation) {
        var visualization = visualizationAnnotation.visualization,
            annotationPath = visualizationAnnotation.annotationPath;

        switch (visualization.term) {
          case "com.sap.vocabularies.UI.v1.Chart":
            chartVisualization = createChartVisualization(visualization, annotationPath, converterContext);
            break;

          case "com.sap.vocabularies.UI.v1.LineItem":
          default:
            tableVisualization = createTableVisualization(visualization, annotationPath, converterContext, presentationVariantAnnotation);
            break;
        }
      });
    } else {
      tableVisualization = [createDefaultTableVisualization(converterContext)];
    }

    var aVisualizations = [];
    var sPath = sTerm === "com.sap.vocabularies.UI.v1.SelectionPresentationVariant" ? presentationPath : visualization.path;

    if (chartVisualization) {
      aVisualizations.push(chartVisualization);
    }

    if (tableVisualization) {
      aVisualizations.push(tableVisualization);
    }

    return {
      visualizations: aVisualizations,
      annotationPath: converterContext.getAbsoluteAnnotationPath(sPath)
    };
  }

  _exports.getDataVisualizationConfiguration = getDataVisualizationConfiguration;
  return _exports;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRhdGFWaXN1YWxpemF0aW9uLnRzIl0sIm5hbWVzIjpbImdldFZpc3VhbGl6YXRpb25zRnJvbVByZXNlbnRhdGlvblZhcmlhbnQiLCJwcmVzZW50YXRpb25WYXJpYW50QW5ub3RhdGlvbiIsInZpc3VhbGl6YXRpb25QYXRoIiwiY29udmVydGVyQ29udGV4dCIsInZpc3VhbGl6YXRpb25Bbm5vdGF0aW9ucyIsInZpc3VhbGl6YXRpb25zIiwiVmlzdWFsaXphdGlvbnMiLCJiYXNlVmlzdWFsaXphdGlvblBhdGgiLCJzcGxpdCIsImhhc0xpbmVJdGVtIiwiaGFzQ2hhcnQiLCJoYXNWaXN1YWxpemF0aW9uIiwiZm9yRWFjaCIsInZpc3VhbGl6YXRpb24iLCIkdGFyZ2V0IiwidGVybSIsImdldFRlbXBsYXRlQ29udmVydGVyVHlwZSIsInB1c2giLCJhbm5vdGF0aW9uUGF0aCIsInZhbHVlIiwic2FwIiwidWkiLCJEZXZpY2UiLCJzeXN0ZW0iLCJkZXNrdG9wIiwiZ2V0TWFuaWZlc3RXcmFwcGVyIiwiZ2V0Vmlld0NvbmZpZ3VyYXRpb24iLCJpc1ByZXNlbnRhdGlvbkNvbXBsaWFudCIsInByZXNlbnRhdGlvblZhcmlhbnQiLCJmaW5kIiwiaXNQcmVzZW50YXRpb25BTFBDb21wbGlhbnQiLCJiSGFzVGFibGUiLCJiSGFzQ2hhcnQiLCJhVmlzdWFsaXphdGlvbnMiLCJtYXAiLCJvVmlzdWFsaXphdGlvbiIsImdldERlZmF1bHRMaW5lSXRlbSIsImVudGl0eVR5cGUiLCJhbm5vdGF0aW9ucyIsIlVJIiwiTGluZUl0ZW0iLCJnZXREZWZhdWx0Q2hhcnQiLCJDaGFydCIsImdldERlZmF1bHRQcmVzZW50YXRpb25WYXJpYW50IiwiUHJlc2VudGF0aW9uVmFyaWFudCIsImdldERhdGFWaXN1YWxpemF0aW9uQ29uZmlndXJhdGlvbiIsInByZXNlbnRhdGlvblBhdGgiLCJjaGFydFZpc3VhbGl6YXRpb24iLCJ0YWJsZVZpc3VhbGl6YXRpb24iLCJzVGVybSIsImFubm90YXRpb24iLCJwYXRoIiwiY29uY2F0IiwiZ2V0UmVsYXRpdmVBbm5vdGF0aW9uUGF0aCIsImZ1bGx5UXVhbGlmaWVkTmFtZSIsImdldEFubm90YXRpb25FbnRpdHlUeXBlIiwiZ2V0RW50aXR5U2V0IiwiZGVmYXVsdExpbmVJdGVtQW5ub3RhdGlvbiIsInZpc3VhbGl6YXRpb25Bbm5vdGF0aW9uIiwiY3JlYXRlQ2hhcnRWaXN1YWxpemF0aW9uIiwiY3JlYXRlVGFibGVWaXN1YWxpemF0aW9uIiwiY3JlYXRlRGVmYXVsdFRhYmxlVmlzdWFsaXphdGlvbiIsInNQYXRoIiwiZ2V0QWJzb2x1dGVBbm5vdGF0aW9uUGF0aCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUEwQ0EsTUFBTUEsd0NBQXdDLEdBQUcsVUFDaERDLDZCQURnRCxFQUVoREMsaUJBRmdELEVBR2hEQyxnQkFIZ0QsRUFJdkI7QUFDekIsUUFBTUMsd0JBQWdELEdBQUcsRUFBekQ7QUFDQSxRQUFNQyxjQUFjLEdBQUdKLDZCQUE2QixDQUFDSyxjQUE5QixJQUFnRCxFQUF2RTtBQUNBLFFBQU1DLHFCQUFxQixHQUFHTCxpQkFBaUIsQ0FBQ00sS0FBbEIsQ0FBd0IsR0FBeEIsRUFBNkIsQ0FBN0IsQ0FBOUI7O0FBQ0EsUUFBSUgsY0FBSixFQUFvQjtBQUNuQjtBQUNBLFVBQUlJLFdBQVcsR0FBRyxLQUFsQjtBQUNBLFVBQUlDLFFBQVEsR0FBRyxLQUFmO0FBQ0EsVUFBSUMsZ0JBQWdCLEdBQUcsS0FBdkIsQ0FKbUIsQ0FJVzs7QUFDOUJOLE1BQUFBLGNBQWMsQ0FBQ08sT0FBZixDQUF1QixVQUFBQyxhQUFhLEVBQUk7QUFDdkMsZ0JBQVFBLGFBQWEsQ0FBQ0MsT0FBZCxDQUFzQkMsSUFBOUI7QUFDQztBQUNDLGdCQUFJLENBQUNOLFdBQUwsRUFBa0I7QUFDakIsa0JBQUksRUFBRU4sZ0JBQWdCLENBQUNhLHdCQUFqQixPQUFnRCxZQUFoRCxJQUFnRUwsZ0JBQWxFLENBQUosRUFBeUY7QUFDeEZQLGdCQUFBQSx3QkFBd0IsQ0FBQ2EsSUFBekIsQ0FBOEI7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QUFDRCxRQUFNOEIsZUFBb0IsR0FBRyxFQUE3QjtBQUNBLFFBQU02QixLQUFLLEdBQUdiLEtBQUssOERBQUwsR0FBMkRILGdCQUEzRCxHQUE4RWpDLGFBQWEsQ0FBQ3NDLElBQTFHOztBQUNBLFFBQUlKLGtCQUFKLEVBQXdCO0FBQ3ZCZCxNQUFBQSxlQUFlLENBQUNoQixJQUFoQixDQUFxQjhCLGtCQUFyQjtBQUNBOztBQUNELFFBQUlDLGtCQUFKLEVBQXdCO0FBQ3ZCZixNQUFBQSxlQUFlLENBQUNoQixJQUFoQixDQUFxQitCLGtCQUFyQjtBQUNBOztBQUNELFdBQU87QUFDTjNDLE1BQUFBLGNBQWMsRUFBRTRCLGVBRFY7QUFFTmYsTUFBQUEsY0FBYyxFQUFFZixnQkFBZ0IsQ0FBQzRELHlCQUFqQixDQUEyQ0QsS0FBM0M7QUFGVixLQUFQO0FBSUEiLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnZlcnRlckNvbnRleHQgfSBmcm9tIFwiLi4vLi4vdGVtcGxhdGVzL0Jhc2VDb252ZXJ0ZXJcIjtcbmltcG9ydCB7XG5cdENoYXJ0RGVmaW5pdGlvblR5cGVUeXBlcyxcblx0TGluZUl0ZW0sXG5cdENoYXJ0LFxuXHRQcmVzZW50YXRpb25WYXJpYW50VHlwZVR5cGVzLFxuXHRTZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50VHlwZVR5cGVzLFxuXHRVSUFubm90YXRpb25UZXJtcyxcblx0U2VsZWN0aW9uVmFyaWFudFR5cGVUeXBlc1xufSBmcm9tIFwiQHNhcC11eC92b2NhYnVsYXJpZXMtdHlwZXNcIjtcblxuaW1wb3J0IHsgRW50aXR5VHlwZSB9IGZyb20gXCJAc2FwLXV4L3ZvY2FidWxhcmllcy10eXBlc1wiO1xuXG5pbXBvcnQgeyBjcmVhdGVEZWZhdWx0VGFibGVWaXN1YWxpemF0aW9uLCBjcmVhdGVUYWJsZVZpc3VhbGl6YXRpb24sIFRhYmxlVmlzdWFsaXphdGlvbiB9IGZyb20gXCIuL1RhYmxlXCI7XG5pbXBvcnQgeyBDaGFydFZpc3VhbGl6YXRpb24sIGNyZWF0ZUNoYXJ0VmlzdWFsaXphdGlvbiB9IGZyb20gXCIuL0NoYXJ0XCI7XG5cbmV4cG9ydCB0eXBlIERhdGFWaXN1YWxpemF0aW9uQW5ub3RhdGlvbnMgPVxuXHR8IExpbmVJdGVtXG5cdHwgQ2hhcnRcblx0fCBQcmVzZW50YXRpb25WYXJpYW50VHlwZVR5cGVzXG5cdHwgU2VsZWN0aW9uVmFyaWFudFR5cGVUeXBlc1xuXHR8IFNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnRUeXBlVHlwZXM7XG4vLyB8IENoYXJ0RGVmaW5pdGlvblR5cGVUeXBlcztcblxuZXhwb3J0IHR5cGUgQW5ub3RhdGlvblZpc3VhbGl6YXRpb25JbmZvID0ge1xuXHRhbm5vdGF0aW9uPzogRGF0YVZpc3VhbGl6YXRpb25Bbm5vdGF0aW9ucztcblx0cGF0aDogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgQWN0dWFsVmlzdWFsaXphdGlvbkFubm90YXRpb25zID0gTGluZUl0ZW0gfCBDaGFydERlZmluaXRpb25UeXBlVHlwZXM7XG5cbnR5cGUgVmlzdWFsaXphdGlvbkFuZFBhdGggPSB7XG5cdHZpc3VhbGl6YXRpb246IEFjdHVhbFZpc3VhbGl6YXRpb25Bbm5vdGF0aW9ucztcblx0YW5ub3RhdGlvblBhdGg6IHN0cmluZztcblx0c2VsZWN0aW9uVmFyaWFudFBhdGg/OiBzdHJpbmc7XG59O1xuXG5leHBvcnQgdHlwZSBEYXRhVmlzdWFsaXphdGlvbkRlZmluaXRpb24gPSB7XG5cdHZpc3VhbGl6YXRpb25zOiAoVGFibGVWaXN1YWxpemF0aW9uIHwgQ2hhcnRWaXN1YWxpemF0aW9uKVtdO1xuXHRhbm5vdGF0aW9uUGF0aDogc3RyaW5nO1xufTtcblxuY29uc3QgZ2V0VmlzdWFsaXphdGlvbnNGcm9tUHJlc2VudGF0aW9uVmFyaWFudCA9IGZ1bmN0aW9uKFxuXHRwcmVzZW50YXRpb25WYXJpYW50QW5ub3RhdGlvbjogUHJlc2VudGF0aW9uVmFyaWFudFR5cGVUeXBlcyxcblx0dmlzdWFsaXphdGlvblBhdGg6IHN0cmluZyxcblx0Y29udmVydGVyQ29udGV4dDogQ29udmVydGVyQ29udGV4dFxuKTogVmlzdWFsaXphdGlvbkFuZFBhdGhbXSB7XG5cdGNvbnN0IHZpc3VhbGl6YXRpb25Bbm5vdGF0aW9uczogVmlzdWFsaXphdGlvbkFuZFBhdGhbXSA9IFtdO1xuXHRjb25zdCB2aXN1YWxpemF0aW9ucyA9IHByZXNlbnRhdGlvblZhcmlhbnRBbm5vdGF0aW9uLlZpc3VhbGl6YXRpb25zIHx8IFtdO1xuXHRjb25zdCBiYXNlVmlzdWFsaXphdGlvblBhdGggPSB2aXN1YWxpemF0aW9uUGF0aC5zcGxpdChcIkBcIilbMF07XG5cdGlmICh2aXN1YWxpemF0aW9ucykge1xuXHRcdC8vIE9ubHkgYWxsb3cgb25lIGxpbmUgaXRlbSAvIGNoYXJ0XG5cdFx0bGV0IGhhc0xpbmVJdGVtID0gZmFsc2U7XG5cdFx0bGV0IGhhc0NoYXJ0ID0gZmFsc2U7XG5cdFx0bGV0IGhhc1Zpc3VhbGl6YXRpb24gPSBmYWxzZTsgLy8gdXNlZCB0byBhbGxvdyBvbmx5IGZpcnN0IHZpc3VhbGl6YXRpb24gaW4gT1Bcblx0XHR2aXN1YWxpemF0aW9ucy5mb3JFYWNoKHZpc3VhbGl6YXRpb24gPT4ge1xuXHRcdFx0c3dpdGNoICh2aXN1YWxpemF0aW9uLiR0YXJnZXQudGVybSkge1xuXHRcdFx0XHRjYXNlIFVJQW5ub3RhdGlvblRlcm1zLkxpbmVJdGVtOlxuXHRcdFx0XHRcdGlmICghaGFzTGluZUl0ZW0pIHtcblx0XHRcdFx0XHRcdGlmICghKGNvbnZlcnRlckNvbnRleHQuZ2V0VGVtcGxhdGVDb252ZXJ0ZXJUeXBlKCkgPT09IFwiT2JqZWN0UGFnZVwiICYmIGhhc1Zpc3VhbGl6YXRpb24pKSB7XG5cdFx0XHRcdFx0XHRcdHZpc3VhbGl6YXRpb25Bbm5vdGF0aW9ucy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0XHR2aXN1YWxpemF0aW9uOiB2aXN1YWxpemF0aW9uLiR0YXJnZXQgYXMgQWN0dWFsVmlzdWFsaXphdGlvbkFubm90YXRpb25zLFxuXHRcdFx0XHRcdFx0XHRcdGFubm90YXRpb25QYXRoOiBgJHtiYXNlVmlzdWFsaXphdGlvblBhdGh9JHt2aXN1YWxpemF0aW9uLnZhbHVlfWBcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGhhc0xpbmVJdGVtID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0aGFzVmlzdWFsaXphdGlvbiA9IHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFVJQW5ub3RhdGlvblRlcm1zLkNoYXJ0OlxuXHRcdFx0XHRcdGlmIChcblx0XHRcdFx0XHRcdCFoYXNDaGFydCAmJlxuXHRcdFx0XHRcdFx0c2FwLnVpLkRldmljZSAmJlxuXHRcdFx0XHRcdFx0c2FwLnVpLkRldmljZS5zeXN0ZW0uZGVza3RvcCAmJlxuXHRcdFx0XHRcdFx0KChjb252ZXJ0ZXJDb250ZXh0LmdldFRlbXBsYXRlQ29udmVydGVyVHlwZSgpID09PSBcIkFuYWx5dGljYWxMaXN0UGFnZVwiICYmXG5cdFx0XHRcdFx0XHRcdCFjb252ZXJ0ZXJDb250ZXh0LmdldE1hbmlmZXN0V3JhcHBlcigpLmdldFZpZXdDb25maWd1cmF0aW9uKCkpIHx8XG5cdFx0XHRcdFx0XHRcdChjb252ZXJ0ZXJDb250ZXh0LmdldFRlbXBsYXRlQ29udmVydGVyVHlwZSgpID09PSBcIk9iamVjdFBhZ2VcIiAmJiAhaGFzVmlzdWFsaXphdGlvbikpXG5cdFx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0XHR2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0XHRcdHZpc3VhbGl6YXRpb246IHZpc3VhbGl6YXRpb24uJHRhcmdldCBhcyBBY3R1YWxWaXN1YWxpemF0aW9uQW5ub3RhdGlvbnMsXG5cdFx0XHRcdFx0XHRcdGFubm90YXRpb25QYXRoOiBgJHtiYXNlVmlzdWFsaXphdGlvblBhdGh9JHt2aXN1YWxpemF0aW9uLnZhbHVlfWBcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0aGFzQ2hhcnQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0aGFzVmlzdWFsaXphdGlvbiA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdHJldHVybiB2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnM7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gaXNQcmVzZW50YXRpb25Db21wbGlhbnQocHJlc2VudGF0aW9uVmFyaWFudDogUHJlc2VudGF0aW9uVmFyaWFudFR5cGVUeXBlcyk6IEJvb2xlYW4ge1xuXHRyZXR1cm4gKFxuXHRcdHByZXNlbnRhdGlvblZhcmlhbnQgJiZcblx0XHRwcmVzZW50YXRpb25WYXJpYW50LlZpc3VhbGl6YXRpb25zICYmXG5cdFx0ISFwcmVzZW50YXRpb25WYXJpYW50LlZpc3VhbGl6YXRpb25zLmZpbmQodmlzdWFsaXphdGlvbiA9PiB7XG5cdFx0XHRyZXR1cm4gdmlzdWFsaXphdGlvbi4kdGFyZ2V0LnRlcm0gPT09IFVJQW5ub3RhdGlvblRlcm1zLkxpbmVJdGVtO1xuXHRcdH0pXG5cdCk7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNQcmVzZW50YXRpb25BTFBDb21wbGlhbnQocHJlc2VudGF0aW9uVmFyaWFudDogUHJlc2VudGF0aW9uVmFyaWFudFR5cGVUeXBlcyk6IEJvb2xlYW4ge1xuXHRsZXQgYkhhc1RhYmxlID0gZmFsc2UsXG5cdFx0Ykhhc0NoYXJ0ID0gZmFsc2U7XG5cdGlmIChwcmVzZW50YXRpb25WYXJpYW50ICYmIHByZXNlbnRhdGlvblZhcmlhbnQuVmlzdWFsaXphdGlvbnMpIHtcblx0XHRjb25zdCBhVmlzdWFsaXphdGlvbnMgPSBwcmVzZW50YXRpb25WYXJpYW50LlZpc3VhbGl6YXRpb25zO1xuXHRcdGFWaXN1YWxpemF0aW9ucy5tYXAob1Zpc3VhbGl6YXRpb24gPT4ge1xuXHRcdFx0aWYgKG9WaXN1YWxpemF0aW9uLiR0YXJnZXQudGVybSA9PT0gVUlBbm5vdGF0aW9uVGVybXMuTGluZUl0ZW0pIHtcblx0XHRcdFx0Ykhhc1RhYmxlID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdGlmIChvVmlzdWFsaXphdGlvbi4kdGFyZ2V0LnRlcm0gPT09IFVJQW5ub3RhdGlvblRlcm1zLkNoYXJ0KSB7XG5cdFx0XHRcdGJIYXNDaGFydCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0cmV0dXJuIGJIYXNDaGFydCAmJiBiSGFzVGFibGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0TGluZUl0ZW0oZW50aXR5VHlwZTogRW50aXR5VHlwZSk6IExpbmVJdGVtIHwgdW5kZWZpbmVkIHtcblx0cmV0dXJuIGVudGl0eVR5cGUuYW5ub3RhdGlvbnMuVUk/LkxpbmVJdGVtO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldERlZmF1bHRDaGFydChlbnRpdHlUeXBlOiBFbnRpdHlUeXBlKTogQ2hhcnQgfCB1bmRlZmluZWQge1xuXHRyZXR1cm4gZW50aXR5VHlwZS5hbm5vdGF0aW9ucy5VST8uQ2hhcnQ7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdFByZXNlbnRhdGlvblZhcmlhbnQoZW50aXR5VHlwZTogRW50aXR5VHlwZSk6IFByZXNlbnRhdGlvblZhcmlhbnRUeXBlVHlwZXMgfCB1bmRlZmluZWQge1xuXHRyZXR1cm4gZW50aXR5VHlwZS5hbm5vdGF0aW9ucz8uVUk/LlByZXNlbnRhdGlvblZhcmlhbnQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREYXRhVmlzdWFsaXphdGlvbkNvbmZpZ3VyYXRpb24oXG5cdHZpc3VhbGl6YXRpb246IEFubm90YXRpb25WaXN1YWxpemF0aW9uSW5mbyxcblx0Y29udmVydGVyQ29udGV4dDogQ29udmVydGVyQ29udGV4dFxuKTogRGF0YVZpc3VhbGl6YXRpb25EZWZpbml0aW9uIHtcblx0bGV0IHZpc3VhbGl6YXRpb25Bbm5vdGF0aW9uczogVmlzdWFsaXphdGlvbkFuZFBhdGhbXSA9IFtdO1xuXHRsZXQgcHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb246IFByZXNlbnRhdGlvblZhcmlhbnRUeXBlVHlwZXM7XG5cdGxldCBwcmVzZW50YXRpb25QYXRoOiBzdHJpbmcgPSBcIlwiO1xuXHRsZXQgY2hhcnRWaXN1YWxpemF0aW9uLCB0YWJsZVZpc3VhbGl6YXRpb247XG5cdGNvbnN0IHNUZXJtID0gdmlzdWFsaXphdGlvbiAmJiB2aXN1YWxpemF0aW9uLmFubm90YXRpb24gJiYgdmlzdWFsaXphdGlvbi5hbm5vdGF0aW9uLnRlcm07XG5cdGlmIChzVGVybSkge1xuXHRcdHN3aXRjaCAoc1Rlcm0pIHtcblx0XHRcdGNhc2UgVUlBbm5vdGF0aW9uVGVybXMuTGluZUl0ZW06XG5cdFx0XHRjYXNlIFVJQW5ub3RhdGlvblRlcm1zLkNoYXJ0OlxuXHRcdFx0XHR2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0dmlzdWFsaXphdGlvbjogdmlzdWFsaXphdGlvbi5hbm5vdGF0aW9uIGFzIEFjdHVhbFZpc3VhbGl6YXRpb25Bbm5vdGF0aW9ucyxcblx0XHRcdFx0XHRhbm5vdGF0aW9uUGF0aDogdmlzdWFsaXphdGlvbi5wYXRoXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgVUlBbm5vdGF0aW9uVGVybXMuUHJlc2VudGF0aW9uVmFyaWFudDpcblx0XHRcdFx0cHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb24gPSB2aXN1YWxpemF0aW9uLmFubm90YXRpb24gYXMgUHJlc2VudGF0aW9uVmFyaWFudFR5cGVUeXBlcztcblx0XHRcdFx0dmlzdWFsaXphdGlvbkFubm90YXRpb25zID0gdmlzdWFsaXphdGlvbkFubm90YXRpb25zLmNvbmNhdChcblx0XHRcdFx0XHRnZXRWaXN1YWxpemF0aW9uc0Zyb21QcmVzZW50YXRpb25WYXJpYW50KFxuXHRcdFx0XHRcdFx0dmlzdWFsaXphdGlvbi5hbm5vdGF0aW9uIGFzIFByZXNlbnRhdGlvblZhcmlhbnRUeXBlVHlwZXMsXG5cdFx0XHRcdFx0XHR2aXN1YWxpemF0aW9uLnBhdGgsXG5cdFx0XHRcdFx0XHRjb252ZXJ0ZXJDb250ZXh0XG5cdFx0XHRcdFx0KVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgVUlBbm5vdGF0aW9uVGVybXMuU2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudDpcblx0XHRcdFx0cHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb24gPSAodmlzdWFsaXphdGlvbi5hbm5vdGF0aW9uIGFzIFNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnRUeXBlVHlwZXMpLlByZXNlbnRhdGlvblZhcmlhbnQ7XG5cdFx0XHRcdC8vIFByZXNlbnRhdGlvbiBjYW4gYmUgaW5saW5lIG9yIG91dHNpZGUgdGhlIFNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnRcblx0XHRcdFx0cHJlc2VudGF0aW9uUGF0aCA9IGNvbnZlcnRlckNvbnRleHQuZ2V0UmVsYXRpdmVBbm5vdGF0aW9uUGF0aChcblx0XHRcdFx0XHRwcmVzZW50YXRpb25WYXJpYW50QW5ub3RhdGlvbi5mdWxseVF1YWxpZmllZE5hbWUsXG5cdFx0XHRcdFx0Y29udmVydGVyQ29udGV4dC5nZXRBbm5vdGF0aW9uRW50aXR5VHlwZSh2aXN1YWxpemF0aW9uLmFubm90YXRpb24pXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGlmICghaXNQcmVzZW50YXRpb25Db21wbGlhbnQocHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb24pKSB7XG5cdFx0XHRcdFx0Y29uc3QgZW50aXR5VHlwZSA9IGNvbnZlcnRlckNvbnRleHQuZ2V0RW50aXR5U2V0KCkuZW50aXR5VHlwZTtcblx0XHRcdFx0XHRjb25zdCBkZWZhdWx0TGluZUl0ZW1Bbm5vdGF0aW9uID0gZ2V0RGVmYXVsdExpbmVJdGVtKGVudGl0eVR5cGUpIGFzIExpbmVJdGVtO1xuXHRcdFx0XHRcdGlmIChkZWZhdWx0TGluZUl0ZW1Bbm5vdGF0aW9uKSB7XG5cdFx0XHRcdFx0XHR2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0XHRcdHZpc3VhbGl6YXRpb246IGRlZmF1bHRMaW5lSXRlbUFubm90YXRpb24sXG5cdFx0XHRcdFx0XHRcdGFubm90YXRpb25QYXRoOiBjb252ZXJ0ZXJDb250ZXh0LmdldFJlbGF0aXZlQW5ub3RhdGlvblBhdGgoXG5cdFx0XHRcdFx0XHRcdFx0ZGVmYXVsdExpbmVJdGVtQW5ub3RhdGlvbi5mdWxseVF1YWxpZmllZE5hbWUsXG5cdFx0XHRcdFx0XHRcdFx0ZW50aXR5VHlwZVxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dmlzdWFsaXphdGlvbkFubm90YXRpb25zID0gdmlzdWFsaXphdGlvbkFubm90YXRpb25zLmNvbmNhdChcblx0XHRcdFx0XHRcdGdldFZpc3VhbGl6YXRpb25zRnJvbVByZXNlbnRhdGlvblZhcmlhbnQocHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb24sIHZpc3VhbGl6YXRpb24ucGF0aCwgY29udmVydGVyQ29udGV4dClcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHR2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnMubWFwKHZpc3VhbGl6YXRpb25Bbm5vdGF0aW9uID0+IHtcblx0XHRcdGNvbnN0IHsgdmlzdWFsaXphdGlvbiwgYW5ub3RhdGlvblBhdGggfSA9IHZpc3VhbGl6YXRpb25Bbm5vdGF0aW9uO1xuXHRcdFx0c3dpdGNoICh2aXN1YWxpemF0aW9uLnRlcm0pIHtcblx0XHRcdFx0Y2FzZSBVSUFubm90YXRpb25UZXJtcy5DaGFydDpcblx0XHRcdFx0XHRjaGFydFZpc3VhbGl6YXRpb24gPSBjcmVhdGVDaGFydFZpc3VhbGl6YXRpb24oXG5cdFx0XHRcdFx0XHR2aXN1YWxpemF0aW9uIGFzIENoYXJ0RGVmaW5pdGlvblR5cGVUeXBlcyxcblx0XHRcdFx0XHRcdGFubm90YXRpb25QYXRoLFxuXHRcdFx0XHRcdFx0Y29udmVydGVyQ29udGV4dFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgVUlBbm5vdGF0aW9uVGVybXMuTGluZUl0ZW06XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0dGFibGVWaXN1YWxpemF0aW9uID0gY3JlYXRlVGFibGVWaXN1YWxpemF0aW9uKFxuXHRcdFx0XHRcdFx0dmlzdWFsaXphdGlvbiBhcyBMaW5lSXRlbSxcblx0XHRcdFx0XHRcdGFubm90YXRpb25QYXRoLFxuXHRcdFx0XHRcdFx0Y29udmVydGVyQ29udGV4dCxcblx0XHRcdFx0XHRcdHByZXNlbnRhdGlvblZhcmlhbnRBbm5vdGF0aW9uXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHR0YWJsZVZpc3VhbGl6YXRpb24gPSBbY3JlYXRlRGVmYXVsdFRhYmxlVmlzdWFsaXphdGlvbihjb252ZXJ0ZXJDb250ZXh0KV07XG5cdH1cblx0Y29uc3QgYVZpc3VhbGl6YXRpb25zOiBhbnkgPSBbXTtcblx0Y29uc3Qgc1BhdGggPSBzVGVybSA9PT0gVUlBbm5vdGF0aW9uVGVybXMuU2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudCA/IHByZXNlbnRhdGlvblBhdGggOiB2aXN1YWxpemF0aW9uLnBhdGg7XG5cdGlmIChjaGFydFZpc3VhbGl6YXRpb24pIHtcblx0XHRhVmlzdWFsaXphdGlvbnMucHVzaChjaGFydFZpc3VhbGl6YXRpb24pO1xuXHR9XG5cdGlmICh0YWJsZVZpc3VhbGl6YXRpb24pIHtcblx0XHRhVmlzdWFsaXphdGlvbnMucHVzaCh0YWJsZVZpc3VhbGl6YXRpb24pO1xuXHR9XG5cdHJldHVybiB7XG5cdFx0dmlzdWFsaXphdGlvbnM6IGFWaXN1YWxpemF0aW9ucyxcblx0XHRhbm5vdGF0aW9uUGF0aDogY29udmVydGVyQ29udGV4dC5nZXRBYnNvbHV0ZUFubm90YXRpb25QYXRoKHNQYXRoKVxuXHR9O1xufVxuIl19