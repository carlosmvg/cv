sap.ui.define(["sap/base/util/merge","./TemplatePage","sap/ui/test/OpaBuilder","sap/ui/test/Opa5","sap/fe/test/Utils","sap/fe/test/builder/FEBuilder","sap/fe/test/builder/MacroFieldBuilder","sap/fe/test/builder/OverflowToolbarBuilder","sap/fe/test/api/FooterActionsOP","sap/fe/test/api/FooterAssertionsOP","sap/fe/test/api/HeaderActions","sap/fe/test/api/HeaderAssertions","sap/fe/test/api/FormActions","sap/fe/test/api/FormAssertions","sap/fe/core/helpers/StableIdHelper"],function(m,T,O,a,U,F,b,c,d,e,H,f,g,h,S){"use strict";function i(N){return"fe::table::"+N.split("/").join("::")+"::LineItem";}function _(s,p,q,r,v){var I="fe::";if(typeof q==="string"){I+="FormContainer";I+="::"+S.prepareId(q);if(v){I+="::FieldValueHelp";I+="::"+s;}else{I+="::FormElement";I+="::DataField";I+="::"+s;I+="::Field";}}else if(typeof r==="string"){I+="HeaderFacet";I+="::Form";I+="::"+S.prepareId(r);I+="::DataField";I+="::"+s;I+="::Field";}I=S.prepareId(I);return I;}function j(p){return _(p.field,"",p.facet,p.headerFacet,true);}function k(p,s){return _(p.field,s||"",p.facet,p.headerFacet,false);}function l(v,p){return c.create(v).hasId(p.id);}function n(v,p){return F.create(v).hasId(p.id);}function o(v,p){var q=F.create(v);if(U.isOfType(p,String)){q.hasType("sap.uxap.ObjectPageSubSection");q.hasProperties({title:p});}else if(p.fieldGroupId){if(p.fullSubSectionId){q.hasId(p.fieldGroupId).has(O.Matchers.ancestor(p.fullSubSectionId,false));}else{q.hasId(p.fieldGroupId);}}else{q.hasId(p.id);}return q;}return{create:function(A,C,E){var V=A+"::"+C,p=V+"--fe::ObjectPage",q="fe::HeaderFacet",r="fe::ObjectPage-OPHeaderContent",s="fe::FooterBar",t="fe::FacetSubSection",u="fe::Form",v="fe::FormContainer",B=V+"--fe::Breadcrumbs",w="fe::ObjectPage-anchBar",P="fe::Paginator",x={DISPLAY:"Display",EDITABLE:"Editable"},R=sap.ui.getCore().getLibraryResourceBundle("sap.fe.core");return m(T.create(V,E),{actions:{onTable:function(y){if(!U.isOfType(y,String)){y={id:i(y.property)};}return this._onTable(y);},onFooter:function(){return new d(l(this,{id:s}),{id:s});},onHeader:function(){return new H(n(this,{id:p}),{id:p,headerId:q,headerContentId:r,viewId:V,paginatorId:P,breadCrumbId:B});},onForm:function(y){if(!U.isOfType(y,String)){if(y.section){y.id=t+"::"+y.section;y.fullSubSectionId=V+"--"+y.id;}if(y.fieldGroup){y.fieldGroupId=v+"::"+y.fieldGroup;}}return new g(o(this,y),y);},iClickQuickViewMoreLinksButton:function(){return O.create(this).hasType("sap.m.Button").has(O.Matchers.resourceBundle("text","sap.ui.mdc","info.POPOVER_DEFINE_LINKS")).doPress().description("Pressing 'More Links' button").execute();},iClickLinkWithText:function(y){return O.create(this).hasType("sap.m.Link").hasProperties({text:y}).doPress().description("Navigating via link '"+y+"'").execute();},iEnableLink:function(y){return O.create(this).hasType("sap.m.ColumnListItem").hasAggregationProperties("cells",{text:y}).isDialogElement().doPress("selectMulti").description("The CheckBox for link "+y+" is selected").execute();},iOpenVHDialog:function(y){var z=k(y)+"-inner-vhi";return O.create(this).hasId(z).doPress().description("Opening value help for '"+y.field+"'").execute();},iPressKeyboardShortcutOnSection:function(y,z){return this._iPressKeyboardShortcut(undefined,y,z,"sap.uxap.ObjectPageSection");},iSelectFromVHDTable:function(y){return O.create(this).hasType("sap.m.ColumnListItem").hasAggregationProperties("cells",{value:y}).checkNumberOfMatches(1).isDialogElement().doPress().description("Selecting row from dialog with value '"+y+"'").execute();},iConfirmFacetVHD:function(y){var z=j(y)+"-ok";return O.create(this).hasId(z).doPress().description("Confirming value help selection for '"+y.field+"'").execute();},iCancelDialog:function(){return this.iConfirmDialogWithButtonText(R.getText("C_COMMON_OBJECT_PAGE_CANCEL"));},iOpenSectionWithTitle:function(N){return O.create(this).hasId(w).has(O.Matchers.children(F.Matchers.states({controlType:"sap.m.Button",text:N}))).doPress().description("Selecting section "+N).execute();},iClickCreateButton:function(){return O.create(this).isDialogElement().hasType("sap.m.Button").has(O.Matchers.resourceBundle("text","sap.fe.core","C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE")).doPress().description("Pressing Create button on sticky creation dialog.").execute();},iOpenVHDInCreateDialog:function(y){return O.create(this).isDialogElement().hasId(y+"-inner-vhi").doPress().description("Opening value help for '"+y+"' from within the create dialog").execute();},iConfirmVHDInCreateDialog:function(y){return O.create(this).isDialogElement().hasId(y+"::VH-ok").doPress().description("Comfirmed VHD opened from create dialog").execute();},iEnterValueForFieldInCreateDialog:function(y,z){return O.create(this).isDialogElement().hasId(y).doEnterText(z).description("Entering Text in the field '"+y+"'in the create dialog with value '"+z+"'").execute();}},assertions:{onTable:function(y){if(!U.isOfType(y,String)){y={id:i(y.property)};}return this._onTable(y);},onFooter:function(){return new e(l(this,{id:s}),{id:s});},onHeader:function(){return new f(n(this,{id:p}),{id:p,headerId:q,headerContentId:r,viewId:V,paginatorId:P,breadCrumbId:B});},onForm:function(y){if(!U.isOfType(y,String)){if(y.section){y.id=t+"::"+y.section;y.fullSubSectionId=V+"--"+y.id;}if(y.fieldGroup){y.fieldGroupId=v+"::"+y.fieldGroup;}}return new h(o(this,y),y);},iSeeLinkWithText:function(y){return O.create(this).hasType("sap.m.Link").hasProperties({text:y}).description("Seeing link with text '"+y+"'").execute();},iSeeTextWithText:function(y){return O.create(this).hasType("sap.m.Text").hasProperties({text:y}).description("Seeing link with text '"+y+"'").execute();},iSeeTitleWithText:function(y){return O.create(this).hasType("sap.m.Title").hasProperties({text:y}).description("Seeing link with text '"+y+"'").execute();},iSeeContactDetailsPopover:function(y){return(O.create(this).hasType("sap.ui.mdc.link.Panel").description("Contact card with title '"+y+"' is present").execute());},iSeeQuickViewPopover:function(){return O.create(this).hasType("sap.ui.mdc.link.Panel").description("Seeing Quick View Details in ObjectPage").execute();},iSeeQuickViewMoreLinksButton:function(){return O.create(this).isDialogElement(true).hasType("sap.m.Button").has(O.Matchers.resourceBundle("text","sap.ui.mdc","info.POPOVER_DEFINE_LINKS")).description("The 'More Links' button found").execute();},iSeeObjectPageInDisplayMode:function(){return this._iSeeObjectPageInMode(x.DISPLAY);},iSeeObjectPageInEditMode:function(){return this._iSeeObjectPageInMode(x.EDITABLE);},_iSeeObjectPageInMode:function(M){return O.create(this).hasId(V).viewId(null).has(function(y){return y.getModel("ui").getProperty("/editMode")===M;}).description("Object Page is in mode '"+M+"'").execute();},iSeeSectionWithTitle:function(y){return O.create(this).hasType("sap.uxap.ObjectPageSection").hasProperties({title:y}).description("Seeing section with title '"+y+"'").execute();},iSeeSubSectionWithTitle:function(y){return O.create(this).hasType("sap.uxap.ObjectPageSubSection").hasProperties({title:y}).description("Seeing sub-section with title '"+y+"'").execute();},iSeeSectionButtonWithTitle:function(y,z){return F.create(this).hasId(w).has(O.Matchers.children(F.Matchers.states(m({},{controlType:"sap.m.Button",text:y},z)))).description(U.formatMessage("Seeing section button with title '{0}' and state='{1}'",y,z)).execute();},iSeeFlpLink:function(D){return O.create(this).hasType("sap.ui.mdc.link.PanelListItem").isDialogElement(true).hasProperties({text:D}).description("FLP link with text '"+D+"' is present").execute();},iSeeSelectLinksDialog:function(){return O.create(this).hasType("sap.m.Title").isDialogElement(true).has(O.Matchers.resourceBundle("text","sap.ui.mdc","info.SELECTION_DIALOG_ALIGNEDTITLE")).description("Seeing dialog open").execute();},iDoNotSeeFlpLink:function(D){return O.create(this).hasType("sap.m.Link").isDialogElement(true).check(function(y){var z=y.some(function(G){return G.getText()===D;});return z===false;},true).description("FLP link with text '"+D+"' is not found").execute();},iSeeTitleLink:function(D,I){return O.create(this).hasType("sap.m.Link").isDialogElement(true).hasProperties({text:D,href:I}).description("QuickView Title link with text '"+D+"' is found").execute();},iSeeVHD:function(y){var D=j(y)+"-dialog";return O.create(this).hasId(D).description("Seeing value help dialog for field '"+y.field+"'").execute();},iSeeVHDTable:function(y){var z=j(y)+"::Table";return O.create(this).hasId(z).hasAggregation("items").description("Seeing filled value help dialog for field '"+y.field+"'").execute();},iSeeVHDFilterBar:function(y){var z=j(y)+"::FilterBar";return O.create(this).hasId(z).description("Seeing value help filterbar for field '"+y.field+"'").execute();},iSeeSaveConfirmation:function(){return this._iSeeTheMessageToast(R.getText("C_TRANSACTION_HELPER_OBJECT_SAVED"));},iSeeDeleteConfirmation:function(){return this._iSeeTheMessageToast(R.getText("C_TRANSACTION_HELPER_OBJECT_PAGE_DELETE_TOAST_SINGULAR"));},iSeeConfirmMessageBoxWithTitle:function(y){return O.create(this).hasType("sap.m.Dialog").isDialogElement(true).hasProperties({title:y}).description("Seeing Message dialog open").execute();},iSeeMoreFormContent:function(y){return O.create(this).hasId(u+"::"+y+"::MoreContent").description("Seeing More Form Content in "+y).execute();},iDoNotSeeMoreFormContent:function(y){return O.create(this).hasType("sap.ui.layout.form.Form").check(function(z){var D=z.some(function(G){return G.getId().includes(y+"::MoreContent");});return D===false;}).description("Not Seeing More Form Content in "+y).execute();},iSeeControlVMTableTitle:function(y,N){return O.create(this).hasType("sap.m.Title").hasId(i(N)+"::VM-text").hasProperties({text:y}).description("Seeing variant title '"+y+"'").execute();},iCheckCreateDialog:function(){return O.create(this).isDialogElement().hasType("sap.m.Dialog").has(O.Matchers.resourceBundle("title","sap.fe.core","C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE")).description("Creation dialog is opened").execute();},iCheckValueOfFieldInCreateDialog:function(y,z,D,I){return b.create(this).isDialogElement().hasId(y).hasValue(z,D).hasProperties({required:!!I}).description(U.formatMessage("Seeing field '{0}' with value '{1}'",y,[].concat(z,D||[]))).execute();},iSeeCreateButton:function(y){y=y!==false;return F.create(this).hasType("sap.m.Button").hasProperties({text:"Create"}).isDialogElement(true).mustBeEnabled(y).checkNumberOfMatches(1).description("Create button is visible").execute();}}});}};});
