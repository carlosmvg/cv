/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2017 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/model/Filter","sap/fe/macros/filter/FilterUtils","sap/ui/model/FilterOperator","sap/ui/core/CustomData"],function(F,a,b,C){"use strict";var p=[];var c={getChartSelectionsExist:function(m,s){s=s||m;if(m){var o=m.getAggregation("_chart");if(o){var d=o.getDrillStack();if(d.length>0){var e=d.pop();var D=e.dimension;var i=D.length>p.length;var I=D.length<p.length;var n=D.toString()===p.toString();var f;if(I&&D.length===1){f=c.getChartSelections(m,true);}else{f=c.getChartSelections(m);}if(i||I){p=D;return f.length>0;}else if(n&&s.isA("sap.ui.mdc.Table")){return f.length>0;}}}}return false;},getChartSelections:function(m,d){var M=m.data("selectedContextsModel");var o=m.getModel(M);var i=m.getId().substr(m.getId().indexOf("fe::Chart"),m.getId().length);if(d){o.setProperty("/$contexts",{});}var v=o.getProperty("/$contexts/"+i+"/filters")||[];return v;},getChartFilters:function(m){var f=c.getChartSelections(m);return new F(f);},setChartFilters:function(m){var M=m.data("selectedContextsModel");var o=m.getModel(M);var I=m.getId().substr(m.getId().indexOf("fe::Chart"),m.getId().length);var d=m.getAggregation("_chart");var e=[];function f(s){for(var l in s){var n=[];for(var i in V){var q=V[i];var r=s[l].data[q];if(r!==undefined){n.push(new F({path:q,operator:b.EQ,value1:r}));}}if(n.length>0){e.push(new F(n,true));}}}if(d){var v=d._getVizFrame().vizSelection()||[];var V=d.getVisibleDimensions();var g=d.getDrillStack()||[];var h=g.pop()||{};var D=h.dimension||[];if(D.length>0){var j=o.getProperty("/$contexts/"+I+"/drillStack")||{};o.setProperty("/$contexts/"+I+"/drillStack",{});j[D.toString()]=v;o.setProperty("/$contexts/"+I+"/drillStack",j);}if(v.length>0){f(v);}else{var k=Object.keys(j)||[];var P=j[k[k.length-2]]||[];f(P);}o.setProperty("/$contexts/"+I+"/filters",e);}},getFilterBarFilterInfo:function(o){return a.getFilterInfo(o.getFilter());},getAllFilterInfo:function(o){var f=c.getFilterBarFilterInfo(o);var d=c.getChartFilters(o);f.filters.push(d);return f;},getChartSelectedData:function(o){var s=[];switch(o.getSelectionBehavior()){case"DATAPOINT":s=o.getSelectedDataPoints().dataPoints;break;case"CATEGORY":s=o.getSelectedCategories().categories;break;case"SERIES":s=o.getSelectedSeries().series;break;}return s;}};return c;});
